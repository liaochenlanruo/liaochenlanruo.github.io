{"total":132,"pageSize":10,"pageCount":14,"data":[{"title":"使用eggNOG-mapper注释基因组","slug":"使用eggNOG-mapper注释基因组","date":"2022-02-26T02:37:14.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/使用eggNOG-mapper注释基因组.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","content":"<h1 id=\"EggNOG-mapper简介-本文未完待续…\"><a href=\"#EggNOG-mapper简介-本文未完待续…\" class=\"headerlink\" title=\"EggNOG-mapper简介(本文未完待续…)\"></a>EggNOG-mapper简介(本文未完待续…)</h1><p>EggNOG-mapper (a.k.a. emapper.py or just emapper) is a tool for fast functional annotation of novel sequences. It uses precomputed orthologous groups (OGs) and phylogenies from the eggNOG database (<a href=\"http://eggnogdb.embl.de/\">http://eggnogdb.embl.de/</a>) to transfer functional information from fine-grained orthologs only.</p>\n<p>Common uses of eggNOG-mapper include the annotation of novel genomes, transcriptomes or even metagenomic gene catalogs.</p>\n<p>The use of orthology predictions for functional annotation permits a higher precision than traditional homology searches (i.e. BLAST searches), as it avoids transferring annotations from close paralogs (duplicate genes with a higher chance of being involved in functional divergence).</p>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><ul>\n<li>Python 3.7 (or greater)</li>\n<li>BioPython 1.76 (python package) (BioPython 1.78 should work since emapper version 2.1.7)</li>\n<li>psutil 5.7.0 (python package)</li>\n<li>xlsxwriter 1.4.3 (python package), only if using the –excel option</li>\n<li>wget (linux command, required for downloading the eggNOG-mapper databases with download_eggnog_data.py, and to create new Diamond&#x2F;MMseqs2 databases with create_dbs.py)</li>\n<li>sqlite (&gt;&#x3D;3.8.2)</li>\n</ul>\n<h2 id=\"需要的存储空间\"><a href=\"#需要的存储空间\" class=\"headerlink\" title=\"需要的存储空间\"></a>需要的存储空间</h2><ul>\n<li>~40 GB for the eggNOG annotation databases (eggnog.db and eggnog.taxa.db)</li>\n<li>~9 GB for Diamond database of eggNOG sequences (required if using -m diamond, which is the default search mode).</li>\n<li><del>11 GB for MMseqs2 database of eggNOG sequences (</del>86 GB if MMseqs2 index is created) (required if using -m mmseqs).</li>\n<li>~3 GB for PFAM database (required if using –pfam_realign options for realignment of queries to PFAM domains).<br>The size of eggNOG diamond&#x2F;mmseqs databases created with create_dbs.py is highly variable, depending on the size of the chosen taxonomic groups.</li>\n</ul>\n<p>Databases for specific taxonomic ranges can be downloaded (for HMMER) or created (for Diamond and MMseqs2). The size of these databases is highly variable. For the size of HMMER databases, check <a href=\"http://eggnog5.embl.de/#/app/downloads\">http://eggnog5.embl.de/#/app/downloads</a>. For Diamond and MMseqs2 databases, DB size will depend on the number of proteins which are from those taxonomic ranges. Also, these proteins need to be downloaded to create the databases, and can be removed afterwards.</p>\n<h2 id=\"Other-Requirements\"><a href=\"#Other-Requirements\" class=\"headerlink\" title=\"Other Requirements\"></a>Other Requirements</h2><ul>\n<li>Using –dbmem loads the whole eggnog.db sqlite3 annotation database during the annotation step, and therefore requires ~44 GB of memory.</li>\n<li>Using the –num_servers option when running HMMER in server mode (a.k.a. hmmgpmd, which is used for -m hmmer –usemem, –pfam_realign denovo or hmm_server.py) loads the HMM database as many times as specified in the argument (e.g. –pfam_realign denovo –num_servers 2 loads the PFAM database into memory twice, with up to roughly 2 GB per instance).</li>\n</ul>\n<h2 id=\"安装-1\"><a href=\"#安装-1\" class=\"headerlink\" title=\"安装\"></a>安装</h2><ul>\n<li>安装主程序</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install -c bioconda eggnog-mapper</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装数据库</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#创建数据库存储目录</span><br><span class=\"line\">mkdir /home/liu/miniconda3/envs/pgcgap/lib/python3.7/site-packages/data</span><br><span class=\"line\"></span><br><span class=\"line\">#将数据库位置加入环境变量</span><br><span class=\"line\">export EGGNOG_DATA_DIR=/home/liu/miniconda3/envs/pgcgap/lib/python3.7/site-packages/data</span><br><span class=\"line\"></span><br><span class=\"line\">#下载数据库</span><br><span class=\"line\">download_eggnog_data.py -P -M -y -f --data_dir /home/liu/miniconda3/envs/pgcgap/lib/python3.7/site-packages/data</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>Similarly, use create_dbs.py. For example, to create a diamond database for Bacteria only:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create_dbs.py -m diamond --dbname bacteria --taxa Bacteria</span><br></pre></td></tr></table></figure>\n<p>This will create a bacteria.dmnd diamond database in the default data directory or the one specified in EGGNOG_DATA_DIR environment variable. Such database can be used with emapper.py –dmnd_db bacteria.dmnd. Note that the first time create_dbs.py is used it will take time to download the eggNOG proteins and create the Diamond or MMseqs2 database. Next calls to create_dbs.py (to the same data directory pointed by EGGNOG_DATA_DIR, or –data_dir, or data&#x2F; by default) will not need to download the eggnog5 proteins again. If no more databases are going to be created, the proteins can be removed. For further info, check create_dbs.py –help.</p>\n<h1 id=\"用法\"><a href=\"#用法\" class=\"headerlink\" title=\"用法\"></a>用法</h1><h1 id=\"代码获取\"><a href=\"#代码获取\" class=\"headerlink\" title=\"代码获取\"></a>代码获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"Functional genomics","path":"api/tags/Functional genomics.json"},{"name":"WGS","path":"api/tags/WGS.json"},{"name":"生信软件","path":"api/tags/生信软件.json"}]},{"title":"Microbial Ecology投稿经验","slug":"Microbial-Ecology投稿经验","date":"2022-01-19T03:06:36.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/Microbial-Ecology投稿经验.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/8e76_1.jpg","content":"<h1 id=\"Geographic-Scale-Influences-the-Interactivities-Between-Determinism-and-Stochasticity-in-the-Assembly-of-Sedimentary-Microbial-Communities-on-the-South-China-Sea-Shelf投稿过程\"><a href=\"#Geographic-Scale-Influences-the-Interactivities-Between-Determinism-and-Stochasticity-in-the-Assembly-of-Sedimentary-Microbial-Communities-on-the-South-China-Sea-Shelf投稿过程\" class=\"headerlink\" title=\"Geographic Scale Influences the Interactivities Between Determinism and Stochasticity in the Assembly of Sedimentary Microbial Communities on the South China Sea Shelf投稿过程\"></a>Geographic Scale Influences the Interactivities Between Determinism and Stochasticity in the Assembly of Sedimentary Microbial Communities on the South China Sea Shelf投稿过程</h1><h2 id=\"类型：\"><a href=\"#类型：\" class=\"headerlink\" title=\"类型：\"></a>类型：</h2><ul>\n<li>Artical</li>\n</ul>\n<h2 id=\"周期：\"><a href=\"#周期：\" class=\"headerlink\" title=\"周期：\"></a>周期：</h2><ul>\n<li>~4.5个月</li>\n</ul>\n<h2 id=\"节点：\"><a href=\"#节点：\" class=\"headerlink\" title=\"节点：\"></a>节点：</h2><ul>\n<li><strong>First Submission</strong>：2021.09.08</li>\n<li><strong>分配审稿人</strong>：2021.09.14</li>\n<li><strong>审稿完毕</strong>：2021.09.21</li>\n<li><strong>返回修稿意见</strong>：2021.10.23 早上</li>\n<li><strong>Resubmission</strong>：2021.11.16 早上</li>\n<li><strong>With Editor</strong>：2021.11.16 中午</li>\n<li><strong>Under review</strong>: 2021.11.17 早上</li>\n<li><strong>Required reviews completed</strong>：2021.12.03 中午</li>\n<li><strong>Minor revision needed</strong>：2021.12.09 早上</li>\n<li><strong>Revision submitted to journal</strong>：2020.12.09 夜晚</li>\n<li><strong>With editor</strong>：2021.12.10 中午</li>\n<li><strong>返回修稿意见</strong>：2021.12.11 9:50<br>编辑发邮件让修稿，然而修稿意见里面是空的。我们于12月13号发信问编辑，当天收到回信，结果是他搞错了，不需要再修稿了。</li>\n<li><strong>Accepted</strong>：2021.12.14 20:32</li>\n<li><strong>Proof</strong>：2022.01.17 10:30</li>\n<li><strong>Online</strong>：2022.01.18</li>\n</ul>\n<h2 id=\"文章链接\"><a href=\"#文章链接\" class=\"headerlink\" title=\"文章链接\"></a>文章链接</h2><p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/8e76_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/8e76_1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<p><a href=\"https://doi.org/10.1007/s00248-021-01946-x\">Geographic Scale Influences the Interactivities Between Determinism and Stochasticity in the Assembly of Sedimentary Microbial Communities on the South China Sea Shelf</a></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>该杂志速度还是比较快的，审稿人有点多，4位，但是提的意见非常有助于提升文章的质量。</p>\n","raw":null,"categories":[{"name":"投稿","path":"api/categories/投稿.json"}],"tags":[{"name":"投稿经验","path":"api/tags/投稿经验.json"}]},{"title":"使用DeepARG预测抗生素抗性基因ARGs","slug":"使用DeepARG预测抗生素抗性基因ARGs","date":"2022-01-07T11:50:33.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/使用DeepARG预测抗生素抗性基因ARGs.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/92eb_1.png","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>DeepARG 是一种机器学习解决方案，它使用深度学习来表征和注释宏基因组中的抗生素抗性基因。它由两种输入模型组成：短序列Reads和gene-like序列。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/92eb_1.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/92eb_1.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"Automatic annotation of highly homologous ARGs\"></p>\n<h1 id=\"安装软件\"><a href=\"#安装软件\" class=\"headerlink\" title=\"安装软件\"></a>安装软件</h1><ul>\n<li><p>通过<code>conda</code>安装</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 创建环境</span></span><br><span class=\"line\">conda create -n deeparg_env python=2.7.18</span><br><span class=\"line\">conda activate deeparg_env</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装diamond</span></span><br><span class=\"line\">conda install -c bioconda diamond==0.9.24</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装其他依赖</span></span><br><span class=\"line\">conda install trimmomatic vsearch bedtools bowtie2 samtools</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装DeepARG</span></span><br><span class=\"line\">pip install deeparg==1.0.2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 下载数据库等， -o指定下载路径</span></span><br><span class=\"line\">deeparg download_data -o tools/deeparg</span><br></pre></td></tr></table></figure></li>\n<li><p>通过其他方法安装</p>\n<p>  参考<a href=\"https://bitbucket.org/gusphdproj/deeparg-ss/src/master/\">官方文档</a>进行。</p>\n</li>\n</ul>\n<h1 id=\"使用软件\"><a href=\"#使用软件\" class=\"headerlink\" title=\"使用软件\"></a>使用软件</h1><h2 id=\"预测Reads中的ARGs\"><a href=\"#预测Reads中的ARGs\" class=\"headerlink\" title=\"预测Reads中的ARGs\"></a>预测Reads中的ARGs</h2><h3 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h3><p>双端Reads。</p>\n<h3 id=\"命令\"><a href=\"#命令\" class=\"headerlink\" title=\"命令\"></a>命令</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deeparg short_reads_pipeline --forward_pe_file Reads/LD201221-0003_S20210104-0015_F01_clean.R1.fq.gz --reverse_pe_file Reads/LD201221-0003_S20210104-0015_F01_clean.R2.fq.gz --output_file F01.deeparg -d ~/tools/deeparg/</span><br></pre></td></tr></table></figure>\n\n<p>+++primary 参数解析</p>\n<p><code>-h, --help</code>            show this help message and exit<br><code>--forward_pe_file</code> <strong>FORWARD_PE_FILE</strong>:           forward mate from paired end library<br><code>--reverse_pe_file</code> <strong>REVERSE_PE_FILE</strong>:             reverse mate from paired end library<br><code>--output_file</code> <strong>OUTPUT_FILE</strong>:           save results to this file prefix<br><code>-d</code> <strong>DEEPARG_DATA_PATH</strong>:               Path where data was downloaded [see deeparg download-data –help for details]<br><code>--deeparg_identity</code> <strong>DEEPARG_IDENTITY</strong>:      minimum identity for ARG alignments [default 80]<br><code>--deeparg_probability</code> <strong>DEEPARG_PROBABILITY</strong>:      minimum probability for considering a reads as ARG-like [default 0.8]<br><code>--deeparg_evalue</code> <strong>DEEPARG_EVALUE</strong>:     minimum e-value for ARG alignments [default 1e-10]<br><code>--gene_coverage</code> <strong>GENE_COVERAGE</strong>:        minimum coverage required for considering a full gene in percentage. This parameter looks at the full gene and all hits that align to the gene. If the overlap of all hits is below the threshold the gene is discarded. Use with caution [default 1]</p>\n<p>+++</p>\n<h2 id=\"预测FASTA序列中的ARGs\"><a href=\"#预测FASTA序列中的ARGs\" class=\"headerlink\" title=\"预测FASTA序列中的ARGs\"></a>预测FASTA序列中的ARGs</h2><h3 id=\"输入文件-1\"><a href=\"#输入文件-1\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h3><p>可以是<code>核苷酸序列</code>或者是<code>氨基酸序列</code>。</p>\n<h3 id=\"命令-1\"><a href=\"#命令-1\" class=\"headerlink\" title=\"命令\"></a>命令</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1) Annotate gene-like sequences when the input is a nucleotide FASTA file:</span></span><br><span class=\"line\">    deeparg predict --model LS --<span class=\"built_in\">type</span> nucl --input /path/file.fasta --out /path/to/out/file.out</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2) Annotate gene-like sequences when the input is an amino acid FASTA file:</span></span><br><span class=\"line\">    deeparg predict --model LS --<span class=\"built_in\">type</span> prot --input /path/file.fasta --out /path/to/out/file.out</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3) Annotate short sequence reads when the input is a nucleotide FASTA file:</span></span><br><span class=\"line\">    deeparg predict --model SS --<span class=\"built_in\">type</span> nucl --input /path/file.fasta --out /path/to/out/file.out</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4) Annotate short sequence reads when the input is a protein FASTA file (unusual case):</span></span><br><span class=\"line\">    deeparg predict --model SS --<span class=\"built_in\">type</span> prot --input /path/file.fasta --out /path/to/out/file.out</span><br></pre></td></tr></table></figure>\n\n<p>+++primary 参数解析<br>usage: deeparg predict<br>    <code>-h, --help</code>            show this help message and exit<br>    <code>--model</code> <strong>MODEL</strong>:         Select model to use (short sequences for reads | long sequences for genes) SS|LS [No default]<br>    <code>-i, --input-file</code> <strong>INPUT_FILE</strong>:     Input file (Fasta input file)<br>    <code>-o, --output-file</code> <strong>OUTPUT_FILE</strong>:    Output file where to store results<br>    <code>-d, --data-path</code> <strong>DATA_PATH</strong>:       Path where data was downloaded [see deeparg download-data –help for details]<br>    <code>--type</code> <strong>TYPE</strong>:       Molecular data type prot&#x2F;nucl [Default: nucl]<br>    <code>--min-prob</code> <strong>MIN_PROB</strong>:   Minimum probability cutoff [Default: 0.8]<br>    <code>--arg-alignment-identity</code> <strong>ARG_ALIGNMENT_IDENTITY</strong>:          Identity cutoff for sequence alignment [Default: 50]<br>    <code>--arg-alignment-evalue</code> <strong>ARG_ALIGNMENT_EVALUE</strong>:                  Evalue cutoff [Default: 1e-10]<br>    <code>--arg-alignment-overlap</code> <strong>ARG_ALIGNMENT_OVERLAP</strong>:                 Alignment read overlap [Default: 0.8]<br>    <code>--arg-num-alignments-per-entry</code> <strong>ARG_NUM_ALIGNMENTS_PER_ENTRY</strong>:    Diamond, minimum number of alignments per entry [Default: 1000]<br>    <code>--model-version</code> <strong>MODEL_VERSION</strong>:     Model deepARG version [Default: v2]</p>\n<p>+++</p>\n<h2 id=\"输出\"><a href=\"#输出\" class=\"headerlink\" title=\"输出\"></a>输出</h2><p>DeepARG产生两个文件： <code>.ARG</code>包含probability &gt;&#x3D; –prob (0.8 default)的序列，<code>.potential.ARG</code>包含probability &lt; –prob (0.8 default)的序列。<code>*.potential.ARG</code>文件中仍可能含有ARG-like序列，但是需要对这些序列进行检查。 </p>\n<p>两个文件的文件头如下所示：</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">* ARG<span class=\"built_in\">_</span>NAME</span><br><span class=\"line\">* QUERY<span class=\"built_in\">_</span>START</span><br><span class=\"line\">* QUERY<span class=\"built_in\">_</span>END</span><br><span class=\"line\">* QUERY<span class=\"built_in\">_</span>ID</span><br><span class=\"line\">* PREDICTED<span class=\"built_in\">_</span>ARG<span class=\"built_in\">_</span>CLASS</span><br><span class=\"line\">* BEST<span class=\"built_in\">_</span>HIT<span class=\"built_in\">_</span>FROM<span class=\"built_in\">_</span>DATABASE</span><br><span class=\"line\">* PREDICTION<span class=\"built_in\">_</span>PROBABILITY</span><br><span class=\"line\">* ALIGNMENT<span class=\"built_in\">_</span>BESTHIT<span class=\"built_in\">_</span>IDENTITY (<span class=\"comment\">%)</span></span><br><span class=\"line\">* ALIGNMENT<span class=\"built_in\">_</span>BESTHIT<span class=\"built_in\">_</span>LENGTH</span><br><span class=\"line\">* ALIGNMENT<span class=\"built_in\">_</span>BESTHIT<span class=\"built_in\">_</span>BITSCORE</span><br><span class=\"line\">* ALIGNMENT<span class=\"built_in\">_</span>BESTHIT<span class=\"built_in\">_</span>EVALUE</span><br><span class=\"line\">* COUNTS</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"批处理\"><a href=\"#批处理\" class=\"headerlink\" title=\"批处理\"></a>批处理</h3><ul>\n<li>Run_deepARG_reads.pl</li>\n<li>Run_deepARG_scafs.pl</li>\n</ul>\n<h3 id=\"样本间比较\"><a href=\"#样本间比较\" class=\"headerlink\" title=\"样本间比较\"></a>样本间比较</h3><h4 id=\"生成样本VS-ARGs矩阵\"><a href=\"#生成样本VS-ARGs矩阵\" class=\"headerlink\" title=\"生成样本VS. ARGs矩阵\"></a>生成样本VS. ARGs矩阵</h4><ul>\n<li>co_type.pl</li>\n</ul>\n<h4 id=\"绘制气泡图\"><a href=\"#绘制气泡图\" class=\"headerlink\" title=\"绘制气泡图\"></a>绘制气泡图</h4><ul>\n<li>Bubble_plot.R</li>\n</ul>\n<h4 id=\"绘制热图\"><a href=\"#绘制热图\" class=\"headerlink\" title=\"绘制热图\"></a>绘制热图</h4><ul>\n<li>Plot_heatmap.R</li>\n</ul>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://bench.cs.vt.edu/deeparg\">DeepARG官网</a></li>\n<li><a href=\"https://bitbucket.org/gusphdproj/deeparg-ss/src/master/\">DeepARG Repository</a></li>\n</ul>\n<h1 id=\"代码获取\"><a href=\"#代码获取\" class=\"headerlink\" title=\"代码获取\"></a>代码获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“92eb”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"ARGs","path":"api/tags/ARGs.json"}]},{"title":"计算蛋白质等电点并绘制全局pI图","slug":"计算蛋白质等电点","date":"2022-01-03T02:49:17.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/计算蛋白质等电点.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png","content":"<h1 id=\"蛋白质组的全局-pIs\"><a href=\"#蛋白质组的全局-pIs\" class=\"headerlink\" title=\"蛋白质组的全局 pIs\"></a>蛋白质组的全局 pIs</h1><p>细胞全局蛋白质组 pI 图的变化取决于氨基酸的总电荷，并对蛋白质的结构和特性具有重要意义。</p>\n<p>普遍认为原核基因组具有两个最大的双峰形状，一个在酸性pH值下主要对应于溶解的蛋白质（细胞质蛋白或分泌蛋白），另一种在膜蛋白的碱性pH值下，具有细胞内碱性（带正电荷）结构域以促进质子动力的产生。在这两个峰之间，有一个最小的中性值，对应于细胞内的pH值（如下图）。</p>\n<p>蛋白质氨基酸组成和 pI 水平的显着变化提供了一种工具来预测培养物或宏基因组组装基因组(MAG)的首选栖息地。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"蛋白质组的全局 pIs\"><br><a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n<h1 id=\"安装EMBOSS\"><a href=\"#安装EMBOSS\" class=\"headerlink\" title=\"安装EMBOSS\"></a>安装EMBOSS</h1><ul>\n<li>下载</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget  ftp://emboss.open-bio.org/pub/EMBOSS/emboss-latest.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 解压</span></span><br><span class=\"line\">tar zxvf emboss-latest.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 防止报错 (error while loading shared libraries: libnucleus.so.6)</span></span><br><span class=\"line\">sudo /sbin/ldconfig</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 配置、编译与安装</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> emboss-latest</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h1><p>输入文件为含有一条或多条氨基酸序列的FASTA格式文件。</p>\n<h1 id=\"计算氨基酸序列的各特征数据Calculate-statistics-of-protein-properties\"><a href=\"#计算氨基酸序列的各特征数据Calculate-statistics-of-protein-properties\" class=\"headerlink\" title=\"计算氨基酸序列的各特征数据Calculate statistics of protein properties\"></a><ruby>计算氨基酸序列的各特征数据<rt>Calculate statistics of protein properties</rt></ruby></h1><h2 id=\"逐个文件计算\"><a href=\"#逐个文件计算\" class=\"headerlink\" title=\"逐个文件计算\"></a>逐个文件计算</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pepstats -sequence F01_bin.1.faa -outfile F01_bin.1.out</span><br></pre></td></tr></table></figure>\n<p>:::primary 参数解析</p>\n<ul>\n<li><p>Standard (Mandatory) qualifiers:</p>\n<ul>\n<li>[-sequence]          seqall     Protein sequence(s) filename and optional<br>                        format, or reference (input USA)</li>\n<li>[-outfile]           outfile    [*.pepstats] Pepstats program output file</li>\n</ul>\n</li>\n<li><p>Advanced (Unprompted) qualifiers:</p>\n<ul>\n<li>-aadata             datafile   [Eamino.dat] Amino acid properties</li>\n<li>-mwdata             datafile   [Emolwt.dat] Molecular weight data for amino<br>                        acids</li>\n<li>-pkdata             datafile   [Epk.dat] Values of pKa for amino acids</li>\n<li>-[no]termini        boolean    [Y] Include charge at N and C terminus</li>\n<li>-mono               boolean    [N] Use monoisotopic weights</li>\n</ul>\n</li>\n</ul>\n<p>:::</p>\n<h2 id=\"批量计算与pI提取并输出为相对丰度\"><a href=\"#批量计算与pI提取并输出为相对丰度\" class=\"headerlink\" title=\"批量计算与pI提取并输出为相对丰度\"></a>批量计算与pI提取并输出为相对丰度</h2><figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/perl</span></span><br><span class=\"line\"><span class=\"keyword\">use</span> strict;</span><br><span class=\"line\"><span class=\"keyword\">use</span> warnings;</span><br><span class=\"line\"><span class=\"comment\"># name: print_pI.pl</span></span><br><span class=\"line\"><span class=\"comment\"># Author: Liu Hualin</span></span><br><span class=\"line\"><span class=\"comment\"># Date: 2022.01.03</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">my</span> @genome = <span class=\"keyword\">glob</span>(<span class=\"string\">&quot;*.faa&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">foreach</span>  (@genome) &#123;</span><br><span class=\"line\">\t$_=~<span class=\"regexp\">/(\\S+).faa/</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">my</span> $out = $1 . <span class=\"string\">&quot;.pepstats&quot;</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">my</span> $pi = $1 . <span class=\"string\">&quot;.pI&quot;</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">system</span>(<span class=\"string\">&quot;pepstats -sequence $_ -outfile $out&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">my</span> %hash;</span><br><span class=\"line\">\t<span class=\"keyword\">my</span> $seqnum = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">open</span> IN, <span class=\"string\">&quot;$out&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">chomp</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"regexp\">/^(Isoelectric Point = )(\\S+)/</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">my</span> $pi = <span class=\"keyword\">sprintf</span> <span class=\"string\">&quot;%.1f&quot;</span>, $2;</span><br><span class=\"line\">\t\t\t$hash&#123;$pi&#125;++;</span><br><span class=\"line\">\t\t\t$seqnum++;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">close</span> IN;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">#my @records = values %hash;</span></span><br><span class=\"line\">\t<span class=\"comment\">#my $seqnum = @records;</span></span><br><span class=\"line\">\t<span class=\"comment\">#print $seqnum . &quot;\\n&quot;;</span></span><br><span class=\"line\">\t<span class=\"keyword\">open</span> OUT, <span class=\"string\">&quot;&gt;$pi&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;Isoelectric point\\tRelative frequency\\n&quot;</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">foreach</span>  (<span class=\"keyword\">keys</span> %hash) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">my</span> $frequency = <span class=\"keyword\">sprintf</span> <span class=\"string\">&quot;%.2f&quot;</span>, $hash&#123;$_&#125;/$seqnum;<span class=\"comment\">#@records;</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;$_\\t$frequency\\n&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">close</span> OUT;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"选择性忽略-（这是我自己用的）\"><a href=\"#选择性忽略-（这是我自己用的）\" class=\"headerlink\" title=\"选择性忽略 （这是我自己用的）\"></a>选择性忽略 （这是我自己用的）</h2><figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/perl</span></span><br><span class=\"line\"><span class=\"keyword\">use</span> strict;</span><br><span class=\"line\"><span class=\"keyword\">use</span> warnings;</span><br><span class=\"line\"><span class=\"comment\"># name: co_sample_pI.pl</span></span><br><span class=\"line\"><span class=\"comment\"># Author: Liu Hualin</span></span><br><span class=\"line\"><span class=\"comment\"># Date: 2022.01.03</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">open</span> OUT, <span class=\"string\">&quot;&gt;F06.pi&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;MAGs\\tIsoelectric point\\tRelative frequency\\n&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">my</span> @pI = <span class=\"keyword\">glob</span>(<span class=\"string\">&quot;F06*.pI&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">foreach</span>  (@pI) &#123;</span><br><span class=\"line\">\t$_=~<span class=\"regexp\">/(\\S+).pI/</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">my</span> $mag = $1;</span><br><span class=\"line\">\t<span class=\"keyword\">open</span> IN, <span class=\"string\">&quot;$_&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\">\t&lt;IN&gt;;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">chomp</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;$mag\\t$_\\n&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">close</span> IN;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">close</span> OUT;</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"可视化\"><a href=\"#可视化\" class=\"headerlink\" title=\"可视化\"></a>可视化</h1><h2 id=\"绘制蛋白质组的全局-pIs图\"><a href=\"#绘制蛋白质组的全局-pIs图\" class=\"headerlink\" title=\"绘制蛋白质组的全局 pIs图\"></a>绘制蛋白质组的全局 pIs图</h2><figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Step 1 读入数据</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/Results/Annotations/AAs&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">F1 <span class=\"operator\">&lt;-</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;F01_bin.1.pI&quot;</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span> header <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Step 2 绘图，以下5选1</span></span><br><span class=\"line\"><span class=\"comment\">## 单组加点，运行完后跳到Step 3</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>F1<span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>Isoelectric.point<span class=\"punctuation\">,</span> Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_point<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">2</span><span class=\"punctuation\">,</span>shape<span class=\"operator\">=</span><span class=\"number\">21</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_smooth<span class=\"punctuation\">(</span>method<span class=\"operator\">=</span> <span class=\"string\">&quot;gam&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 单组无点，运行完后跳到Step 3</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>F1<span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>Isoelectric.point<span class=\"punctuation\">,</span> Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_smooth<span class=\"punctuation\">(</span>method<span class=\"operator\">=</span> <span class=\"string\">&quot;gam&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 多组加点</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>F1<span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>Isoelectric.point<span class=\"punctuation\">,</span> Relative.frequency<span class=\"punctuation\">,</span> color<span class=\"operator\">=</span>MAGs<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_point<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">3</span><span class=\"punctuation\">,</span>shape<span class=\"operator\">=</span><span class=\"number\">21</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_smooth<span class=\"punctuation\">(</span>method<span class=\"operator\">=</span> <span class=\"string\">&quot;gam&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 多组无点显示置信区间</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>F1<span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>Isoelectric.point<span class=\"punctuation\">,</span> Relative.frequency<span class=\"punctuation\">,</span> color<span class=\"operator\">=</span>MAGs<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_smooth<span class=\"punctuation\">(</span>method<span class=\"operator\">=</span> <span class=\"string\">&quot;gam&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 多组无点去除置信区间</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>F1<span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>Isoelectric.point<span class=\"punctuation\">,</span> Relative.frequency<span class=\"punctuation\">,</span> color<span class=\"operator\">=</span>MAGs<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>geom_smooth<span class=\"punctuation\">(</span>method<span class=\"operator\">=</span> <span class=\"string\">&quot;gam&quot;</span><span class=\"punctuation\">,</span>se <span class=\"operator\">=</span> <span class=\"literal\">FALSE</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Step 3 美化，看下图</span></span><br><span class=\"line\">p1 <span class=\"operator\">+</span> scale_x_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_y_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">0.01</span><span class=\"punctuation\">,</span> <span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span><span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"number\">0.01</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x<span class=\"operator\">=</span> <span class=\"string\">&quot;Isoelectric point&quot;</span><span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> <span class=\"string\">&quot;Relative frequency&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## ==============以下代码为自用========================</span></span><br><span class=\"line\"><span class=\"comment\">## F04自定义颜色</span></span><br><span class=\"line\">p1 <span class=\"operator\">+</span> scale_x_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_y_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">0.01</span><span class=\"punctuation\">,</span> <span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span><span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"number\">0.01</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x<span class=\"operator\">=</span> <span class=\"string\">&quot;Isoelectric point&quot;</span><span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> <span class=\"string\">&quot;Relative frequency&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_color_manual<span class=\"punctuation\">(</span>name<span class=\"operator\">=</span><span class=\"string\">&quot;MAGs&quot;</span><span class=\"punctuation\">,</span> values<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## F05自定义颜色</span></span><br><span class=\"line\">p1 <span class=\"operator\">+</span> scale_x_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_y_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">0.01</span><span class=\"punctuation\">,</span> <span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span><span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"number\">0.01</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x<span class=\"operator\">=</span> <span class=\"string\">&quot;Isoelectric point&quot;</span><span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> <span class=\"string\">&quot;Relative frequency&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_color_manual<span class=\"punctuation\">(</span>name<span class=\"operator\">=</span><span class=\"string\">&quot;MAGs&quot;</span><span class=\"punctuation\">,</span> values<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## F06自定义颜色</span></span><br><span class=\"line\">p1 <span class=\"operator\">+</span> scale_x_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">14</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_y_continuous<span class=\"punctuation\">(</span>limits<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">0.01</span><span class=\"punctuation\">,</span> <span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span><span class=\"built_in\">max</span><span class=\"punctuation\">(</span>F1<span class=\"operator\">$</span>Relative.frequency<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"number\">0.01</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x<span class=\"operator\">=</span> <span class=\"string\">&quot;Isoelectric point&quot;</span><span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> <span class=\"string\">&quot;Relative frequency&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> scale_color_manual<span class=\"punctuation\">(</span>name<span class=\"operator\">=</span><span class=\"string\">&quot;MAGs&quot;</span><span class=\"punctuation\">,</span> values<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#5254a3&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#000000&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"蛋白质组的全局 pIs\"></p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><p><a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n</li>\n<li><p><a href=\"http://emboss.sourceforge.net/\">EMBOSS</a></p>\n</li>\n</ul>\n<h1 id=\"代码获取\"><a href=\"#代码获取\" class=\"headerlink\" title=\"代码获取\"></a>代码获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“85d7”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"WGS","path":"api/tags/WGS.json"},{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"蛋白质组","path":"api/tags/蛋白质组.json"}]},{"title":"利用GTDB-TK对细菌和古菌基因组进行物种分类","slug":"利用GTDB-TK对细菌和古菌基因组进行物种分类","date":"2021-12-10T03:14:45.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/利用GTDB-TK对细菌和古菌基因组进行物种分类.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>GTDB-Tk 是一个软件工具包，用于根据<ruby>基因组数据库分类 GTDB<rt>Genome Database Taxonomy GTDB</rt></ruby> 为细菌和古菌基因组<ruby>分配客观分类学分类<rt>assigning objective taxonomic classifications</rt></ruby>。可以用于宏基因组组装基因组 (MAG)、单菌基因组和单细胞基因组。</p>\n<h1 id=\"安装GTDB-Tk\"><a href=\"#安装GTDB-Tk\" class=\"headerlink\" title=\"安装GTDB-Tk\"></a>安装GTDB-Tk</h1><ul>\n<li><p>通过conda安装主程序</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># latest version</span></span><br><span class=\"line\">conda create -n gtdbtk -c conda-forge -c bioconda gtdbtk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># specific version (replace 2.3.0 with the version you wish to install, recommended)</span></span><br><span class=\"line\">conda create -n gtdbtk -c conda-forge -c bioconda gtdbtk=2.3.0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>下载GTDB-Tk数据库 (~47 G)</p>\n<p>最新版本的数据库为R214，需要 &gt;&#x3D;2.1.0 版本的GTDB-Tk。</p>\n<ul>\n<li><p>自动 (非常慢)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">download-db.sh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>手动</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> \t<span class=\"comment\"># 找到下载脚本的路径并打开，从中找到数据库的链接</span></span><br><span class=\"line\"><span class=\"built_in\">which</span> download-db.sh</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># 进入数据库默认路径</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/miniconda3/envs/gtdbtk/share/gtdbtk-2.3.0/db/</span><br><span class=\"line\">\t  </span><br><span class=\"line\">   <span class=\"comment\"># 用wget下载 (非常慢)，推荐在Windows下用其他软件下载，再上传服务器</span></span><br><span class=\"line\"><span class=\"built_in\">nohup</span> wget -c https://data.gtdb.ecogenomic.org/releases/release214/214.0/auxillary_files/gtdbtk_r214_data.tar.gz --no-check-certificate &amp;</span><br><span class=\"line\"></span><br><span class=\"line\">tar zxvf gtdbtk_r214_data.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">mv</span> release214/* ./</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 也可自定义数据库的存放位置</span></span><br><span class=\"line\">编辑`~/miniconda3/envs/gtdbtk/etc/conda/activate.d/gtdbtk.sh`，将`<span class=\"built_in\">export</span> GTDBTK_DATA_PATH=`后面的内容改成数据库所在的路径。</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"运行软件\"><a href=\"#运行软件\" class=\"headerlink\" title=\"运行软件\"></a>运行软件</h1><p>:::info<br>注意：pplacer requires ~215 GB of RAM to fully load the bacterial tree into memory. 因此要么在服务器上运行，要么设置足够大的swap分区方可在PC中运行。<br>:::</p>\n<h2 id=\"classify-wf\"><a href=\"#classify-wf\" class=\"headerlink\" title=\"classify_wf\"></a>classify_wf</h2><p>:::default<br>可以通过<code>classify_wf</code>命令完成整个工作流程。<br>:::</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># v2.3.0增加了两个参数（二选一）：--skip_ani_screen，--mash_db，前者无参数值，后者指定MASH参考数据库 (.msh)的输出或读取路径</span></span><br><span class=\"line\">gtdbtk classify_wf --genome_dir &lt;my_genomes&gt; --out_dir &lt;output_dir&gt; --extension fna --cpus 20 --force --skip_ani_screen</span><br></pre></td></tr></table></figure>\n\n<p>+++primary 参数解析</p>\n<ul>\n<li><p>--genome_dir<br>directory containing genome files in FASTA format</p>\n</li>\n<li><p>--batchfile<br>path to file describing genomes - tab separated in 2 or 3 columns (FASTA file, genome ID, translation table [optional])</p>\n</li>\n<li><p>--out_dir<br>directory to output files</p>\n</li>\n<li><p>--skip_ani_screen     Skip the ani_screening step to classify genomes using mash and FastANI (default: False)</p>\n</li>\n<li><p>--mash_db MASH_DB     path to save&#x2F;read (if exists) the Mash reference sketch database (.msh)</p>\n</li>\n<li><p>-x, --extension<br>extension of files to process, gz &#x3D; gzipped (Default: fna)</p>\n</li>\n<li><p>--min_perc_aa<br>exclude genomes that do not have at least this percentage of AA in the MSA (inclusive bound) (Default: 10)</p>\n</li>\n<li><p>--prefix<br>prefix for all output files (Default: gtdbtk)</p>\n</li>\n<li><p>--cpus<br>number of CPUs to use (Default: 1)</p>\n</li>\n<li><p>--pplacer_cpus<br>use pplacer_cpus during placement (default: cpus)</p>\n</li>\n<li><p>--force<br>continue processing if an error occurs on a single genome</p>\n</li>\n<li><p>--scratch_dir<br>Reduce pplacer memory usage by writing to disk (slower).</p>\n</li>\n<li><p>--min_af<br>minimum alignment fraction to consider closest genome (Default: 0.65)</p>\n</li>\n<li><p>--tmpdir<br>specify alternative directory for temporary files （Default: &#x2F;tmp</p>\n</li>\n<li><p>--debug<br>create intermediate files for debugging purposes<br>+++</p>\n</li>\n</ul>\n<p>:::default<br>但下面我们演示分步运行。在处理大型管道时，单独运行这些步骤有时会很有用。<br>:::</p>\n<h2 id=\"Step-1-准备输入文件\"><a href=\"#Step-1-准备输入文件\" class=\"headerlink\" title=\"Step 1 准备输入文件\"></a>Step 1 准备输入文件</h2><p>以下两个基因组作为示例文件：* Genome A: <code>GCF_003947435.1</code> [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> &#x2F; <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCF_003947435.1/\">NCBI</a>] * Genome B: <code>GCA_002011125.1</code> [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> &#x2F; <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCA_002011125.1/\">NCBI</a>]。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Create the directory.</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /tmp/gtdbtk &amp;&amp; <span class=\"built_in\">cd</span> /tmp/gtdbtk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Obtain the genomes.</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /tmp/gtdbtk/genomes</span><br><span class=\"line\">wget -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/003/947/435/GCF_003947435.1_ASM394743v1/GCF_003947435.1_ASM394743v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_a.fna.gz</span><br><span class=\"line\"></span><br><span class=\"line\">wget -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/002/011/125/GCA_002011125.1_ASM201112v1/GCA_002011125.1_ASM201112v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_b.fna.gz</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-2-Gene-calling-identify\"><a href=\"#Step-2-Gene-calling-identify\" class=\"headerlink\" title=\"Step 2 Gene calling (identify)\"></a>Step 2 Gene calling (identify)</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk identify --genome_dir /tmp/gtdbtk/genomes --out_dir /tmp/gtdbtk/identify --extension gz --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>获得的基因和<ruby>标记<rt>marker</rt></ruby>信息可以在每个<ruby>基因组反应中间文件目录<rt>genomes respeective intermediate files directory</rt></ruby>下找到，如下所示。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/identify/identify/intermediate_results/marker_genes/genome_a.fna/</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam<span class=\"built_in\">_</span>tophit.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.gff.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam<span class=\"built_in\">_</span>tophit.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.out</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.out.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam<span class=\"built_in\">_</span>tophit.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.faa</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam<span class=\"built_in\">_</span>tophit.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.faa.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.fna</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.fna.sha256</span><br><span class=\"line\">prodigal<span class=\"built_in\">_</span>translation<span class=\"built_in\">_</span>table.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.gff</span><br><span class=\"line\">prodigal<span class=\"built_in\">_</span>translation<span class=\"built_in\">_</span>table.tsv.sha256</span><br></pre></td></tr></table></figure>\n<p>:::default<br>大部分情况下只需要读取摘要文件，其中详细说明了从archaeal 122或bacterial 120<ruby>标记集<rt>marker set</rt></ruby>识别的标记。<br>:::</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> /tmp/gtdbtk/identify/gtdbtk.ar122.markers_summary.tsv</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name    number<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes     number<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>genes   number<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes    number<span class=\"built_in\">_</span>missing<span class=\"built_in\">_</span>genes    list<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes       list<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>genes     list<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes      list<span class=\"built_in\">_</span>missing<span class=\"built_in\">_</span>genes</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna    109     3       0       10      PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,PF13685.1,TIGR00021,TIGR00037,TIGR00042,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00549,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01213,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02390,TIGR02651,TIGR03626,TIGR03627,TIGR03628,TIGR03636,TIGR03653,TIGR03665,TIGR03671,TIGR03672,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684    PF01496.14,TIGR00458,TIGR00658          PF01866.12,TIGR00064,TIGR00373,TIGR00522,TIGR02338,TIGR02389,TIGR03629,TIGR03670,TIGR03673,TIGR03722</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>b.fna    118     2       0       2       PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01866.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,TIGR00021,TIGR00037,TIGR00042,TIGR00064,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00373,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00458,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00522,TIGR00549,TIGR00658,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02338,TIGR02389,TIGR02390,TIGR02651,TIGR03626,TIGR03628,TIGR03629,TIGR03636,TIGR03653,TIGR03665,TIGR03670,TIGR03671,TIGR03672,TIGR03673,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684,TIGR03722 PF01496.14,PF13685.1            TIGR01213,TIGR03627</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"Step-3-Aligning-genomes-align\"><a href=\"#Step-3-Aligning-genomes-align\" class=\"headerlink\" title=\"Step 3 Aligning genomes (align)\"></a>Step 3 Aligning genomes (align)</h2><p>该步骤将对齐所有已识别的标记，确定最可能的<ruby>域<rt>domain </rt></ruby>并输出串联的MSA。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk align --identify_dir /tmp/gtdbtk/identify --out_dir /tmp/gtdbtk/align --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>:::warning<br>要注意输出，如果一个基因组识别出的标记数量较少，那么在这一步，它将被排除在分析之外。如果出现这种情况，将出现警告。<br>:::</p>\n<p>根据domain的不同，<code>ar122</code>或<code>bac120</code>的前缀文件将出现，其中包含用户基因组和GTDB基因组的MSA，或仅包含用户基因组（<code>gtdbtk.ar122.MSA.fasta</code>和<code>gtdbtk.ar122.user_MSA.fasta</code>）。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/align</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">align/</span><br><span class=\"line\">gtdbtk.ar122.user<span class=\"built_in\">_</span>msa.fasta</span><br><span class=\"line\">identify/</span><br><span class=\"line\">gtdbtk.ar122.filtered.tsv</span><br><span class=\"line\">gtdbtk.log</span><br><span class=\"line\">gtdbtk.ar122.msa.fasta</span><br><span class=\"line\">gtdbtk.warnings.log</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"Step-4-基因组分类-classify\"><a href=\"#Step-4-基因组分类-classify\" class=\"headerlink\" title=\"Step 4 基因组分类 (classify)\"></a>Step 4 基因组分类 (classify)</h2><p>将用户的基因组放置于参考树上，然后决定其最为可能的分类。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk classify --genome_dir /tmp/gtdbtk/genomes --align_dir /tmp/gtdbtk/align --out_dir /tmp/gtdbtk/classify -x gz --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>两个主要的输出文件包括<ruby>总结文件<rt>summary file</rt></ruby>和包含基因组的参考树 (<code>gtdbtk.ar122.summary.tsv</code>和<code>gtdbtk.ar122.classify.tree</code>)。基因组的分类信息呈现于总结文件中。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/classify</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classify/</span><br><span class=\"line\">gtdbtk.ar122.summary.tsv</span><br><span class=\"line\">gtdbtk.warnings.log</span><br><span class=\"line\">gtdbtk.ar122.classify.tree</span><br><span class=\"line\">gtdbtk.log</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"错误信息处理\"><a href=\"#错误信息处理\" class=\"headerlink\" title=\"错误信息处理\"></a>错误信息处理</h2><ul>\n<li><p>OpenBLAS blas_thread_init: pthread_create failed for thread 109 of 128: Resource temporarily unavailable</p>\n<ul>\n<li>解决方案：少调用一些线程就ok了。</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://ecogenomics.github.io/GTDBTk\">GTBD-Tk Documentation</a></li>\n</ul>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"WGS","path":"api/tags/WGS.json"},{"name":"生信软件","path":"api/tags/生信软件.json"}]},{"title":"宏病毒组分析流程1-VirSorter2","slug":"宏病毒组分析流程1-VirSorter2","date":"2021-12-02T01:35:30.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/宏病毒组分析流程1-VirSorter2.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","content":"<h1 id=\"安装软件\"><a href=\"#安装软件\" class=\"headerlink\" title=\"安装软件\"></a>安装软件</h1><ul>\n<li><p>安装主程序及依赖</p>\n<p>:::default</p>\n<ul>\n<li><a href=\"https://bitbucket.org/MAVERICLab/virsorter2/src/master\">VirSorter2</a> (version &gt;&#x3D;2.2.3)</li>\n<li><a href=\"https://bitbucket.org/berkeleylab/checkv/src/master\">CheckV</a> (version &gt;&#x3D;0.7.0)</li>\n<li><a href=\"https://github.com/shafferm/DRAM\">DRAMv</a> (version &gt;&#x3D;1.2.0)<br>:::</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n virome virsorter=2 checkv dram</span><br><span class=\"line\">conda activate virome</span><br></pre></td></tr></table></figure></li>\n<li><p>下载数据库</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># vs2 db: db-vs2 ~ 10 min</span></span><br><span class=\"line\">virsorter setup -d /new_data/hualin/db/db-vs2 -j 50</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># checkv db: checkv-db-v1.0  &lt; 5 mins</span></span><br><span class=\"line\">checkv download_database /new_data/hualin/db/checkv</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># DRAMv: db-dramv ~5h and ~60GB of memory</span></span><br><span class=\"line\">DRAM-setup.py prepare_databases --skip_uniref --output_dir db-dramv</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h1 id=\"预测\"><a href=\"#预测\" class=\"headerlink\" title=\"预测\"></a>预测</h1><ul>\n<li><p>获取测试数据</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O test.fa https://bitbucket.org/MAVERICLab/virsorter2/raw/15a21fa9c1ee1d2af52b0148b167292e549d356e/test/test-for-sop.fa</span><br></pre></td></tr></table></figure></li>\n<li><p>运行VirSorter2</p>\n<p>  +++info 命令解析</p>\n<ul>\n<li>首先以0.5 的score阈值运行VirSorter2 以保证最大的灵敏度。</li>\n<li>只关注噬菌体 (dsDNA and ssDNA phage)，可选dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae。</li>\n<li>序列最小长度为5000 bp，后续病毒分类的最低要求如此。 </li>\n<li>可根据自己的CPU核心数自行调整 “-j”。</li>\n<li>“–keep-original-seq” 保留了环状和接近完整的病毒contigs (score &gt;0.8 as a whole sequence)，后续将通过checkV修剪其尾端的潜在宿主基因并处理重复的环状contigs片段。<br>  +++</li>\n</ul>\n<p>  :::default<br>  Time: 31m7.310s with a real dataset of 90.52 MB and 207,544 sequences<br>  :::</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virsorter run --keep-original-seq -w vs2-pass1 -i test.fa --include-groups dsDNAphage,ssDNA --min-length 5000  --min-score 0.5 -j 50 all</span><br></pre></td></tr></table></figure>\n\n<p>  +++primary 参数解析<br>  -w 指定输出目录<br>  -i 指定输入序列<br>  --min-length 过滤短序列<br>  --min-score 分数阈值<br>  --keep-original-seq 保留环状和接近完整的病毒contigs<br>  --include-groups 指定包含的病毒类型，用“,”分隔。可选：dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae<br>  -j 线程数<br>  all 直接写上就可以<br>  +++</p>\n<p>  +++success 结果解析</p>\n<ul>\n<li><p>final-viral-combined.fa: 病毒序列</p>\n<ul>\n<li>鉴定为病毒的完整序列（标识为后缀 ||full）；</li>\n<li>鉴定为病毒的部分序列（用后缀 ||{i}_partial 标识）； {i} 可以是从 0 到该Contig中发现的最大病毒片段数的数字；</li>\n<li>带有<ruby>标志基因<rt>hallmark gene</rt></ruby>的短序列（少于两个基因）被鉴定为病毒（用后缀 ||lt2gene 标识）；</li>\n</ul>\n</li>\n<li><p>final-viral-score.tsv: 每个病毒序列的评分跨组和一些关键特征，这可以用于进一步过滤</p>\n<ul>\n<li>sequence name</li>\n<li>score of each viral sequences across groups (多列)</li>\n<li>max score across groups</li>\n<li>max score group</li>\n<li>contig length</li>\n<li>hallmark gene count</li>\n<li>viral gene %</li>\n<li>nonviral gene %</li>\n</ul>\n</li>\n</ul>\n  <div style=\"width:100%;overflow:scroll;\">\n      <table border=\"1\" rules=\"all\" style=\"width:2000px; height:100px; text-align:center\">\n          <tr>\n          <td>seqname</td>\n          <td>dsDNAphage</td>\n          <td>NCLDV</td>\n          <td>RNA</td>\n          <td>ssDNA</td>\n          <td>lavidaviridae</td>\n          <td>max_score</td>\n          <td>max_score_group</td>\n          <td>length</td>\n          <td>hallmark</td>\n          <td>viral</td>\n          <td>cellular</td>\n          </tr>\n          <tr>\n          <td>NODE_5_length_17317_cov_8.385876&#124;&#124;full</td>\n          <td>0.993</td>\n          <td>0.847</td>\n          <td>0.005</td>\n          <td>0.060</td>\n          <td>0.467</td>\n          <td>0.993</td>\n          <td>dsDNAphage</td>\n          <td>17315</td>\n          <td>2</td>\n          <td>64.700</td>\n          <td>5.900</td>\n          </tr>\n          <tr>\n          <td>NODE_6_length_16611_cov_115.615064&#124;&#124;full</td>\n          <td>0.920</td>\n          <td>0.207</td>\n          <td>0.035</td>\n          <td>0.087</td>\n          <td>0.053</td>\n          <td>0.920</td>\n          <td>dsDNAphage</td>\n          <td>16610</td>\n          <td>0</td>\n          <td>3.200</td>\n          <td>0.000</td>\n          </tr>\n          <tr>\n          <td>NODE_8_length_14848_cov_778.417157&#124;&#124;full</td>\n          <td>1.000</td>\n          <td>0.220</td>\n          <td>0.105</td>\n          <td>0.380</td>\n          <td>0.627</td>\n          <td>1.000</td>\n          <td>dsDNAphage</td>\n          <td>14848</td>\n          <td>15</td>\n          <td>100.000</td>\n          <td>0.000</td>\n          </tr>\n          <tr>\n          <td>NODE_16_length_12563_cov_14.331948&#124;&#124;full</td>\n          <td>0.973</td>\n          <td>0.200</td>\n          <td>0.165</td>\n          <td>0.273</td>\n          <td>0.227</td>\n          <td>0.973</td>\n          <td>dsDNAphage</td>\n          <td>12083</td>\n          <td>0</td>\n          <td>8.000</td>\n          <td>0.000</td>\n          </tr>\n          <tr>\n          <td>NODE_17_length_11885_cov_350.043956&#124;&#124;full</td>\n          <td>0.653</td>\n          <td>0.513</td>\n          <td>0.050</td>\n          <td>0.080</td>\n          <td>0.047</td>\n          <td>0.653</td>\n          <td>dsDNAphage</td>\n          <td>11885</td>\n          <td>0</td>\n          <td>9.100</td>\n          <td>0.000</td>\n          </tr>\n          <tr>\n          <td>NODE_21_length_11527_cov_216.405073&#124;&#124;full</td>\n          <td>0.620</td>\n          <td>0.407</td>\n          <td>0.000</td>\n          <td>0.013</td>\n          <td>0.060</td>\n          <td>0.620</td>\n          <td>dsDNAphage</td>\n          <td>11526</td>\n          <td>0</td>\n          <td>10.500</td>\n          <td>5.300</td>\n          </tr>\n          <tr>\n          <td>NODE_23_length_11316_cov_8.144303&#124;&#124;full</td>\n          <td>0.367</td>\n          <td>0.540</td>\n          <td>0.010</td>\n          <td>0.000</td>\n          <td>0.400</td>\n          <td>0.540</td>\n          <td>NCLDV</td>\n          <td>11313</td>\n          <td>1</td>\n          <td>23.100</td>\n          <td>7.700</td>\n          </tr>\n      </table>\n  </div>\n  \n<p>  :::warning<br>  不同病毒类群的分类器并非相互排斥，它们的<ruby>目标病毒序列空间<rt>target viral sequence space</rt></ruby>可能存在重叠，这意味着该信息不应被使用或当作<ruby>可靠的分类<rt>reliable taxonomic classification</rt></ruby>。VirSorter2的用途仅限于病毒鉴定。<br>  :::</p>\n<ul>\n<li><p>final-viral-boundary.tsv: 带有边界信息的表 (与其他两个文件相比，可能有额外的记录，应该忽略)。</p>\n<p>only some of the columns in this file might be useful:</p>\n<ul>\n<li>seqname: original sequence name</li>\n<li>trim_orf_index_start, trim_orf_index_end: start and end ORF index on orignal sequence of identified viral sequence</li>\n<li>trim_bp_start, trim_bp_end: start and end position on orignal sequence of identified viral sequence</li>\n<li>trim_pr: score of final trimmed viral sequence</li>\n<li>partial: full sequence as viral or partial sequence as viral; this is defined when a full sequence has score &gt; score cutoff, it is full (0), or else any viral sequence extracted within it is partial (1)</li>\n<li>pr_full: score of the original sequence</li>\n<li>hallmark_cnt: hallmark gene count</li>\n<li>group: the classifier of viral group that gives high score; this should NOT be used as reliable classification</li>\n</ul>\n</li>\n</ul>\n  <div style=\"width:100%;overflow:scroll;\">\n      <table border=\"1\" rules=\"all\" style=\"width:2000px; height:100px; text-align:center\">\n          <tr>\n      <td>seqname</td>\n      <td>trim_orf_index_start</td>\n      <td>trim_orf_index_end</td>\n      <td>trim_bp_start</td>\n      <td>trim_bp_end</td>\n      <td>trim_pr</td>\n      <td>trim_pr_max</td>\n      <td>prox_orf_index_start</td>\n      <td>prox_orf_index_end</td>\n      <td>prox_bp_start</td>\n      <td>prox_bp_end</td>\n      <td>prox_pr</td>\n      <td>prox_pr_max</td>\n      <td>partial</td>\n      <td>full_orf_index_start</td>\n      <td>full_orf_index_end</td>\n      <td>full_bp_start</td>\n      <td>full_bp_end</td>\n      <td>pr_full</td>\n      <td>arc</td>\n      <td>bac</td>\n      <td>euk</td>\n      <td>vir</td>\n      <td>mix</td>\n      <td>unaligned</td>\n      <td>hallmark_cnt</td>\n      <td>group</td>\n      <td>shape</td>\n      <td>seqname_new</td>\n          </tr>\n          <tr>\n      <td>NODE_999_length_4026_cov_7.610929</td>\n      <td>1</td>\n      <td>12</td>\n      <td>1</td>\n      <td>4025</td>\n      <td>0.547</td>\n      <td>0.547</td>\n      <td>1</td>\n      <td>12</td>\n      <td>1</td>\n      <td>4025</td>\n      <td>nan</td>\n      <td>nan</td>\n      <td>0</td>\n      <td>1</td>\n      <td>12</td>\n      <td>1</td>\n      <td>4025</td>\n      <td>0.547</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>100.0</td>\n      <td>0</td>\n      <td>dsDNAphage</td>\n      <td>linear</td>\n      <td>NODE_999_length_4026_cov_7.610929||full</td>\n          </tr>\n          <tr>\n      <td>NODE_9999_length_1276_cov_11.598690</td>\n      <td>1</td>\n      <td>3</td>\n      <td>3</td>\n      <td>1274</td>\n      <td>0.955</td>\n      <td>0.955</td>\n      <td>1</td>\n      <td>3</td>\n      <td>3</td>\n      <td>1274</td>\n      <td>nan</td>\n      <td>nan</td>\n      <td>0</td>\n      <td>1</td>\n      <td>3</td>\n      <td>3</td>\n      <td>1274</td>\n      <td>0.955</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>100.0</td>\n      <td>0</td>\n      <td>RNA</td>\n      <td>linear</td>\n      <td>NODE_9999_length_1276_cov_11.598690||full</td>\n          </tr>\n          <tr>\n      <td>NODE_99999_length_314_cov_4.000000</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>287</td>\n      <td>0.57</td>\n      <td>0.57</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>287</td>\n      <td>nan</td>\n      <td>nan</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>287</td>\n      <td>0.57</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>50.0</td>\n      <td>50.0</td>\n      <td>0</td>\n      <td>RNA</td>\n      <td>linear</td>\n      <td>NODE_99999_length_314_cov_4.000000||full</td>\n          </tr>\n          <tr>\n      <td>NODE_99992_length_314_cov_4.389961</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>275</td>\n      <td>0.747</td>\n      <td>0.747</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>275</td>\n      <td>nan</td>\n      <td>nan</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>275</td>\n      <td>0.747</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>100.0</td>\n      <td>0</td>\n      <td>ssDNA</td>\n      <td>linear</td>\n      <td>NODE_99992_length_314_cov_4.389961||full</td>\n          </tr>\n          <tr>\n      <td>NODE_9997_length_1276_cov_44.113841</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>1240</td>\n      <td>0.98</td>\n      <td>0.98</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>1240</td>\n      <td>nan</td>\n      <td>nan</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>1240</td>\n      <td>0.98</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>50.0</td>\n      <td>50.0</td>\n      <td>0</td>\n      <td>RNA</td>\n      <td>linear</td>\n      <td>NODE_9997_length_1276_cov_44.113841||full</td>\n          </tr>\n      </table>\n  </div>\n  \n<p>  :::warning<br>  在<ruby>原病毒<rt>provirus </rt></ruby>提取过程中，为了获得更好的敏感性，VirSorter2有时会高估病毒序列的大小。建议清除这些前病毒预测，以去除预测病毒区域边缘的潜在宿主基因，例如使用<a href=\"https://bitbucket.org/berkeleylab/checkv\">CheckV</a>等工具。<br>  :::</p>\n<p>  :::primary<br>  How to pick a score cutoff?<br>  :::</p>\n<p>  一般来说，score&gt;0.9的人为高置信度。得分在 0.5 到 0.9 之间的可能是病毒和非病毒的混合体。很难确定区分病毒和非病毒的最佳分数，因为它取决于宿主序列和未知序列的百分比。因此，[建议使用默认截止值 (0.5) 以获得最大灵敏度，然后使用 checkV 应用质量检查步骤以消除误报（预测完整性除外）]{.rainbow}。&#x3D;&#x3D;请继续下面的流程。&#x3D;&#x3D;<br>  +++</p>\n</li>\n<li><p>运行checkV</p>\n<p>  +++info 命令解析<br>  Score阈值设为0.5时，VirSorter2结果中可能存在一些非病毒序列或区域。因此，使用CheckV对VirSorter2的结果进行质量控制，并修剪在<ruby>原病毒<rt>proviruses</rt></ruby>末端留下的潜在宿主区域。可以根据CPU内核的可用性调整-t选项。<br>  +++</p>\n<p>  :::default<br>  Time: 0m28.795s<br>  :::</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">checkv end_to_end vs2-pass1/final-viral-combined.fa checkv -t 50 -d /new_data/hualin/db/checkv/checkv-db-v1.0</span><br></pre></td></tr></table></figure>\n\n<p>  +++success 结果解析</p>\n<ul>\n<li>.&#x2F;checkv&#x2F;</li>\n<li>completeness.tsv</li>\n<li>complete_genomes.tsv</li>\n<li>contamination.tsv</li>\n<li>proviruses.fna</li>\n<li>quality_summary.tsv</li>\n<li>viruses.fna</li>\n<li>tmp<br>  +++</li>\n</ul>\n</li>\n<li><p>再次运行VirSorter2 </p>\n<p>+++info 命令解析</p>\n<ul>\n<li>再次利用checkV-trimmed序列运行VirSorter2以得到”affi-contigs.tab”文件，该文件将作为DRAMv的输入以鉴定AMGs。</li>\n<li>注意”--seqname-suffix-off”选项保留了原始的输入序列名称，因为我们确信在本步骤中，不可能从同一条contig中获得&gt;1个原病毒。</li>\n<li>“--viral-gene-enrich-off”选项关闭了病毒基因要多于宿主基因的要求，以确保VirSorter2在这一步不做任何筛查。</li>\n<li>以上两个选项需要VirSorter2版本&gt;&#x3D;2.2.1。</li>\n<li>可选所有病毒：dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae<br>+++</li>\n</ul>\n<p>:::default<br>  Time: 18m30.896s<br>  :::</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> checkv/proviruses.fna checkv/viruses.fna &gt; checkv/combined.fna</span><br><span class=\"line\"></span><br><span class=\"line\">virsorter run --seqname-suffix-off --viral-gene-enrich-off --provirus-off --prep-for-dramv -i checkv/combined.fna -w vs2-pass2 --include-groups dsDNAphage,ssDNA --min-length 5000 --min-score 0.5 -j 50 all</span><br></pre></td></tr></table></figure>\n\n<p>  +++success 结果解析</p>\n<ul>\n<li>.&#x2F;vs2-pass2&#x2F;</li>\n<li>inal-viral-combined.fa</li>\n<li>final-viral-score.tsv</li>\n<li>for-dramv&#x2F;final-viral-combined-for-dramv.fa</li>\n<li>for-dramv&#x2F;viral-affi-contigs-for-dramv.tab<br>  +++</li>\n</ul>\n</li>\n<li><p>运行DRAMv</p>\n<p>+++info 命令解析<br>使用DRAMv注释鉴定的病毒序列，以用于后续<ruby>人工整理<rt>manual curation</rt></ruby>。可通过”--threads”控制调用的CPU核心数。<br>+++</p>\n<p>:::default<br>  Time: 8.81h<br>  :::</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># step 1 annotate 耗时步骤，建议投后台运行</span></span><br><span class=\"line\">DRAM-v.py annotate -i vs2-pass2/for-dramv/final-viral-combined-for-dramv.fa -v vs2-pass2/for-dramv/viral-affi-contigs-for-dramv.tab -o dramv-annotate --skip_trnascan --threads 50 --min_contig_size 1000</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#step 2 summarize anntotations</span></span><br><span class=\"line\">DRAM-v.py distill -i dramv-annotate/annotations.tsv -o dramv-distill</span><br></pre></td></tr></table></figure>\n\n<p>  +++success 结果解析</p>\n<ul>\n<li>dramv-annotate&#x2F;annotations.tsv</li>\n<li>dramv-annotate&#x2F;genbank 各条contig的gbk文件</li>\n<li>dramv-annotate&#x2F;genes.faa</li>\n<li>dramv-annotate&#x2F;genes.fna</li>\n<li>dramv-annotate&#x2F;genes.gff</li>\n<li>dramv-annotate&#x2F;rrnas.tsv</li>\n<li>dramv-annotate&#x2F;scaffolds.fna</li>\n<li>dramv-annotate&#x2F;vMAGs 各条contig的fasta文件<br>  +++</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"过滤\"><a href=\"#过滤\" class=\"headerlink\" title=\"过滤\"></a>过滤</h1><h2 id=\"依据病毒和宿主基因数、分数、hallmark基因数以及contig长度进行筛选\"><a href=\"#依据病毒和宿主基因数、分数、hallmark基因数以及contig长度进行筛选\" class=\"headerlink\" title=\"依据病毒和宿主基因数、分数、hallmark基因数以及contig长度进行筛选\"></a>依据病毒和宿主基因数、分数、hallmark基因数以及contig长度进行筛选</h2><p>来自checkV的病毒和宿主基因计数可用于假阳性筛查。由于checkV在预测病毒基因方面非常保守，那些由checkV预测的病毒基因的序列应该是病毒的，而那些没有被checkV预测到病毒基因的序列更可能是非病毒的。</p>\n<p>基于我们对土壤宏基因组的基准测试，(1) 那些没有预测到病毒和宿主基因的序列是病毒；(2) 没有病毒基因但有2个或2个以上宿主基因的大多数为非病毒基因；(3) 那些没有病毒基因和具有1个宿主基因的很难区分其为病毒还是非病毒（可能是可移动的基因元件，类似于VirSorter1中的第3类），除非手动检查，否则应该丢弃。</p>\n<p>只选择那些大于10kb的用于手动检查，因为太短的无法分辨。还有那些VirSorter2 得分≥0.95或hallmark基因计数&gt;2的大多数是病毒。&#x3D;&#x3D;这些经验筛选标准总结如下：&#x3D;&#x3D;</p>\n<p>:::success<br>Keep1: viral_gene &gt;0<br>:::<br>:::success<br>Keep2: viral_gene &#x3D;0 AND (host_gene &#x3D;0 OR score &gt;&#x3D;0.95 OR hallmark &gt;2)<br>:::<br>:::warning<br>Manual check: (NOT in Keep1 OR Keep2) AND viral_gene &#x3D;0 AND host_gene &#x3D;1 AND length &gt;&#x3D;10kb<br>:::<br>:::danger<br>Discard: the rest<br>:::</p>\n<p>[要查看病毒基因、宿主基因、评分和<ruby>序列的特征标记<rt>hallmark of sequences</rt></ruby>，您可以合并”vs2-pass1&#x2F;final-viral-score.tsv”和”checkv&#x2F;contamination.tsv”，并在电子表格中过滤。]{.aqua}本尊为各位提供了Perl脚本<a href=\"https://github.com/liaochenlanruo/myScripts/tree/main/1551%20Virome\">cat_tsv.pl</a>以实现机动合并！直接在终端运行<code>perl cat_tsv.pl</code>即可得到合并后的文件<code>forCheck.txt</code>。</p>\n<figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/perl</span></span><br><span class=\"line\"><span class=\"keyword\">use</span> strict;</span><br><span class=\"line\"><span class=\"keyword\">use</span> warnings;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">my</span> %hash;</span><br><span class=\"line\"><span class=\"keyword\">my</span> $head_checkv;</span><br><span class=\"line\"><span class=\"keyword\">my</span> $head_pass1;</span><br><span class=\"line\"><span class=\"keyword\">my</span> $count = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">my</span> $num = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">open</span> IN, <span class=\"string\">&quot;checkv/contamination.tsv&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">chomp</span>;</span><br><span class=\"line\">\t$_ =~<span class=\"regexp\">s/[\\r\\n]+//g</span>;</span><br><span class=\"line\">\t$count++;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ($count == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t$head_checkv = $_;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">my</span> @lines = <span class=\"keyword\">split</span> <span class=\"regexp\">/\\t/</span>;</span><br><span class=\"line\">\t\t$hash&#123;$lines[<span class=\"number\">0</span>]&#125; = $_;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">close</span> IN;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">open</span> IN, <span class=\"string\">&quot;vs2-pass1/final-viral-score.tsv&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">open</span> OUT, <span class=\"string\">&quot;&gt;forCheck.txt&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">chomp</span>;</span><br><span class=\"line\">\t$_ =~<span class=\"regexp\">s/[\\r\\n]+//g</span>;</span><br><span class=\"line\">\t$num++;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ($num == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t$head_pass1 = $_;</span><br><span class=\"line\">\t\t<span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;$head_pass1\\t$head_checkv\\n&quot;</span>;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">my</span> @line = <span class=\"keyword\">split</span> <span class=\"regexp\">/\\t/</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">exists</span> $hash&#123;$line[<span class=\"number\">0</span>]&#125;) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;$_\\t$hash&#123;$line[0]&#125;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> OUT <span class=\"string\">&quot;$_\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">close</span> IN;</span><br><span class=\"line\"><span class=\"keyword\">close</span> OUT;</span><br></pre></td></tr></table></figure>\n\n<p>接下来按照上面的四条规则对<code>forCheck.txt</code>进行拆分，得到病毒<code>Virus.txt</code>、手动核对<code>Manual_check.txt</code>及抛弃的<code>Discard.txt</code>。可以自己看，也可以用<code>get_virus.pl</code>来完成。</p>\n<figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/perl</span></span><br><span class=\"line\"><span class=\"keyword\">use</span> strict;</span><br><span class=\"line\"><span class=\"keyword\">use</span> warnings;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">my</span> $count = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">open</span> IN, <span class=\"string\">&quot;forCheck.txt&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">open</span> VIRUS, <span class=\"string\">&quot;&gt;Virus.txt&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">open</span> MANUAL, <span class=\"string\">&quot;&gt;Manual_check.txt&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">open</span> DISCARD, <span class=\"string\">&quot;&gt;Discard.txt&quot;</span> || <span class=\"keyword\">die</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">chomp</span>;</span><br><span class=\"line\">\t$_ =~<span class=\"regexp\">s/[\\r\\n]+//g</span>;</span><br><span class=\"line\">\t$count++;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ($count == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">print</span> VIRUS $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">print</span> MANUAL $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">print</span> DISCARD $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">my</span> @lines = <span class=\"keyword\">split</span> <span class=\"regexp\">/\\t/</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> ($lines[<span class=\"number\">15</span>] &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\"># virus keep1</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> VIRUS $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">elsif</span> (($lines[<span class=\"number\">15</span>] == <span class=\"number\">0</span>) &amp;&amp; ($lines[<span class=\"number\">16</span>] == <span class=\"number\">0</span>)) &#123; <span class=\"comment\"># virus keep2</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> VIRUS $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">elsif</span> (($lines[<span class=\"number\">15</span>] == <span class=\"number\">0</span>) &amp;&amp; ($lines[<span class=\"number\">6</span>] &gt;= <span class=\"number\">0</span>.<span class=\"number\">95</span>)) &#123; <span class=\"comment\"># virus keep2</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> VIRUS $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">elsif</span> (($lines[<span class=\"number\">15</span>] == <span class=\"number\">0</span>) &amp;&amp; ($lines[<span class=\"number\">9</span>] &gt; <span class=\"number\">2</span>)) &#123; <span class=\"comment\"># virus keep2</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> VIRUS $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">elsif</span> (($lines[<span class=\"number\">15</span>] == <span class=\"number\">0</span>) &amp;&amp; ($lines[<span class=\"number\">16</span>] == <span class=\"number\">1</span>) &amp;&amp; ($lines[<span class=\"number\">8</span>] &gt;= <span class=\"number\">10000</span>)) &#123; <span class=\"comment\"># manual check</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> MANUAL $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123; <span class=\"comment\"># discard</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">print</span> DISCARD $_ . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">close</span> IN;</span><br><span class=\"line\"><span class=\"keyword\">close</span> VIRUS;</span><br><span class=\"line\"><span class=\"keyword\">close</span> MANUAL;</span><br><span class=\"line\"><span class=\"keyword\">close</span> DISCARD;</span><br></pre></td></tr></table></figure>\n\n<p>用法：脚本与<code>forCheck.txt</code>放在同一目录，终端运行如下命令。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl get_virus.pl</span><br></pre></td></tr></table></figure>\n\n<p>对于<code>Manual_check.txt</code>中的序列，需要用眼睛和脑袋去<code>dramv-annotate/annotations.tsv</code>中找注释信息，然后根据下面的方法判断其属于病毒还是细胞，如果是病毒，就将其所在的那行信息复制到<code>Virus.txt</code>文件的末尾，并保存。</p>\n<h2 id=\"依据DRAMv注释筛选\"><a href=\"#依据DRAMv注释筛选\" class=\"headerlink\" title=\"依据DRAMv注释筛选\"></a>依据DRAMv注释筛选</h2><p>在病毒和宿主中都有一些共同的基因(如{脂多糖^LPS}相关)和移动元件，这些基因可能导致上述“Keep2”类别中的假阳性。因此，++要谨慎对待带有这些基因的contigs++{.dot}。专家们已经编制了一份与此相关的[“可疑”]{.red}基因列表。我们可以使用“Keep2”类别中的contigs对DRAMv表取子集，并在DRAMv子集表中筛选“可疑”基因(忽略大小写，例如在“grep”中使用“-i”选项)，然后将带有这些基因的contigs放入“手动检查”类别中。</p>\n<h2 id=\"手动检查-tabset\"><a href=\"#手动检查-tabset\" class=\"headerlink\" title=\"手动检查{.tabset}\"></a>手动检查{.tabset}</h2><p>对于存在于<ruby>“手动检查”<rt>manual check</rt></ruby>类别中的序列，可以观察其在”dramv-annotate&#x2F;annotations.tsv”中的注释信息。本步骤很难标准化，下面是一些经验之谈：</p>\n<div class=\"tabs\" id=\"tab-id\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a class=\"#tab-id-1\">判定contig为病毒的标准</a></li><li class=\"tab\"><a class=\"#tab-id-2\">判定contig为非病毒的标准</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"tab-id-1\"><p>;;;id1  判定contig为病毒的标准</p>\n<ul>\n<li>结构基因、hallmark基因、<ruby>注释缺失或假设性富集<rt>depletion in annotations or enrichment for hypotheticals</rt> (~10%的基因具有non-hypothetical注释)。</li>\n<li>缺乏hallmarks，但&gt;&#x3D;50%已注释的基因为病毒，且其中至少一半以上的viral bitcore &gt;100，且contig的长度&lt;50kb。</li>\n<li>Provirus: <ruby>整合酶&#x2F;重组酶&#x2F;切除酶&#x2F;阻遏子<rt>Integrase&#x2F;recombinase&#x2F;excisionase&#x2F;repressor</rt></ruby>，在一侧富集了病毒基因。</li>\n<li>Provirus: 基因组中存在“break”：两个基因之间的<ruby>间隙<rt>gap</rt></ruby>对应于一个<ruby>链开关<rt>strand switch</rt></ruby>，更高的编码密度，注释缺失，以及在一侧噬菌体基因的富集。</li>\n<li><ruby>仅有~1-3个基因有注释，但至少一半命中病毒，且命中基因的bitscore不超过病毒bitscore的150% ，<rt>Few annotations only ~1-3 genes, but with at least half hitting to viruses, and where the genes hitting cells have a bitscore no more than 150% that of the viral bitscores</rt></ruby> <ruby>且&#x2F;或病毒的bitscore &gt;100 <rt> and&#x2F;or viral bitscores are &gt;100</rt></ruby>。</li>\n<li>LPS (脂多糖) <ruby>外观区域对病毒基因的命中率也非常高<rt>looking regions if also has very strong hits to viral genes</rt></ruby>，bitscore&gt;100。<br>;;;</li>\n</ul></div><div class=\"tab-pane\" id=\"tab-id-2\"><p>;;;id1 判定contig为非病毒的标准</p>\n<ul>\n<li><ruby>细胞样基因<rt>cellular like genes</rt></ruby>是病毒基因的3倍，几乎所有基因都有注释，没有基因只命中病毒，也没有病毒<ruby>标志基因<rt>hallmark genes</rt></ruby>。</li>\n<li>缺乏任何病毒hallmark genes，且长度 &gt;50kb。</li>\n<li>许多明显的细胞基因字符串，没有其他病毒标志基因。 在基准测试中遇到的例子包括 1) CRISPR Cas, 2) ABC transporters, 3) Sporulation proteins, 4) Two-component systems, 5) Secretion system。这其中一些可能是由病毒编码的，但在没有进一步证据的情况下并不表明是病毒contig。</li>\n<li>多个质粒基因或转座酶，但没有明确的只命中病毒的基因。</li>\n<li>注释信息很少，仅有~1-3个基因同时命中了病毒和细胞基因，但有stronger bitscores支持其为细胞基因。</li>\n<li><ruby>没有强有力的命中病毒的脂多糖样区域<rt>LPS looking regions if no strong viral hits</rt></ruby>。富含通常与脂多糖相关的基因，如{外聚酶^epimerases}、{糖基转移酶^glycosyl transferases}、{酰基转移酶^acyltransferase}、{短链脱氢酶&#x2F;还原酶^dehydrogenase&#x2F;reductase short-chain}、{脱水酶^dehydratase}。</li>\n<li>注释为 Type IV 和&#x2F;或 Type VI 分析系统，并被非病毒基因围绕。</li>\n<li>注释信息很少，仅有~1-3个基因全部命中细胞基因 (即使 bitscore &lt;100) ，且没有命中病毒的基因。<br>;;;</li>\n</ul></div></div></div>\n\n<p>:::warning<br>最后，用户要注意，VirSorter 2和&#x2F;或checkV预测的任何原病毒边界只是一个近似的估计(寻找“ends”在前噬菌体发现中是一个相当具有挑战性的问题)，也需要仔细地手工检查，特别是在AMG研究中。<br>:::</p>\n<p>最终我们需要拿到病毒contig的序列，用<code>get_virus_seqs.pl</code>完成。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/usr/bin/perl</span></span><br><span class=\"line\">use strict;</span><br><span class=\"line\">use warnings;</span><br><span class=\"line\"></span><br><span class=\"line\">my %<span class=\"built_in\">hash</span>;</span><br><span class=\"line\">open IN, <span class=\"string\">&quot;checkv/combined.fna&quot;</span> || die;</span><br><span class=\"line\"><span class=\"built_in\">local</span> $/ = <span class=\"string\">&quot;&gt;&quot;</span>;</span><br><span class=\"line\">&lt;IN&gt;;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\tchomp;</span><br><span class=\"line\">\tmy (<span class=\"variable\">$header</span>, <span class=\"variable\">$seq</span>) = <span class=\"built_in\">split</span>(/\\n/, <span class=\"variable\">$_</span>, 2);</span><br><span class=\"line\">\tmy <span class=\"variable\">$id</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"variable\">$header</span> =~/(\\S+)\\|\\|.+/) &#123;</span><br><span class=\"line\">\t\t<span class=\"variable\">$id</span> = <span class=\"variable\">$1</span>;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"variable\">$id</span> = <span class=\"variable\">$header</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"variable\">$hash</span>&#123;<span class=\"variable\">$id</span>&#125; = <span class=\"variable\">$seq</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">close IN;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">local</span> $/ = <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">open IN, <span class=\"string\">&quot;Virus.txt&quot;</span> || die;</span><br><span class=\"line\">open OUT, <span class=\"string\">&quot;&gt;Virus.fas&quot;</span> || die;</span><br><span class=\"line\">open NO, <span class=\"string\">&quot;&gt;NoSeqs.ids&quot;</span> || die;</span><br><span class=\"line\">&lt;IN&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> (&lt;IN&gt;) &#123;</span><br><span class=\"line\">\tchomp;</span><br><span class=\"line\">\tmy @lines = <span class=\"built_in\">split</span> /\\t/;</span><br><span class=\"line\">\t<span class=\"variable\">$lines</span>[0] =~/(\\S+)\\|\\|/;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (exists <span class=\"variable\">$hash</span>&#123;<span class=\"variable\">$1</span>&#125;) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">print</span> OUT <span class=\"string\">&quot;&gt;<span class=\"variable\">$lines</span>[0]\\n<span class=\"variable\">$hash</span>&#123;<span class=\"variable\">$1</span>&#125;\\n&quot;</span>;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">print</span> NO <span class=\"string\">&quot;<span class=\"variable\">$lines</span>[0]\\n&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">close IN;</span><br><span class=\"line\">close OUT;</span><br><span class=\"line\">close NO;</span><br></pre></td></tr></table></figure>\n\n<p>用法：终端运行如下命令即可得到序列文件<code>Virus.fas</code>。</p>\n<figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl get_virus_seqs.pl</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"脚本获取\"><a href=\"#脚本获取\" class=\"headerlink\" title=\"脚本获取\"></a>脚本获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“1551”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://github.com/jiarong/VirSorter2\">VirSorter2</a></li>\n<li><a href=\"https://www.protocols.io/view/viral-sequence-identification-sop-with-virsorter2-bwm5pc86\">Viral sequence identification SOP with VirSorter2 V.3</a></li>\n</ul>\n<div class=\"mermaid\">graph TD\n\tA [Reads] --&gt; B((MetaSpaDES))\n\tB --&gt; C [Contigs]\n\tC --&gt; D ((VirSorter))\n\tC --&gt; E ((VirFinder))\n\tE --&gt; F {Score &gt;&#x3D; 0.7 &amp; p &lt; 0.05}\n\tF -- YES --&gt; G [Virus]\n\tF -- NO --&gt; H [Contigs]\n\tD --&gt; G\n\tH --&gt; I ((CAT))\n\tI --&gt; J {&lt; 40%}\n\tJ -- YES --&gt; G\n\tJ -- NO --&gt; K [Not Virus]\n\tG --&gt; L ((Nucmer))\n\tL --&gt; M {Identity &gt;&#x3D; 95% &amp; Coverage &gt;&#x3D; 80%}\n\tM -- YES --&gt; N [Grouped]\n\tM -- NO --&gt; O [Not Grouped]\n\tG --&gt; P ((Prodigal))\n\tP --&gt; Q [Amino Acid Sequences]\n\tQ --&gt; R {Length &lt; 10 kb}\n\tR -- YES --&gt; S ((Blastp))\n\tR -- NO --&gt; T ((vConTACT2))\n\tS --&gt; U [Annotated Genes]\n\tT --&gt; U</div>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"ST179","path":"api/tags/ST179.json"},{"name":"宏病毒组","path":"api/tags/宏病毒组.json"}]},{"title":"Linux中使用tar将大文件压缩为多个小的压缩包","slug":"Linux中使用tar将大文件压缩为多个小的压缩包","date":"2021-11-26T14:35:35.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/Linux中使用tar将大文件压缩为多个小的压缩包.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>在GitHub上传文件时，单个文件不允许超过100m，超过的话需要使用Git Large File Storage，操作起来稍有些复杂，而且我记得也有限制。在这里我们可以将大文件压缩并切片，使之被分割为多个小文件，再上传GitHub，下载之后再合并即可。</p>\n<ul>\n<li><p>压缩</p>\n<p>假设有个大文件<code>CAZy.faa</code>，原始大小为725m，压缩后为135m，因此我们可以将其压缩为2~3个文件 即可避免100m的限制。建议上传至GitHub的单个文件大小不要超过50m，因此我们以50m为阈值对文件进行切割（参数-b）。</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar czf - CAZy.faa | <span class=\"built_in\">split</span> -b 50m - CAZy.faa.tar.gz</span><br></pre></td></tr></table></figure>\n\n<p>运行命令后，得到了3个文件：CAZy.faa.tar.gzaa，CAZy.faa.tar.gzab，CAZy.faa.tar.gzac。</p>\n</li>\n<li><p>解压</p>\n<p>通过如下命令解压后可以得到完整的<code>CAZy.faa</code>文件。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> CAZy.faa.tar.gz* | tar -xzv</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在Windows下解压</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 先合并，再用压缩软件解压</span></span><br><span class=\"line\"><span class=\"comment\">## 按“win+r”键，在弹出的输入框中输入“cmd”进入windows下的命令提示符界面。切换路径，如进入F盘，直接输入“F:”，再进入F盘的xin文件夹输入“cd xin”，输入以下命令进行合并（注意，用的是cmd而不是powershell）：</span></span><br><span class=\"line\">copy /b CAZy.faa.tar.gza* CAZy.faa.tar.gz</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://my.oschina.net/yysue/blog/1815340\">Linux下将一个文件压缩分包成多个小文件</a></li>\n</ul>\n","raw":null,"categories":[{"name":"IT","path":"api/categories/IT.json"}],"tags":[{"name":"Github","path":"api/tags/Github.json"},{"name":"Linux","path":"api/tags/Linux.json"}]},{"title":"R语言绘制分组条形图","slug":"R语言绘制分组条形图","date":"2021-11-26T06:37:02.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/R语言绘制分组条形图.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg","content":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a href=\"#输入文件样式\" class=\"headerlink\" title=\"输入文件样式\"></a>输入文件样式</h1><p>本例中数据内容如下图所示，将其保存在名为<code>CAZy.Category.Matrix.txt</code>的文件中。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"CAZy.Category.Matrix.txt\"></p>\n<h1 id=\"绘图代码\"><a href=\"#绘图代码\" class=\"headerlink\" title=\"绘图代码\"></a>绘图代码</h1><p>在Rstudio中运行如下代码，细节可根据具体情况修改</p>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">windowsFonts<span class=\"punctuation\">(</span>Arial<span class=\"operator\">=</span>windowsFont<span class=\"punctuation\">(</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"comment\">#加载Windows字体</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span> <span class=\"comment\">#设定工作目录</span></span><br><span class=\"line\">cazy <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;CAZy.Category.Matrix.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">cazy_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>cazy<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>cazy_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Cazy&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">ggplot<span class=\"punctuation\">(</span>cazy_melt<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">     geom_bar<span class=\"punctuation\">(</span>stat <span class=\"operator\">=</span> <span class=\"string\">&#x27;identity&#x27;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span></span><br><span class=\"line\">              aes<span class=\"punctuation\">(</span>fill <span class=\"operator\">=</span> Cazy<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">              position <span class=\"operator\">=</span> position_dodge<span class=\"punctuation\">(</span><span class=\"number\">0.9</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span><span class=\"comment\">#使柱子并排放置</span></span><br><span class=\"line\">     theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> </span><br><span class=\"line\">     theme<span class=\"punctuation\">(</span>text<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>family<span class=\"operator\">=</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">12</span><span class=\"punctuation\">,</span>face <span class=\"operator\">=</span> <span class=\"string\">&quot;plain&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"comment\">#设置文字的字体字号</span></span><br><span class=\"line\">           axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\"># 设置X轴文字大小</span></span><br><span class=\"line\">      scale_fill_manual<span class=\"punctuation\">(</span>values<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span>  <span class=\"comment\"># 设置填充颜色</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"分组条形图\"></p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R语言ggplot2分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar()函数绘制条形图</a></li>\n</ul>\n","raw":null,"categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"SY179","path":"api/tags/SY179.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]},{"title":"利用NCycDB数据库从宏基因组中预测氮循环基因","slug":"利用NCycDB数据库从宏基因组中预测氮循环基因","date":"2021-11-25T03:19:20.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/利用NCycDB数据库从宏基因组中预测氮循环基因.json","excerpt":null,"keywords":null,"cover":"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","content":"<p>氮（N）循环是地球生态系统中重要的生物地球化学途径的集合，在生态学和环境研究中得到了广泛的关注。目前，<ruby>鸟枪法宏基因组测序<rt>Shotgun metagenome sequencing</rt></ruby>已被广泛应用于探索负责 N 循环过程的基因家族。NCycDB是一个手动管理的综合数据库，用于从鸟枪法宏基因组测序数据中快速准确地分析 N 循环基因（亚）家族。 NCycDB 总共包含 68 个基因（亚）家族，涵盖 8 个 N 循环过程，分别具有 95% 和 100% 一致性阈值的 84 759 和 219 146 个代表性序列。数据库中还包含了1958 个<ruby>同源直系同源组<rt>Homologous orthology groups</rt></ruby>的序列，以避免由于“小数据库”问题导致的假阳性分配。</p>\n<h1 id=\"数据库及脚本\"><a href=\"#数据库及脚本\" class=\"headerlink\" title=\"数据库及脚本\"></a>数据库及脚本</h1><h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><ul>\n<li><p>通过Git</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/liaochenlanruo/NCyc.git</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>通过wget</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/liaochenlanruo/NCyc/archive/refs/heads/master.zip</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><ul>\n<li>通过<code>Git</code>下载的不需要解压，通过<code>Wget</code>下载的需要先解压。</li>\n<li>修改<code>NCycProfilter.PL</code>文件的第8-13行中4个依赖软件的安装路径。</li>\n<li>将<code>data</code>目录下的<code>NCyc_100_2019Jul.7z</code>解压，将解压得到的<code>NCyc_100_2019Jul</code>重命名为<code>NCyc_100.faa</code>并移动至<code>data</code>目录下。</li>\n</ul>\n<h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><ul>\n<li>Blast</li>\n<li>diamond</li>\n<li>usearch</li>\n<li>Perl</li>\n</ul>\n<h1 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h1><ul>\n<li><p>序列文件<br>宏基因组测序得到的Reads文件、组装后的序列文件以及通过基因预测后得到的氨基酸序列文件均可。序列文件可以是压缩的，也可以是解压的。</p>\n</li>\n<li><p>基因组-序列数对应文件<br>提供一份文本文档，共包含两列，第一列为<code>样本名称</code>(即序列文件的名字，不带文件后缀名)，第二列为<code>样本包含的序列数量</code>。</p>\n</li>\n</ul>\n<h1 id=\"预测\"><a href=\"#预测\" class=\"headerlink\" title=\"预测\"></a>预测</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl NCycProfiler.PL -d ./ -m diamond -f faa -s prot -si SI.txt -o Ncycle.out.txt</span><br></pre></td></tr></table></figure>\n<p>:::info<br>参数解析：<br>:::</p>\n<p>-d 指定工作目录，即序列文件所在目录。<br>-m 指定用哪个软件进行序列比对，可选<code>diamond</code>，<code>blast</code>，<code>usearch</code>。<br>-f 指定序列文件的后缀名，不需要带<code>.</code>。<br>-s 指定序列类型，氨基酸为<code>prot</code>，核苷酸为<code>nucl</code>。<br>-si 基因组-序列数对应文件<br>-rs 随机取样大小，如果不指定，将取包含序列最少的样本的序列数<br>-o 指定输出的文件名称</p>\n<h1 id=\"结果解析\"><a href=\"#结果解析\" class=\"headerlink\" title=\"结果解析\"></a>结果解析</h1><p>得到的结果文件是一个表格，第一行为随机取样大小。第一列为参与N循环的基因名，其他列为各样本含有的对应基因的数量。</p>\n<h1 id=\"可视化\"><a href=\"#可视化\" class=\"headerlink\" title=\"可视化\"></a>可视化</h1><p>可参考本站另一篇文章<a href=\"https://www.liaochenlanruo.fun/post/b68c.html\">R语言绘制气泡图Bubb_Plot</a>进行数据可视化。</p>\n<ul>\n<li>不带分组</li>\n</ul>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;Ncycle.out.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>data<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Genes&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span>as.data.frame<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 做主图</span></span><br><span class=\"line\">bubble <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">[</span>which<span class=\"punctuation\">(</span>data_melt<span class=\"operator\">$</span>Abundances<span class=\"operator\">&gt;</span><span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> Genes<span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">,</span> color <span class=\"operator\">=</span> Samples<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> geom_point<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 修改细节 — 图注，点大小，点shape</span></span><br><span class=\"line\">bubble_style <span class=\"operator\">&lt;-</span> bubble <span class=\"operator\">+</span> theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    labs<span class=\"punctuation\">(</span></span><br><span class=\"line\">        x <span class=\"operator\">=</span> <span class=\"string\">&quot;Sediment layers&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        y <span class=\"operator\">=</span> <span class=\"string\">&quot;N cycling genes&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        color<span class=\"operator\">=</span><span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\"># 颜色图注名</span></span><br><span class=\"line\">        size<span class=\"operator\">=</span><span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>    <span class=\"comment\"># 大小图注名</span></span><br><span class=\"line\">    scale_size<span class=\"punctuation\">(</span><span class=\"built_in\">range</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">0.1</span><span class=\"punctuation\">,</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0.1</span><span class=\"punctuation\">,</span> <span class=\"number\">0.6</span><span class=\"punctuation\">,</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span>  <span class=\"comment\">#等比修改圆圈大小</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>plot.title<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>family<span class=\"operator\">=</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                                  color<span class=\"operator\">=</span><span class=\"string\">&quot;red&quot;</span><span class=\"punctuation\">,</span>face<span class=\"operator\">=</span><span class=\"string\">&quot;italic&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                                  hjust<span class=\"operator\">=</span><span class=\"number\">0.5</span><span class=\"punctuation\">,</span>lineheight<span class=\"operator\">=</span><span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          plot.subtitle <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> </span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">bubble_style</span><br></pre></td></tr></table></figure>\n\n<p>依据下表获得基因的<code>Pathways</code>和<code>Annotation</code>，随后依据<code>Pathways</code>进行分组并绘图。</p>\n<table>\n<thead>\n<tr>\n<th>Pathways</th>\n<th>Gene (sub) families</th>\n<th>Annotation</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Nitrification</td>\n<td>amoA_A</td>\n<td>Ammonia monooxygenase subunit A (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoB_A</td>\n<td>Ammonia monooxygenase subunit B (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoC_A</td>\n<td>Ammonia monooxygenase subunit C (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoA_B</td>\n<td>Ammonia monooxygenase subunit A (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoB_B</td>\n<td>Ammonia monooxygenase subunit B (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoC_B</td>\n<td>Ammonia monooxygenase subunit C (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hao</td>\n<td>Hydroxylamine dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nxrA</td>\n<td>Nitrite oxidoreductase, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nxrB</td>\n<td>Nitrite oxidoreductase, beta subunit</td>\n</tr>\n<tr>\n<td>Denitrification</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirK</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirS</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>norB</td>\n<td>Nitric oxide reductase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>norC</td>\n<td>Nitric oxide reductase subunit C</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nosZ</td>\n<td>Nitrous-oxide reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>Assimilatory nitrate reduction</td>\n<td>nasA</td>\n<td>Assimilatory nitrate reductase catalytic subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nasB</td>\n<td>Assimilatory nitrate reductase electron transfer subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirA</td>\n<td>Ferredoxin-nitrite reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>NR</td>\n<td>Nitrate reductase (NAD(P)H)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narB</td>\n<td>Assimilatory nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narC</td>\n<td>Cytochrome b-561</td>\n</tr>\n<tr>\n<td>Dissimilatory nitrate reduction</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirB</td>\n<td>Nitrite reductase (NADH) large subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirD</td>\n<td>Nitrite reductase (NADH) small subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfA</td>\n<td>Nitrite reductase (cytochrome c-552)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfB</td>\n<td>Cytochrome c-type protein NrfB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfC</td>\n<td>Protein NrfC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfD</td>\n<td>Protein NrfD</td>\n</tr>\n<tr>\n<td>Nitrogen fixation</td>\n<td>anfG</td>\n<td>Nitrogenase delta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifD</td>\n<td>Nitrogenase molybdenum-iron protein alpha chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifH</td>\n<td>Nitrogenase iron protein NifH</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifK</td>\n<td>Nitrogenase molybdenum-iron protein beta chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifW</td>\n<td>Nitrogenase-stabilizing&#x2F;protective protein</td>\n</tr>\n<tr>\n<td>Anammox</td>\n<td>hzo</td>\n<td>Hydrazine oxidoreductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsA</td>\n<td>Hydrazine synthase subunit A</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsB</td>\n<td>Hydrazine synthase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsC</td>\n<td>Hydrazine synthase subunit C</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hdh</td>\n<td>Hydrazine dehydrogenase</td>\n</tr>\n<tr>\n<td>Organic degradation and synthesis</td>\n<td>ureA</td>\n<td>Urease subunit gamma</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ureB</td>\n<td>Urease subunit beta</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ureC</td>\n<td>Urease subunit alpha</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nao</td>\n<td>Nitroalkane oxidase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nmo</td>\n<td>Nitronate monooxygenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00260</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00261</td>\n<td>Glutamate dehydrogenase (NAD(P)+)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00262</td>\n<td>Glutamate dehydrogenase (NADP+)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K15371</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00264</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00265</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH) large chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00266</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH) small chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00284</td>\n<td>Glutamate synthase (ferredoxin)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>glsA</td>\n<td>Glutaminase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>glnA</td>\n<td>Glutamine synthetase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>asnB</td>\n<td>Asparagine synthase (glutamine-hydrolysing)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ansB</td>\n<td>Glutamin-(asparagin-)ase</td>\n</tr>\n<tr>\n<td>Others</td>\n<td>hcp</td>\n<td>Hydroxylamine reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoA</td>\n<td>Particulate methane monooxygenase subunit A</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoB</td>\n<td>Particulate methane monooxygenase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoC</td>\n<td>Particulate methane monooxygenase subunit C</td>\n</tr>\n</tbody></table>\n<ul>\n<li>带分组</li>\n</ul>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">data <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;Ncycle.out.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>data<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Genes&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Annotation&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Pathways&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span>as.data.frame<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span></span><br><span class=\"line\">bubble <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">[</span>which<span class=\"punctuation\">(</span>data_melt<span class=\"operator\">$</span>Abundances<span class=\"operator\">&gt;</span><span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> Genes<span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">,</span> color <span class=\"operator\">=</span> Samples<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme_bw<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> <span class=\"string\">&quot;Sediment layers&quot;</span><span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"string\">&quot;N cycling genes&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> colour <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> axis.text.y <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.grid <span class=\"operator\">=</span> element_blank<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> panel.border <span class=\"operator\">=</span> element_blank<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.spacing <span class=\"operator\">=</span> unit<span class=\"punctuation\">(</span><span class=\"number\">.1</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;lines&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> </span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>plot.margin<span class=\"operator\">=</span>unit<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;cm&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> geom_point<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> facet_grid<span class=\"punctuation\">(</span>Pathways <span class=\"operator\">~</span> .<span class=\"punctuation\">,</span> drop<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> scale<span class=\"operator\">=</span><span class=\"string\">&quot;free&quot;</span><span class=\"punctuation\">,</span>space<span class=\"operator\">=</span><span class=\"string\">&quot;free&quot;</span><span class=\"punctuation\">,</span> <span class=\"built_in\">switch</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>strip.background <span class=\"operator\">=</span> element_rect<span class=\"punctuation\">(</span>fill <span class=\"operator\">=</span> <span class=\"string\">&quot;grey95&quot;</span><span class=\"punctuation\">,</span> colour <span class=\"operator\">=</span> <span class=\"string\">&quot;white&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> strip.text.y.left <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle<span class=\"operator\">=</span><span class=\"number\">360</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> strip.text<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://doi.org/10.1093/bioinformatics/bty741\">NCycDB: a curated integrative database for fast and accurate metagenomic profiling of nitrogen cycling genes</a></li>\n<li><a href=\"https://github.com/qichao1984/NCyc\">GitHub</a></li>\n</ul>\n<h1 id=\"脚本获取\"><a href=\"#脚本获取\" class=\"headerlink\" title=\"脚本获取\"></a>脚本获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“18ea”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"宏基因组","path":"api/tags/宏基因组.json"},{"name":"Functional genomics","path":"api/tags/Functional genomics.json"},{"name":"SY179","path":"api/tags/SY179.json"},{"name":"生信软件","path":"api/tags/生信软件.json"}]},{"title":"NCBI上传基因簇之tbl2asn的使用","slug":"NCBI上传基因簇之tbl2asn的使用","date":"2021-11-12T11:47:28.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/NCBI上传基因簇之tbl2asn的使用.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>向<a href=\"https://www.ncbi.nlm.nih.gov/\">NCBI</a>提交基因簇的时候需要提供sqn格式的文件，这个文件需要通过<a href=\"https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/\">tbl2asn</a>生成。</p>\n<h1 id=\"文件准备\"><a href=\"#文件准备\" class=\"headerlink\" title=\"文件准备\"></a>文件准备</h1><p>tbl2asn依赖三个文件来生成sqn文件：</p>\n<ul>\n<li>文件1：fasta格式的基因组序列文件</li>\n</ul>\n<p>Header处的中括号部分可以不写。</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Toyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster [organism=Bacillus toyonensis] [strain=XIN-YC13] [topology=linear] [moltype=DNA] [tech=wgs] [gcode=11] [country=China] Bacillus toyonensis strain XIN-YC13 Toyoncin biosynthesis gene cluster, complete sequence</span><br><span class=\"line\">ttaaaa taatttaata</span><br><span class=\"line\">gggaagtttt ttagttgttt tggactcttc ccaaacactg ctttaagtgt tggattaaca</span><br><span class=\"line\"> tcatccctat tccccgaaaa cataatgtga ggatttatga ataatgcata tgctctaaca</span><br><span class=\"line\">ttattatcat caacaccact ctctgaacga gccataatac ccttatcaat taattttcta</span><br><span class=\"line\">accaatggac taactttagt ttcatgtctt ccaatttttt tagctaattc tcgctgagtt</span><br><span class=\"line\"> aatgggattt gttctttcga attaatatca ttaactaaac aattacttaa aaaacctaca</span><br><span class=\"line\">cacattgaaa tatctactaa aaataccttc tcagcatttg ttaaataatc aatttcgaac</span><br><span class=\"line\"> aaatactgga tattttgttg aataatctga acaaacttcg ctttattttt cactttacgc</span><br><span class=\"line\"> tcaggaacta atttcattcc tcttgaacga gcttttgatt gaagtttatt tgctaaatac</span><br><span class=\"line\"> atctcttctt cagacaagac ctttaaatcc tcaatatctc tcaatcttga atttttttca</span><br><span class=\"line\"> gcttgttcta agttgataaa ctttgacata ttctttttgc tcctcttttc taagattttc</span><br><span class=\"line\"> aactagagaa ggaaaaaatt ttatgttatg attcctgtag aatttacaat tcaatatgta</span><br><span class=\"line\"> caaaagaact ccccttttct aattgatagt ttggtcgctt tcaattataa tacaagggga</span><br><span class=\"line\"> ttttttacat cttaaaattt ttcatttttg aatcaatccc tgaaaatata aagaacacat</span><br><span class=\"line\"> cacataaatt attcttaata ttttataatc gaaaaaataa taggaataaa gaaaaatact</span><br><span class=\"line\"> gcaataaata tattcatctg tttcttactc aaaccggcca ctatatttaa tcccattcct</span><br><span class=\"line\"> ataataatta attcccaaat tgaaaacact tcaaatttac tacaaattat atatagtaat</span><br><span class=\"line\"> gtacctggtt caaatattga acccaaacta gtatacgtta ctatttctcc tcctataaat</span><br><span class=\"line\"> agtgttaata atgtattaat taatttacct aaaatagaaa ttacactagc aaatattgta</span><br><span class=\"line\"> atagatacta actttttata agaaacatct ttactcatca gcatcattac aatctttaaa</span><br><span class=\"line\"> ataatccccc aaataaaagg tgtaattaaa gcaatgaaaa tcgatgcaaa acctcctaac</span><br><span class=\"line\"> atcatttggg aaacaagggg tatttccata tctgcaaata cttctttttg aattttaacc</span><br><span class=\"line\"> aattctggat tgctatgtct tgcatataca gataaaatcc ctattattgc ttgtataact</span><br><span class=\"line\"> gataaataca taagaggaaa ccatatcgga ctaattattt tcatacgctc gaattcagaa</span><br><span class=\"line\"> ataggagatg taatcataaa aattagagat ggtttttcat aattgttttt ttctttattc</span><br><span class=\"line\"> actactaaac tattatccat atattaacac cttctttttt tattcataac gtaatgcttc</span><br><span class=\"line\"> aattggatct aattttgcag ccttattggc tggaatcaat ccaaatataa taccaagcga</span><br><span class=\"line\"> catcgaaaat aatacgccac ccacaacaac ttcccatgaa acaagaggcg gccattttgc</span><br><span class=\"line\"> aaatgtggac acaatgtacg ctccacaata accaagtcca atcccaatca atccaccaag</span><br><span class=\"line\"> aagtgtcaac ataattgctt caattaaaaa ttgcaacaaa attttaccac gcgttgctcc</span><br><span class=\"line\">aagtgcttta cgtaccccaa tctcacgtgt acgctctgtt acagaaacaa gcatgatatt</span><br><span class=\"line\">cataactcca attccgccta caactaaaga aatacttgca atacctgcaa taatcattgt</span><br><span class=\"line\">cataatatta gtaactttag aaataccttt ttggatttct tctaaattta caatttcata</span><br><span class=\"line\"> tttcccttta aactcttcag attgtctatc atttaataat tttactccct tttttccagc</span><br><span class=\"line\">tgtttgtaat tgatcaaccc ctattgcttg aattgtaata gattgttgag agttatcatc</span><br><span class=\"line\"> tccatataat attggccata ttgaaagtgg tattaaaatt tctgacattc caaaaccaag</span><br><span class=\"line\"> ctcttcatct cctgaactga atagaccaat aatttgaagt ggctgacctt taatttctat</span><br><span class=\"line\"> aattttacca atgactgatt catgctcatt aggaaataac tctttcacta atgtttgatt</span><br><span class=\"line\"> aaccattatt acattattac cttgcatcaa atcatcttca ttaagagaac gacctttctc</span><br><span class=\"line\"> tattttcatt ttagtcatat taaaatattc ttttgtaata ccatttatat tagttacaac</span><br><span class=\"line\">ctttttatca tcaccaatta atgtctctgt actagagttt tgaacaatta catttttaat</span><br><span class=\"line\"> ttcttttatc ttttttaact caaaaagatc ttcttcactt acagatggtt ttttgtcatt</span><br><span class=\"line\"> catagatcct gttgttaata actcattaat atcttcttta tatgtaatcg gaatagtgtt</span><br><span class=\"line\"> attgccagaa gcggtaaatt gtgatttaag cattgcttct ccacctttac caatggctac</span><br><span class=\"line\"> aacagtaata atagaaccta caccaataat aattccaagc atcgtaagag ctgagcgcag</span><br><span class=\"line\"> tttatgagct aaaatagaag ataaggcaat ttttatacta tctaataaac tcataccata</span><br><span class=\"line\"> caccttctat cttctgtaat tttcccatct cgcaatatga tgcgacgtga agaataagct</span><br><span class=\"line\"> gctacctctt cttcatgtgt aaccataacg attgtcgtac cttctgcatt taacttcgta</span><br><span class=\"line\"> aagatatcca taacttgtgc accagacttc gtatcaagcg caccagttgg ctcatcagcc</span><br><span class=\"line\"> ataataaacg ttggattatt cgcaatcgat cttgcaatag caacacgctg cttctgtcca</span><br><span class=\"line\"> cctgacagct cactaggtaa atgatgtact ctatccgcta atccaacttt cccaagcgct</span><br><span class=\"line\"> tcgagcgctc tttgacgacg ctctgctttc ttcactccac cataaatcag tggtaattca</span><br><span class=\"line\"> acgttttcca ctgcggaaag gcgcggcaat aaattaaaat gctggaacac aaaaccgata</span><br><span class=\"line\">tattcattac gaattaaagc aagttttgac tcatctgctg ttaaaatatt cacatcattc</span><br><span class=\"line\">agcatatatt cgccttctgt tggacgatct aaacaaccga taatattcat aagagttgat</span><br><span class=\"line\">ttaccagaac cagacggtcc cataattgaa acaaattcac caccttgaat agttaaacta</span><br><span class=\"line\">ataccgtgca aaataggaac cgccattttt ccttgataat acgttttagc aatattattt</span><br><span class=\"line\">aacgtaatca tttctctttc acttccattc cgtcatatac gttgtcggaa ggatttttaa</span><br><span class=\"line\">ccaccttttg ccccactgtt gcgccctcta caatctctgt ccaatctcca tcagtagcac</span><br><span class=\"line\">cttttttcac attttgttta cgaagcttac ctttctcttc gatatataca aatgcatcat</span><br><span class=\"line\">      cgcctttttc aacaatactc ttacttggaa cagcaatcat tcttttattc tctaaattta</span><br><span class=\"line\">      cttgtaacga aacatgataa cctggagata aaccatcttg actatcaaga cttgctttat</span><br><span class=\"line\">      atgtatattg agacatattt tgagtcactt cccccatgcc atcagcttga gccatttcta</span><br><span class=\"line\">      cacttgttgg gaactcactt acctctgtaa tcttccctgt ccactttttc ttactatttg</span><br><span class=\"line\">      ctttcgcagt tacagtaaac gtttgatcct tttgaatttg cgacttctga agctcagtta</span><br><span class=\"line\">      atgttccttg aatttggaat ggatctttag aagcaacttg taaaaaggct ttcccttgac</span><br><span class=\"line\">      cacctaacgc ttgtgatgaa ctttgtgctg catctttatc taacttttga acaacaccag</span><br><span class=\"line\">      caaaattgct ataaatcgta agttcgttct gctttttatt taactcttct ttttgtaact</span><br><span class=\"line\">      tccctttctc tttctcaagg tctgttgtct tttgcgctat ttctaattca cttacttgct</span><br><span class=\"line\">      cttccatcgg atctattact tctttcccag ctccgctatc tttcgccttc ttaatttctt</span><br><span class=\"line\">      tcttcaacga atcaatcttc tttttccctt ggtcataacg catatctgcc atcttttgat</span><br><span class=\"line\">      caagcacagc ttgcttcatt tgcaaattaa tttcttcatt atcgtaagaa aacaatttcg</span><br><span class=\"line\">      ttcccttttc tatttcttgt ccttctttca cttcaatatc tttcactttt cctttagtca</span><br><span class=\"line\">      gatccgcgta gaaactttca atattccccg gcttcacttg accagaaatt aactttgtat</span><br><span class=\"line\">      tattaagatt gcgctctgtg actttttcaa aactaacagt atctattttt gttaccgctt</span><br><span class=\"line\">      tcttcttact ttgcactacg aaaatattaa taaatgtaac aataacaatt aacgcaataa</span><br><span class=\"line\">      ctccaataat agctcctttc tttttatttt taaaaataaa aagttctttt ttaatcacaa</span><br><span class=\"line\">      caatcttctc cttattcata tctaaaattt aaacttttaa attttacata aaaatttaaa</span><br><span class=\"line\">      acttctaaaa tataacatgt ataatttacc atagatgatt tattttgtat aatataaaaa</span><br><span class=\"line\">      tatctatata aataatgcta attttcaaac aatggggtgg aagatactaa tgttagaaaa</span><br><span class=\"line\">      aaaagataga ctaacagaaa tagaggaaca aattatatac ttaatttcaa aggaattagg</span><br><span class=\"line\">      aaataaagaa atagcggaaa aattaaatta ttcacaacgt agcatcggtt acaaaataaa</span><br><span class=\"line\">      taatattttt aaaaaattaa atgttaattc aagaatcgga ctgattatag aagctgtaaa</span><br><span class=\"line\">      aaaaaatata atttaaatat aagaatgctt tcatgttaat attttataga aactaaatat</span><br><span class=\"line\">      agaggtgatt aaaatgcaaa aattttttga agctattagt gctataggta tagtaggtta</span><br><span class=\"line\">      ctttttaggt aaattcacaa gtattccttt aatagacaaa tatacattgt atttcggcgt</span><br><span class=\"line\">      aatgttgatg attggggtta ttggaagatt tattataaaa gtaattaact cagaagaaga</span><br><span class=\"line\">      gacacatgat tcaaacaaat aaaatactct aataaaaatg gaagaagatt gcacttaagt</span><br><span class=\"line\">      gcaatcttct tccattttta ttgaaaattg attaaataat gttaatattg caattgtgtg</span><br><span class=\"line\">      gtgcagatta gggtgattat gtaatagggg gaaattaaaa atgatcaata cagcttggaa</span><br><span class=\"line\">      aattattaaa gcactacaaa aatacggtac aaaagcatac aatgttatca aaaaaggcgg</span><br><span class=\"line\">      ccaagcaatg tacgacagct tcatggcagc taaagctaaa ggttggacac atgcagcttg</span><br><span class=\"line\">      gtggctagta gaacatggtt caactttagg aacattctat gatttattaa aagctgctgg</span><br><span class=\"line\">      attaatcgac taattacagc aactaaacaa ctaaacaact aaacaactta aaaatacaaa</span><br><span class=\"line\">      ttaccctaaa ctgtacccct attacatatt aactaattat tttaaaggtt ggatgataat</span><br><span class=\"line\">      atgtcaaata acatcatatc tgtaaaaaat ttaattaaaa gcttcgataa caaaatagta</span><br><span class=\"line\">      ttagataaat taaatttcga aatgaaagaa aactccactg ttgtaataat aggtaaaaac</span><br><span class=\"line\">      ggtgcaggta aaagtgtctt tctaaattgt ttacttggat ttattcatta caaccaaggt</span><br><span class=\"line\">      tcaatactaa tagatggaca acctgtagaa aatcgattac atctccgcaa gattacatcg</span><br><span class=\"line\">      ttaatttctt cagaccatca agaacatcta aatttattaa cccccaatga atatttttct</span><br><span class=\"line\">      tttttacaag atatttacca actaaaaagt aataataaag acaaaattca aaattactca</span><br><span class=\"line\">     gaagatctat atgttactaa agaactcaat actgtatttt catcactttc ttttggaaca</span><br><span class=\"line\">     aaaaagaaaa tacaattaat tggtagccta ttatattctc ctaaattatt gatttgcgac</span><br><span class=\"line\">     gaaatatttg aagggcttga tacagactca gtaaaatggg ttaaaaactt atttcaacaa</span><br><span class=\"line\">     agaaaacaag aaaatctttc tactttattt acaactcata ttactgaaca tataacagat</span><br><span class=\"line\">     ataacagaaa aaaattacat acttgaaaat ggaaaattaa ttgtgtaagt ttaaccactt</span><br><span class=\"line\">     atatttaaag ctaaaattaa ggagcttaaa atatgaattt taatatatat aagagactat</span><br><span class=\"line\">     atgataaatc aacagaagaa aaaagcaaaa caataacaaa acaaatatta tttggaatta</span><br><span class=\"line\">     taaatagttc tatattaata ggtatactac tcacatgttt ggagattttc aactttaaaa</span><br><span class=\"line\">     tttcaactgt aatgtatggt tatttcacta tatatataat actagaactt ttactattat</span><br><span class=\"line\">     tctctgcaaa tcaactatat gaaagtacag aattcataat aaaattcctt aaatatacac</span><br><span class=\"line\">     caataaccat aaataaacta tatttctcac attttctaag ttctaaatat tcattttcca</span><br><span class=\"line\">     atctttttga aataataact ctcacatcaa ttttattaat atataatgtc gatatcttat</span><br><span class=\"line\">     attcatttat tttcataatt agcttacaaa ttattagctt aataagaaca tatttagaat</span><br><span class=\"line\">     ttttactatt atattctcaa aaaaaacagg ttaaaatttt tactctaacc cattttgttt</span><br><span class=\"line\">     tcataatatc tatggttttt tatattattg ttaaaacaaa atcgatagat ttagtattct</span><br><span class=\"line\">     ttgaaaacac aaatatgtta attatatctg ttcttctcat aacattcttg atatcacttt</span><br><span class=\"line\">     taacatataa acatattata gaatacttaa tgaaaaataa tgaaattgta tataatgcta</span><br><span class=\"line\">     tttttatcaa gttaactttt aacacagcta atttaattag taaattattt aaatttaata</span><br><span class=\"line\">     catcaattgc atctttaata aaaatacata taatacgatt attacgtaat caagactata</span><br><span class=\"line\">     taagtagatt actaaaaata ggaatattac tatttatttt ttcttctata agctttctat</span><br><span class=\"line\">     ttttcgataa atcatcaaca aacaatgaaa tgagtgatat actttacttt tcatttttta</span><br><span class=\"line\">     tttccttatt tagtttttct aacatacgat tagactataa cttagtttct aaattaagct</span><br><span class=\"line\">     tagaggatta tccaataaca aaattacaat caagattaag cattgatata gcacatggaa</span><br><span class=\"line\">     ttttactatt tatactatct ttatttcttt tattaacaca atacttattg aatccaacaa</span><br><span class=\"line\">     atattctaac tctaattgat ggtttattat catttatttg tttttatttt ctaagtcttg</span><br><span class=\"line\">     gtatagaaaa agcagatatt ataataacac caaaaacaaa atggaaaatg tatccattat</span><br><span class=\"line\">     tttttgtgat gggattaata attgaagcaa tatttctatt aaaattcaaa atatggataa</span><br><span class=\"line\">     aattaataac tttattcctt tgtatactgt ggtcatattt acgtgtttat tggaaattaa</span><br><span class=\"line\">     aaaaacaata aacacaatta aaaagttccc ttcatatttt ttgaagggaa cttttatttt</span><br><span class=\"line\">     aaacaaaaat tacaaacaag caaagttatt taaaagtaaa cttttaaaat tattgaatta</span><br><span class=\"line\">     ataacaatta gtctaagata tatcagccaa atttaatttt taaacaaacc gaaaaaccct</span><br><span class=\"line\">     ttccgttttt gtttctgatt ttggctctgt atttctctaa tgttttcaag caataactga</span><br><span class=\"line\">     tctcgttttt caaatttttt ctctataaaa acctctaatt caatattttt atcttctact</span><br><span class=\"line\">     tcctttaatt ttctctccgt attagccaaa tgttcttttg tggtaactaa ttcattcgta</span><br><span class=\"line\">     atctcttgta atttttgaac aagcgtttga ttgaactgat tttgtaattg ttgattttct</span><br><span class=\"line\">     aatacttcat ccaacttctt ttctaattcc gatttttcct ctcttgaaac aaacaaatca</span><br><span class=\"line\">     agttctccat tccgccatgc tcgaacttga tcataagacc atttttgcac ctgtattttt</span><br><span class=\"line\">     tctttaattg ctatcaattc ttctatattt tcctttgagt acctacgatg ccctccctga</span><br><span class=\"line\">     cttcgctccg tttgtatatt aaattcgttt gaccatgctt ttaacaagtc aggggtaatc</span><br><span class=\"line\">     cctaaacgat ccgcaacaat tttcggtgta tacatttctg attttaattc caa</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>文件2：描述基因特征的feature table文件（.tbl）</li>\n</ul>\n<p>该文件可以用prokka对文件1进行注释而得到，但是需要自己加以修改，加上文件前几行以及gene相关的信息，各列之间用制表符分隔。</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Feature Toyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster</span><br><span class=\"line\">1\t8409\tsource</span><br><span class=\"line\">\t\t\torganism\tBacillus toyonensis</span><br><span class=\"line\">\t\t\tmol<span class=\"built_in\">_</span>type\tgenomic DNA</span><br><span class=\"line\">\t\t\tstrain\tXIN-YC13</span><br><span class=\"line\">585\t1\tgene</span><br><span class=\"line\">\t\t\tgene\torf1</span><br><span class=\"line\">585\t1\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00001</span><br><span class=\"line\">\t\t\tproduct\tMarR family transcriptional regulator</span><br><span class=\"line\">1476\t811\tgene</span><br><span class=\"line\">\t\t\tgene\torf2</span><br><span class=\"line\">1476\t811\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00002</span><br><span class=\"line\">\t\t\tproduct\tYIP1 family membrane protein</span><br><span class=\"line\">2710\t1496\tgene</span><br><span class=\"line\">\t\t\tgene\torf3</span><br><span class=\"line\">2710\t1496\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00003</span><br><span class=\"line\">\t\t\tproduct\tABC transporter permease</span><br><span class=\"line\">3387\t2707\tgene</span><br><span class=\"line\">\t\t\tgene\torf4</span><br><span class=\"line\">3387\t2707\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00004</span><br><span class=\"line\">\t\t\tproduct\tABC transporter ATP-binding protein</span><br><span class=\"line\">4595\t3384\tgene</span><br><span class=\"line\">\t\t\tgene\torf5</span><br><span class=\"line\">4595\t3384\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00005</span><br><span class=\"line\">\t\t\tproduct\tRND family efflux transporter, MFP subunit</span><br><span class=\"line\">4746\t4952\tgene</span><br><span class=\"line\">\t\t\tgene\torf6</span><br><span class=\"line\">4746\t4952\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00006</span><br><span class=\"line\">\t\t\tproduct\tHelix-turn-helix transcriptional regulator</span><br><span class=\"line\">5010\t5198\tgene</span><br><span class=\"line\">\t\t\tgene\torf7</span><br><span class=\"line\">5010\t5198\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00007</span><br><span class=\"line\">\t\t\tproduct\tPutative membrane protein</span><br><span class=\"line\">5337\t5549\tgene</span><br><span class=\"line\">\t\t\tgene\ttoyA</span><br><span class=\"line\">5337\t5549\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00008</span><br><span class=\"line\">\t\t\tproduct\tToyonsin precusor</span><br><span class=\"line\">5657\t6304\tgene</span><br><span class=\"line\">\t\t\tgene\torf9</span><br><span class=\"line\">5657\t6304\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00009</span><br><span class=\"line\">\t\t\tproduct\tABC transporter ATP-binding protein</span><br><span class=\"line\">6349\t7707\tgene</span><br><span class=\"line\">\t\t\tgene\torf10</span><br><span class=\"line\">6349\t7707\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00010</span><br><span class=\"line\">\t\t\tproduct\tPutative membrane protein</span><br><span class=\"line\">8391\t7849\tgene</span><br><span class=\"line\">\t\t\tgene\torf11</span><br><span class=\"line\">8391\t7849\tCDS</span><br><span class=\"line\">\t\t\tinference\tab initio prediction:Prodigal:002006</span><br><span class=\"line\">\t\t\tlocus<span class=\"built_in\">_</span>tag\tToyoncin<span class=\"built_in\">_</span>biosynthesis<span class=\"built_in\">_</span>gene<span class=\"built_in\">_</span>cluster<span class=\"built_in\">_</span>00011</span><br><span class=\"line\">\t\t\tproduct\tMarR family transcriptional regulator</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>文件3：描述作者信息的模板文件（.sbt）</li>\n</ul>\n<p>可以在<a href=\"https://submit.ncbi.nlm.nih.gov/genbank/template/submission/\">NCBI</a>上生成该文件。</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Submit-block ::= &#123;</span><br><span class=\"line\">  contact &#123;</span><br><span class=\"line\">    contact &#123;</span><br><span class=\"line\">      name name &#123;</span><br><span class=\"line\">        last &quot;xin&quot;,</span><br><span class=\"line\">        first &quot;bingyue&quot;,</span><br><span class=\"line\">        middle &quot;&quot;,</span><br><span class=\"line\">        initials &quot;&quot;,</span><br><span class=\"line\">        suffix &quot;&quot;,</span><br><span class=\"line\">        title &quot;&quot;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      affil std &#123;</span><br><span class=\"line\">        affil &quot;Huaibei Normal University&quot;,</span><br><span class=\"line\">        div &quot;College of Life Sciences&quot;,</span><br><span class=\"line\">        city &quot;Huaibei&quot;,</span><br><span class=\"line\">        sub &quot;Anhui&quot;,</span><br><span class=\"line\">        country &quot;China&quot;,</span><br><span class=\"line\">        street &quot;Dongshan road No.100&quot;,</span><br><span class=\"line\">        email &quot;xinbingyuex@163.com&quot;,</span><br><span class=\"line\">        postal-code &quot;235000&quot;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  cit &#123;</span><br><span class=\"line\">    authors &#123;</span><br><span class=\"line\">      names std &#123;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          name name &#123;</span><br><span class=\"line\">            last &quot;Xin&quot;,</span><br><span class=\"line\">            first &quot;Bingyue&quot;,</span><br><span class=\"line\">            middle &quot;&quot;,</span><br><span class=\"line\">            initials &quot;&quot;,</span><br><span class=\"line\">            suffix &quot;&quot;,</span><br><span class=\"line\">            title &quot;&quot;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      affil std &#123;</span><br><span class=\"line\">        affil &quot;Huaibei Normal University&quot;,</span><br><span class=\"line\">        div &quot;College of Life Sciences&quot;,</span><br><span class=\"line\">        city &quot;Huaibei&quot;,</span><br><span class=\"line\">        sub &quot;Anhui&quot;,</span><br><span class=\"line\">        country &quot;China&quot;,</span><br><span class=\"line\">        street &quot;Dongshan road No.100&quot;,</span><br><span class=\"line\">        postal-code &quot;235000&quot;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  subtype new</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Seqdesc ::= pub &#123;</span><br><span class=\"line\">  pub &#123;</span><br><span class=\"line\">    gen &#123;</span><br><span class=\"line\">      cit &quot;unpublished&quot;,</span><br><span class=\"line\">      authors &#123;</span><br><span class=\"line\">        names std &#123;</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name name &#123;</span><br><span class=\"line\">              last &quot;Xin&quot;,</span><br><span class=\"line\">              first &quot;Bingyue&quot;,</span><br><span class=\"line\">              middle &quot;&quot;,</span><br><span class=\"line\">              initials &quot;&quot;,</span><br><span class=\"line\">              suffix &quot;&quot;,</span><br><span class=\"line\">              title &quot;&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      title &quot;Purification and characterization of a novel leaderless bacteriocin, toyoncin, produced by Bacillus toyonensis XIN-YC13 that specifically active against Bacilus cereus and Listeria monocytogenes&quot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Seqdesc ::= user &#123;</span><br><span class=\"line\">  type str &quot;Submission&quot;,</span><br><span class=\"line\">  data &#123;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      label str &quot;AdditionalComment&quot;,</span><br><span class=\"line\">      data str &quot;ALT EMAIL:xinbingyuex@163.com&quot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Seqdesc ::= user &#123;</span><br><span class=\"line\">  type str &quot;Submission&quot;,</span><br><span class=\"line\">  data &#123;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      label str &quot;AdditionalComment&quot;,</span><br><span class=\"line\">      data str &quot;Submission Title:None&quot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<p><strong>注意</strong>：文件1和文件2的序列描述信息必须一致，此例中均为“Toyoncin_biosynthesis_gene_cluster”。</p>\n<h1 id=\"文件生成\"><a href=\"#文件生成\" class=\"headerlink\" title=\"文件生成\"></a>文件生成</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tbl2asn -t template.sbt -p ./ -V vb -x .fna</span><br></pre></td></tr></table></figure>\n\n<p>-t 模板文件<br>-p 输入文件所在路径<br>-V<br>  -v 生成验证文件，保存错误信息<br>  -b 生成gbf文件<br>-x 文件1（FASTA文件）的后缀名，根据实际情况填写</p>\n<p><strong>注意</strong>：如果用Prokka带的tbl2asn，生成的sqn和gbf文件中的日期通常是1-JAN-2019，需要自己手动改正为当前时间，这是因为Prokka里的tbl2asn是经过修改的。建议使用官方版的<a href=\"https://ftp.ncbi.nih.gov/toolbox/ncbi_tools/converters/by_program/tbl2asn/\">tbl2asn</a>，可避免日期错误。</p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/\">tbl2asn</a></li>\n<li><a href=\"http://www.chenlianfu.com/?p=2171\">上传基因组数据到NCBI</a></li>\n</ul>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"NCBI","path":"api/tags/NCBI.json"},{"name":"序列处理","path":"api/tags/序列处理.json"},{"name":"生信软件","path":"api/tags/生信软件.json"}]}]}