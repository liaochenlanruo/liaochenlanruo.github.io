{"title":"OrthoFinder2—同源蛋白家族聚类","slug":"OrthoFinder2—同源蛋白家族聚类","date":"2019-03-20T02:42:16.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/OrthoFinder2—同源蛋白家族聚类.json","excerpt":"寻找同源蛋白家族用的比较多的是Orthomcl，但是该软件多年前已经停止更新，且使用的时候需要安装和使用MySQL，操作起来比较繁琐。因此OrthoFinder应运而生，并且更新到版本2。后者不但可以寻找同源家族，并且可以构建基因家族进化树。","covers":["https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png"],"content":"<p>寻找同源蛋白家族用的比较多的是Orthomcl，但是该软件多年前已经停止更新，且使用的时候需要安装和使用MySQL，操作起来比较繁琐。因此OrthoFinder应运而生，并且更新到版本2。后者不但可以寻找同源家族，并且可以构建基因家族进化树。</p>\n<span id=\"more\"></span>\n<ol>\n<li>OrthoFinder及依赖包的安装</li>\n</ol>\n<ul>\n<li>下载<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/davidemms/OrthoFinder/releases/download/v2.2.7/OrthoFinder-2.2.7.tar.gz</span><br></pre></td></tr></table></figure></li>\n<li>解压<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxvf OrthoFinder-2.2.7.tar.gz</span><br></pre></td></tr></table></figure></li>\n<li>安装（加入环境变量即可）<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bashrc</span><br><span class=\"line\"></span><br><span class=\"line\">i</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HOME</span>/tools/OrthoFinder-2.2.7</span><br><span class=\"line\"></span><br><span class=\"line\">Esc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">shift</span> + ;</span><br><span class=\"line\"></span><br><span class=\"line\">wq!</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>\n依赖包</li>\n</ul>\n<p>（1）<a href=\"url:https://github.com/bbuchfink/diamond/releases\">DIAMOND</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/bbuchfink/diamond/releases/download/v0.9.24/diamond-linux64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar xzf diamond-linux64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">sudo <span class=\"built_in\">cp</span> diamond /usr/local/bin</span><br></pre></td></tr></table></figure>\n\n<p>没有root权限的可以把diamond所在目录加入环境变量。</p>\n<p>(2) <a href=\"url:https://github.com/soedinglab/MMseqs2/releases\">MMseqs2</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/soedinglab/MMseqs2/releases/download/7-4e23d/MMseqs2-Linux-AVX2.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar xzf MMseqs2-Linux-AVX2.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">sudo <span class=\"built_in\">cp</span> mmseqs2/bin/mmseqs /usr/local/bin</span><br></pre></td></tr></table></figure>\n\n<p>(3) <a href=\"url:http://micans.org/mcl/\">MCL</a></p>\n<ul>\n<li><p>Ubuntu, Debian, Linux Mint安装方法：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install mcl</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Centos, Redhat安装方法：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://micans.org/mcl/src/mcl-latest.tar.gz</span><br><span class=\"line\">tar zxvf mcl-latest.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> mcl-14-137（视具体情况而定）</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">make check</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n<p>(4) <a href=\"url:http://www.atgc-montpellier.fr/fastme/binaries.php\">FastME</a></p>\n</li>\n</ul>\n<p>下载二进制文件，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.atgc-montpellier.fr/download/sources/fastme/fastme-2.1.5.tar.gz</span><br><span class=\"line\">tar zxvf fastme-2.1.5.tar.gz</span><br><span class=\"line\">sudo <span class=\"built_in\">cp</span> fastme-2.1.5/binaries/fastme-2.1.5-linux64 /usr/local/bin/fastme</span><br></pre></td></tr></table></figure>\n<p>(5) 可选: <a href=\"url:ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/\">BLAST+</a></p>\n<ul>\n<li>Ubuntu, Debian, Linux Mint安装方法：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install ncbi-blast+</span><br></pre></td></tr></table></figure></li>\n<li>Centos, Redhat安装方法：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.8.1+-x64-linux.tar.gz</span><br><span class=\"line\">tar zxvf ncbi-blast-2.8.1+-x64-linux.tar.gz</span><br><span class=\"line\">vim ~/.bashrc</span><br><span class=\"line\">i</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HOME</span>/tools/ncbi-blast-2.8.1+/bin</span><br><span class=\"line\">Esc</span><br><span class=\"line\"><span class=\"built_in\">shift</span> + ;</span><br><span class=\"line\">wq!</span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li>\n</ul>\n<ol start=\"2\">\n<li>运行 OrthoFinder<br>(1) 运行示例数据：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> OrthoFinder-2.2.7</span><br><span class=\"line\">orthofinder -f ExampleData</span><br></pre></td></tr></table></figure>\n运行结果如下，会显示输出文件的路径，表明运行成功：</li>\n</ol>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"示例数据运行结果\"></p>\n<p>(2) 运行自己的数据：</p>\n<ul>\n<li>step1：数据准备</li>\n</ul>\n<p>下载氨基酸序列，要求为fasta格式，每个物种一个文件。将所有fasta文件存于一个目录中（如Data目录），如下图所示。文件名要简洁并有区分性，因为文件名会作为最终的物种ID。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"目录结构与文件准备\"></p>\n<ul>\n<li>step2：运行程序</li>\n</ul>\n<p>在Data目录的上一级目录打开终端，运行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -f Data -t 线程数</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>结果解读</li>\n</ol>\n<p>(1) Results Files: Orthogroups</p>\n<p>包含一个主文件“Orthogroups.csv”和两个支持文件：</p>\n<ul>\n<li><p>Orthogroups.csv，每一行为一个group，每一列为一个物种，行列交汇处为基因名称。</p>\n</li>\n<li><p>Orthogroups_UnassignedGenes.csv，包含所有未分配到任何group的基因名称。</p>\n</li>\n<li><p>Orthogroups.txt，OrthoMCL格式的输出结果，内容等同于Orthogroups.csv。</p>\n</li>\n</ul>\n<p>（2）Results Files: Orthogroup Statistics</p>\n<p>包含一些统计数据，可用于比较基因组分析、绘图以及质控。</p>\n<ul>\n<li><p>Statistics_Overall.csv和Statistics_PerSpecies.csv，提供基本的描述信息</p>\n</li>\n<li><p>Orthogroups_SpeciesOverlaps.csv，两两物种的group共享矩阵</p>\n</li>\n<li><p>Species-specific orthogroup：该group仅包含一个物种的基因。</p>\n</li>\n<li><p>G50：group中的基因数，使得50％的基因处于该大小或更大的group中。</p>\n</li>\n<li><p>O50：最小数量的group，使得50％的基因处于该大小或更大的group中。</p>\n</li>\n<li><p>Single-copy orthogroup：每个物种中只有一个基因的group（相当于单拷贝核心基因）。这些group是构建物种树和许多其他分析的理想选择。</p>\n</li>\n<li><p>Unassigned gene：未与任何其他基因划分到一个group的基因。</p>\n</li>\n</ul>\n<p>(3) Results Files: Orthologues</p>\n<p>两两物种间的直系同源基因，每一行为一个group，第一列为group编号，第二列为第一个物种的基因，第三列为第二个物种的基因。同一物种的基因名以“,”分割。直向同源物可以是一对一，一对多或多对多。</p>\n<p>(4) Results Files: Gene Trees and Species Tree</p>\n<p>每个group的基因树和定根的物种树以newick格式输出，可以用各种看树软件展示，如MEGA、iTOL、Dendroscope和FigTree等，个人推荐用iTOL。</p>\n<ol start=\"4\">\n<li>高级用法</li>\n</ol>\n<p>（1）添加新物种到之前的分析<br>（previous_orthofinder_directory指的是包含“SpeciesIDs.txt”的目录）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory</span><br></pre></td></tr></table></figure>\n<p>（2）从之前的分析中移除物种</p>\n<p>从输出目录下找到工作目录“WorkingDirectory”中的“SpeciesIDs.txt”文件，在要移除的物种那一行最前面加上一个“#”并保存，然后运行（previous_orthofinder_directory指的是包含“SpeciesIDs.txt”的目录）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -b previous_orthofinder_directory</span><br></pre></td></tr></table></figure>\n<p>（3）同时添加和删除物种</p>\n<p>编辑好“SpeciesIDs.txt”后，运行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory</span><br></pre></td></tr></table></figure>\n<p>（4）更多高级功能请阅读官方文档<br>主要包括“Inferring MSA Gene Trees”、并行计算、单独运行BLAST、使用预先计算的BLAST结果以及回归检测。</p>\n","more":"<ol>\n<li>OrthoFinder及依赖包的安装</li>\n</ol>\n<ul>\n<li>下载<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/davidemms/OrthoFinder/releases/download/v2.2.7/OrthoFinder-2.2.7.tar.gz</span><br></pre></td></tr></table></figure></li>\n<li>解压<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxvf OrthoFinder-2.2.7.tar.gz</span><br></pre></td></tr></table></figure></li>\n<li>安装（加入环境变量即可）<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bashrc</span><br><span class=\"line\"></span><br><span class=\"line\">i</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HOME</span>/tools/OrthoFinder-2.2.7</span><br><span class=\"line\"></span><br><span class=\"line\">Esc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">shift</span> + ;</span><br><span class=\"line\"></span><br><span class=\"line\">wq!</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>\n依赖包</li>\n</ul>\n<p>（1）<a href=\"url:https://github.com/bbuchfink/diamond/releases\">DIAMOND</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/bbuchfink/diamond/releases/download/v0.9.24/diamond-linux64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar xzf diamond-linux64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">sudo <span class=\"built_in\">cp</span> diamond /usr/local/bin</span><br></pre></td></tr></table></figure>\n\n<p>没有root权限的可以把diamond所在目录加入环境变量。</p>\n<p>(2) <a href=\"url:https://github.com/soedinglab/MMseqs2/releases\">MMseqs2</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/soedinglab/MMseqs2/releases/download/7-4e23d/MMseqs2-Linux-AVX2.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar xzf MMseqs2-Linux-AVX2.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">sudo <span class=\"built_in\">cp</span> mmseqs2/bin/mmseqs /usr/local/bin</span><br></pre></td></tr></table></figure>\n\n<p>(3) <a href=\"url:http://micans.org/mcl/\">MCL</a></p>\n<ul>\n<li><p>Ubuntu, Debian, Linux Mint安装方法：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install mcl</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Centos, Redhat安装方法：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://micans.org/mcl/src/mcl-latest.tar.gz</span><br><span class=\"line\">tar zxvf mcl-latest.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> mcl-14-137（视具体情况而定）</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">make check</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n<p>(4) <a href=\"url:http://www.atgc-montpellier.fr/fastme/binaries.php\">FastME</a></p>\n</li>\n</ul>\n<p>下载二进制文件，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.atgc-montpellier.fr/download/sources/fastme/fastme-2.1.5.tar.gz</span><br><span class=\"line\">tar zxvf fastme-2.1.5.tar.gz</span><br><span class=\"line\">sudo <span class=\"built_in\">cp</span> fastme-2.1.5/binaries/fastme-2.1.5-linux64 /usr/local/bin/fastme</span><br></pre></td></tr></table></figure>\n<p>(5) 可选: <a href=\"url:ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/\">BLAST+</a></p>\n<ul>\n<li>Ubuntu, Debian, Linux Mint安装方法：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install ncbi-blast+</span><br></pre></td></tr></table></figure></li>\n<li>Centos, Redhat安装方法：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.8.1+-x64-linux.tar.gz</span><br><span class=\"line\">tar zxvf ncbi-blast-2.8.1+-x64-linux.tar.gz</span><br><span class=\"line\">vim ~/.bashrc</span><br><span class=\"line\">i</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HOME</span>/tools/ncbi-blast-2.8.1+/bin</span><br><span class=\"line\">Esc</span><br><span class=\"line\"><span class=\"built_in\">shift</span> + ;</span><br><span class=\"line\">wq!</span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li>\n</ul>\n<ol start=\"2\">\n<li>运行 OrthoFinder<br>(1) 运行示例数据：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> OrthoFinder-2.2.7</span><br><span class=\"line\">orthofinder -f ExampleData</span><br></pre></td></tr></table></figure>\n运行结果如下，会显示输出文件的路径，表明运行成功：</li>\n</ol>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png\" alt=\"示例数据运行结果\"></p>\n<p>(2) 运行自己的数据：</p>\n<ul>\n<li>step1：数据准备</li>\n</ul>\n<p>下载氨基酸序列，要求为fasta格式，每个物种一个文件。将所有fasta文件存于一个目录中（如Data目录），如下图所示。文件名要简洁并有区分性，因为文件名会作为最终的物种ID。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png\" alt=\"目录结构与文件准备\"></p>\n<ul>\n<li>step2：运行程序</li>\n</ul>\n<p>在Data目录的上一级目录打开终端，运行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -f Data -t 线程数</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>结果解读</li>\n</ol>\n<p>(1) Results Files: Orthogroups</p>\n<p>包含一个主文件“Orthogroups.csv”和两个支持文件：</p>\n<ul>\n<li><p>Orthogroups.csv，每一行为一个group，每一列为一个物种，行列交汇处为基因名称。</p>\n</li>\n<li><p>Orthogroups_UnassignedGenes.csv，包含所有未分配到任何group的基因名称。</p>\n</li>\n<li><p>Orthogroups.txt，OrthoMCL格式的输出结果，内容等同于Orthogroups.csv。</p>\n</li>\n</ul>\n<p>（2）Results Files: Orthogroup Statistics</p>\n<p>包含一些统计数据，可用于比较基因组分析、绘图以及质控。</p>\n<ul>\n<li><p>Statistics_Overall.csv和Statistics_PerSpecies.csv，提供基本的描述信息</p>\n</li>\n<li><p>Orthogroups_SpeciesOverlaps.csv，两两物种的group共享矩阵</p>\n</li>\n<li><p>Species-specific orthogroup：该group仅包含一个物种的基因。</p>\n</li>\n<li><p>G50：group中的基因数，使得50％的基因处于该大小或更大的group中。</p>\n</li>\n<li><p>O50：最小数量的group，使得50％的基因处于该大小或更大的group中。</p>\n</li>\n<li><p>Single-copy orthogroup：每个物种中只有一个基因的group（相当于单拷贝核心基因）。这些group是构建物种树和许多其他分析的理想选择。</p>\n</li>\n<li><p>Unassigned gene：未与任何其他基因划分到一个group的基因。</p>\n</li>\n</ul>\n<p>(3) Results Files: Orthologues</p>\n<p>两两物种间的直系同源基因，每一行为一个group，第一列为group编号，第二列为第一个物种的基因，第三列为第二个物种的基因。同一物种的基因名以“,”分割。直向同源物可以是一对一，一对多或多对多。</p>\n<p>(4) Results Files: Gene Trees and Species Tree</p>\n<p>每个group的基因树和定根的物种树以newick格式输出，可以用各种看树软件展示，如MEGA、iTOL、Dendroscope和FigTree等，个人推荐用iTOL。</p>\n<ol start=\"4\">\n<li>高级用法</li>\n</ol>\n<p>（1）添加新物种到之前的分析<br>（previous_orthofinder_directory指的是包含“SpeciesIDs.txt”的目录）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory</span><br></pre></td></tr></table></figure>\n<p>（2）从之前的分析中移除物种</p>\n<p>从输出目录下找到工作目录“WorkingDirectory”中的“SpeciesIDs.txt”文件，在要移除的物种那一行最前面加上一个“#”并保存，然后运行（previous_orthofinder_directory指的是包含“SpeciesIDs.txt”的目录）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -b previous_orthofinder_directory</span><br></pre></td></tr></table></figure>\n<p>（3）同时添加和删除物种</p>\n<p>编辑好“SpeciesIDs.txt”后，运行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory</span><br></pre></td></tr></table></figure>\n<p>（4）更多高级功能请阅读官方文档<br>主要包括“Inferring MSA Gene Trees”、并行计算、单独运行BLAST、使用预先计算的BLAST结果以及回归检测。</p>","categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"同源家族","path":"api/tags/同源家族.json"}]}