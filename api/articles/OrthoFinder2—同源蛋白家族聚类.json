{"title":"OrthoFinder2—同源蛋白家族聚类","slug":"OrthoFinder2—同源蛋白家族聚类","date":"2019-03-20T02:42:16.000Z","updated":"2022-01-08T02:16:28.408Z","comments":true,"path":"api/articles/OrthoFinder2—同源蛋白家族聚类.json","excerpt":"寻找同源蛋白家族用的比较多的是 Orthomcl，但是该软件多年前已经停止更新，且使用的时候需要安装和使用 MySQL，操作起来比较繁琐。因此 OrthoFinder 应运而生，并且更新到版本 2。后者不但可以寻找同源家族，并且可以构建基因家族进化树。","covers":["https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png","https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png"],"content":"<p>寻找同源蛋白家族用的比较多的是 Orthomcl，但是该软件多年前已经停止更新，且使用的时候需要安装和使用 MySQL，操作起来比较繁琐。因此 OrthoFinder 应运而生，并且更新到版本 2。后者不但可以寻找同源家族，并且可以构建基因家族进化树。</p>\n<span id=\"more\"></span>\n<ol>\n<li>OrthoFinder 及依赖包的安装</li>\n</ol>\n<ul>\n<li>下载</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/davidemms/OrthoFinder/releases/download/v2.2.7/OrthoFinder-2.2.7.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>解压</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">tar</span> zxvf OrthoFinder-2.2.7.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装（加入环境变量即可）</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> ~/.bashrc\n\ni\n\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token environment constant\">$HOME</span>/tools/OrthoFinder-2.2.7\n\nEsc\n\n<span class=\"token builtin class-name\">shift</span> + <span class=\"token punctuation\">;</span>\n\nwq<span class=\"token operator\">!</span>\n\n<span class=\"token builtin class-name\">source</span> ~/.bashrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>依赖包</p>\n<p>（1）<a href=\"url:https://github.com/bbuchfink/diamond/releases\">DIAMOND</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/bbuchfink/diamond/releases/download/v0.9.24/diamond-linux64.tar.gz\n\n<span class=\"token function\">tar</span> xzf diamond-linux64.tar.gz\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> diamond /usr/local/bin<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>没有 root 权限的可以把 diamond 所在目录加入环境变量。</p>\n<p>(2) <a href=\"url:https://github.com/soedinglab/MMseqs2/releases\">MMseqs2</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/soedinglab/MMseqs2/releases/download/7-4e23d/MMseqs2-Linux-AVX2.tar.gz\n\n<span class=\"token function\">tar</span> xzf MMseqs2-Linux-AVX2.tar.gz\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> mmseqs2/bin/mmseqs /usr/local/bin<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>(3) <a href=\"url:http://micans.org/mcl/\">MCL</a></p>\n<ul>\n<li>Ubuntu, Debian, Linux Mint 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mcl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>Centos, Redhat 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://micans.org/mcl/src/mcl-latest.tar.gz\n<span class=\"token function\">tar</span> zxvf mcl-latest.tar.gz\n<span class=\"token builtin class-name\">cd</span> mcl-14-137（视具体情况而定）\n./configure\n<span class=\"token function\">make</span>\n<span class=\"token function\">make</span> check\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>(4) <a href=\"url:http://www.atgc-montpellier.fr/fastme/binaries.php\">FastME</a></p>\n<p>下载二进制文件，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> http://www.atgc-montpellier.fr/download/sources/fastme/fastme-2.1.5.tar.gz\n<span class=\"token function\">tar</span> zxvf fastme-2.1.5.tar.gz\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> fastme-2.1.5/binaries/fastme-2.1.5-linux64 /usr/local/bin/fastme<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>(5) 可选: <a href=\"url:ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/\">BLAST+</a></p>\n<ul>\n<li>Ubuntu, Debian, Linux Mint 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> ncbi-blast+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>Centos, Redhat 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.8.1+-x64-linux.tar.gz\n<span class=\"token function\">tar</span> zxvf ncbi-blast-2.8.1+-x64-linux.tar.gz\n<span class=\"token function\">vim</span> ~/.bashrc\ni\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token environment constant\">$HOME</span>/tools/ncbi-blast-2.8.1+/bin\nEsc\n<span class=\"token builtin class-name\">shift</span> + <span class=\"token punctuation\">;</span>\nwq<span class=\"token operator\">!</span>\n<span class=\"token builtin class-name\">source</span> ~/.bashrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ol start=\"2\">\n<li>运行 OrthoFinder<br />\n (1) 运行示例数据：</li>\n</ol>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> OrthoFinder-2.2.7\northofinder -f ExampleData<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>运行结果如下，会显示输出文件的路径，表明运行成功：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"示例数据运行结果\" /></p>\n<p>(2) 运行自己的数据：</p>\n<ul>\n<li>step1：数据准备</li>\n</ul>\n<p>下载氨基酸序列，要求为 fasta 格式，每个物种一个文件。将所有 fasta 文件存于一个目录中（如 Data 目录），如下图所示。文件名要简洁并有区分性，因为文件名会作为最终的物种 ID。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"目录结构与文件准备\" /></p>\n<ul>\n<li>step2：运行程序</li>\n</ul>\n<p>在 Data 目录的上一级目录打开终端，运行如下命令：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -f Data -t 线程数<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ol start=\"3\">\n<li>结果解读</li>\n</ol>\n<p>(1) Results Files: Orthogroups</p>\n<p>包含一个主文件 “Orthogroups.csv” 和两个支持文件：</p>\n<ul>\n<li>\n<p>Orthogroups.csv，每一行为一个 group，每一列为一个物种，行列交汇处为基因名称。</p>\n</li>\n<li>\n<p>Orthogroups_UnassignedGenes.csv，包含所有未分配到任何 group 的基因名称。</p>\n</li>\n<li>\n<p>Orthogroups.txt，OrthoMCL 格式的输出结果，内容等同于 Orthogroups.csv。</p>\n</li>\n</ul>\n<p>（2）Results Files: Orthogroup Statistics</p>\n<p>包含一些统计数据，可用于比较基因组分析、绘图以及质控。</p>\n<ul>\n<li>\n<p>Statistics_Overall.csv 和 Statistics_PerSpecies.csv，提供基本的描述信息</p>\n</li>\n<li>\n<p>Orthogroups_SpeciesOverlaps.csv，两两物种的 group 共享矩阵</p>\n</li>\n<li>\n<p>Species-specific orthogroup：该 group 仅包含一个物种的基因。</p>\n</li>\n<li>\n<p>G50：group 中的基因数，使得 50％的基因处于该大小或更大的 group 中。</p>\n</li>\n<li>\n<p>O50：最小数量的 group，使得 50％的基因处于该大小或更大的 group 中。</p>\n</li>\n<li>\n<p>Single-copy orthogroup：每个物种中只有一个基因的 group（相当于单拷贝核心基因）。这些 group 是构建物种树和许多其他分析的理想选择。</p>\n</li>\n<li>\n<p>Unassigned gene：未与任何其他基因划分到一个 group 的基因。</p>\n</li>\n</ul>\n<p>(3) Results Files: Orthologues</p>\n<p>两两物种间的直系同源基因，每一行为一个 group，第一列为 group 编号，第二列为第一个物种的基因，第三列为第二个物种的基因。同一物种的基因名以 “,” 分割。直向同源物可以是一对一，一对多或多对多。</p>\n<p>(4) Results Files: Gene Trees and Species Tree</p>\n<p>每个 group 的基因树和定根的物种树以 newick 格式输出，可以用各种看树软件展示，如 MEGA、iTOL、Dendroscope 和 FigTree 等，个人推荐用 iTOL。</p>\n<ol start=\"4\">\n<li>高级用法</li>\n</ol>\n<p>（1）添加新物种到之前的分析<br />\n（previous_orthofinder_directory 指的是包含 “SpeciesIDs.txt” 的目录）</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>（2）从之前的分析中移除物种</p>\n<p>从输出目录下找到工作目录 “WorkingDirectory” 中的 “SpeciesIDs.txt” 文件，在要移除的物种那一行最前面加上一个 “#” 并保存，然后运行（previous_orthofinder_directory 指的是包含 “SpeciesIDs.txt” 的目录）：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -b previous_orthofinder_directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>（3）同时添加和删除物种</p>\n<p>编辑好 “SpeciesIDs.txt” 后，运行：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>（4）更多高级功能请阅读官方文档<br />\n主要包括 “Inferring MSA Gene Trees”、并行计算、单独运行 BLAST、使用预先计算的 BLAST 结果以及回归检测。</p>\n","more":"<ol>\n<li>OrthoFinder 及依赖包的安装</li>\n</ol>\n<ul>\n<li>下载</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/davidemms/OrthoFinder/releases/download/v2.2.7/OrthoFinder-2.2.7.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>解压</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">tar</span> zxvf OrthoFinder-2.2.7.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装（加入环境变量即可）</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> ~/.bashrc\n\ni\n\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token environment constant\">$HOME</span>/tools/OrthoFinder-2.2.7\n\nEsc\n\n<span class=\"token builtin class-name\">shift</span> + <span class=\"token punctuation\">;</span>\n\nwq<span class=\"token operator\">!</span>\n\n<span class=\"token builtin class-name\">source</span> ~/.bashrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>依赖包</p>\n<p>（1）<a href=\"url:https://github.com/bbuchfink/diamond/releases\">DIAMOND</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/bbuchfink/diamond/releases/download/v0.9.24/diamond-linux64.tar.gz\n\n<span class=\"token function\">tar</span> xzf diamond-linux64.tar.gz\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> diamond /usr/local/bin<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>没有 root 权限的可以把 diamond 所在目录加入环境变量。</p>\n<p>(2) <a href=\"url:https://github.com/soedinglab/MMseqs2/releases\">MMseqs2</a></p>\n<p>下载对应版本，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/soedinglab/MMseqs2/releases/download/7-4e23d/MMseqs2-Linux-AVX2.tar.gz\n\n<span class=\"token function\">tar</span> xzf MMseqs2-Linux-AVX2.tar.gz\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> mmseqs2/bin/mmseqs /usr/local/bin<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>(3) <a href=\"url:http://micans.org/mcl/\">MCL</a></p>\n<ul>\n<li>Ubuntu, Debian, Linux Mint 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mcl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>Centos, Redhat 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://micans.org/mcl/src/mcl-latest.tar.gz\n<span class=\"token function\">tar</span> zxvf mcl-latest.tar.gz\n<span class=\"token builtin class-name\">cd</span> mcl-14-137（视具体情况而定）\n./configure\n<span class=\"token function\">make</span>\n<span class=\"token function\">make</span> check\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>(4) <a href=\"url:http://www.atgc-montpellier.fr/fastme/binaries.php\">FastME</a></p>\n<p>下载二进制文件，解压并将主程序拷贝至存在于环境变量的目录下或将其所在的目录加入环境变量：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> http://www.atgc-montpellier.fr/download/sources/fastme/fastme-2.1.5.tar.gz\n<span class=\"token function\">tar</span> zxvf fastme-2.1.5.tar.gz\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> fastme-2.1.5/binaries/fastme-2.1.5-linux64 /usr/local/bin/fastme<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>(5) 可选: <a href=\"url:ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/\">BLAST+</a></p>\n<ul>\n<li>Ubuntu, Debian, Linux Mint 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> ncbi-blast+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>Centos, Redhat 安装方法：</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.8.1+-x64-linux.tar.gz\n<span class=\"token function\">tar</span> zxvf ncbi-blast-2.8.1+-x64-linux.tar.gz\n<span class=\"token function\">vim</span> ~/.bashrc\ni\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token environment constant\">$HOME</span>/tools/ncbi-blast-2.8.1+/bin\nEsc\n<span class=\"token builtin class-name\">shift</span> + <span class=\"token punctuation\">;</span>\nwq<span class=\"token operator\">!</span>\n<span class=\"token builtin class-name\">source</span> ~/.bashrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ol start=\"2\">\n<li>运行 OrthoFinder<br />\n (1) 运行示例数据：</li>\n</ol>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> OrthoFinder-2.2.7\northofinder -f ExampleData<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>运行结果如下，会显示输出文件的路径，表明运行成功：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder01.png\" alt=\"示例数据运行结果\" /></p>\n<p>(2) 运行自己的数据：</p>\n<ul>\n<li>step1：数据准备</li>\n</ul>\n<p>下载氨基酸序列，要求为 fasta 格式，每个物种一个文件。将所有 fasta 文件存于一个目录中（如 Data 目录），如下图所示。文件名要简洁并有区分性，因为文件名会作为最终的物种 ID。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/news/orthofinder02.png\" alt=\"目录结构与文件准备\" /></p>\n<ul>\n<li>step2：运行程序</li>\n</ul>\n<p>在 Data 目录的上一级目录打开终端，运行如下命令：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -f Data -t 线程数<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ol start=\"3\">\n<li>结果解读</li>\n</ol>\n<p>(1) Results Files: Orthogroups</p>\n<p>包含一个主文件 “Orthogroups.csv” 和两个支持文件：</p>\n<ul>\n<li>\n<p>Orthogroups.csv，每一行为一个 group，每一列为一个物种，行列交汇处为基因名称。</p>\n</li>\n<li>\n<p>Orthogroups_UnassignedGenes.csv，包含所有未分配到任何 group 的基因名称。</p>\n</li>\n<li>\n<p>Orthogroups.txt，OrthoMCL 格式的输出结果，内容等同于 Orthogroups.csv。</p>\n</li>\n</ul>\n<p>（2）Results Files: Orthogroup Statistics</p>\n<p>包含一些统计数据，可用于比较基因组分析、绘图以及质控。</p>\n<ul>\n<li>\n<p>Statistics_Overall.csv 和 Statistics_PerSpecies.csv，提供基本的描述信息</p>\n</li>\n<li>\n<p>Orthogroups_SpeciesOverlaps.csv，两两物种的 group 共享矩阵</p>\n</li>\n<li>\n<p>Species-specific orthogroup：该 group 仅包含一个物种的基因。</p>\n</li>\n<li>\n<p>G50：group 中的基因数，使得 50％的基因处于该大小或更大的 group 中。</p>\n</li>\n<li>\n<p>O50：最小数量的 group，使得 50％的基因处于该大小或更大的 group 中。</p>\n</li>\n<li>\n<p>Single-copy orthogroup：每个物种中只有一个基因的 group（相当于单拷贝核心基因）。这些 group 是构建物种树和许多其他分析的理想选择。</p>\n</li>\n<li>\n<p>Unassigned gene：未与任何其他基因划分到一个 group 的基因。</p>\n</li>\n</ul>\n<p>(3) Results Files: Orthologues</p>\n<p>两两物种间的直系同源基因，每一行为一个 group，第一列为 group 编号，第二列为第一个物种的基因，第三列为第二个物种的基因。同一物种的基因名以 “,” 分割。直向同源物可以是一对一，一对多或多对多。</p>\n<p>(4) Results Files: Gene Trees and Species Tree</p>\n<p>每个 group 的基因树和定根的物种树以 newick 格式输出，可以用各种看树软件展示，如 MEGA、iTOL、Dendroscope 和 FigTree 等，个人推荐用 iTOL。</p>\n<ol start=\"4\">\n<li>高级用法</li>\n</ol>\n<p>（1）添加新物种到之前的分析<br />\n（previous_orthofinder_directory 指的是包含 “SpeciesIDs.txt” 的目录）</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>（2）从之前的分析中移除物种</p>\n<p>从输出目录下找到工作目录 “WorkingDirectory” 中的 “SpeciesIDs.txt” 文件，在要移除的物种那一行最前面加上一个 “#” 并保存，然后运行（previous_orthofinder_directory 指的是包含 “SpeciesIDs.txt” 的目录）：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -b previous_orthofinder_directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>（3）同时添加和删除物种</p>\n<p>编辑好 “SpeciesIDs.txt” 后，运行：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">orthofinder -b previous_orthofinder_directory -f new_fasta_directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>（4）更多高级功能请阅读官方文档<br />\n主要包括 “Inferring MSA Gene Trees”、并行计算、单独运行 BLAST、使用预先计算的 BLAST 结果以及回归检测。</p>","categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"同源家族","path":"api/tags/同源家族.json"}]}