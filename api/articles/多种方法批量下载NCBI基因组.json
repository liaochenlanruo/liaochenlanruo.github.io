{"title":"多种方法批量下载NCBI基因组","slug":"多种方法批量下载NCBI基因组","date":"2022-07-10T02:04:23.000Z","updated":"2024-03-11T13:07:17.356Z","comments":true,"path":"api/articles/多种方法批量下载NCBI基因组.json","excerpt":null,"covers":["https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_1.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.5.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_3.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_4.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_6.jpg","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_7.jpg","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_8.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png"],"content":"<h1 id=\"下载有summary的基因组\"><a href=\"#下载有summary的基因组\" class=\"headerlink\" title=\"下载有summary的基因组\"></a>下载有summary的基因组</h1><ul>\n<li><p>在NCBI基因组数据库搜索物种</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_1.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_1.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"搜索物种\"></p>\n</li>\n<li><p>下载元数据</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"下载TSV元数据\"></p>\n</li>\n<li><p>获取下载链接<br>打开下载的元数据文件<code>prokaryotes.csv</code>（该文件也可以直接去NCBI FTP中下载，一般在各物种的目录下，名字为<code>assembly_summary.txt</code>，其格式与<code>prokaryotes.csv</code>略有不同，但都含有链接），将倒数第二列或最后一列的链接拷贝到TXT文本文档中，在每一行的最后加上要下载的文件名和数据类型：</p>\n<ul>\n<li>基因组：文件名 _genomic.fna.gz</li>\n<li>蛋白序列：文件名 _protein.faa.gz</li>\n<li>CDs序列：文件名 _cds_from_genomic.fna.gz </li>\n<li>…</li>\n</ul>\n<p>可参考下图中的示例进行命名：<br><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.5.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.5.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"NCBI文件命名示例\"></p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_3.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_3.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"获取下载链接\"></p>\n<p>建议用正则表达式替换（依赖EditPlus或其他具有正则表达式功能的文本编辑器），以基因组序列为例：</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_4.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_4.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"正则表达式批量替换获取基因组下载链接\"><br><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_5.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_5.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"替换后获得的基因组完整下载链接\"></p>\n</li>\n<li><p>开始下载<br>将获得的完整链接保存到名字为<code>link.txt</code>的文本文档中，在LINUX终端中运行<code>for link in $(cat link.txt); do wget -c $link; done</code>即可批量下载基因组到<code>genome</code>目录中。若不慎在行末引入了看不见的换行符，可以用命令<code>perl -pe &#39;s/[\\n\\r]+//g&#39; link.txt &gt; link2.txt</code>进行删除。再用<code>for link in $(cat link2.txt); do wget -c $link; done</code>下载。</p>\n</li>\n</ul>\n<h1 id=\"SRA数据下载\"><a href=\"#SRA数据下载\" class=\"headerlink\" title=\"SRA数据下载\"></a>SRA数据下载</h1><ul>\n<li><p>下载<a href=\"https://github.com/ncbi/sra-tools/wiki/01.-Downloading-SRA-Toolkit\">SRA Toolkit</a></p>\n<p>根据自己的系统选择合适的版本进行下载，并将软件包中<code>bin</code>的绝对路径或相对路径加入到环境变量中，以便可以在终端中直接调用。</p>\n</li>\n<li><p>设置默认下载目录</p>\n<p>如果不设置，默认会将基因组下载到家目录下，通过在终端里输入<code>vdb-config -i</code>命令配置下载目录，即下载到当前目录下。</p>\n<p> <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_6.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_6.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"设置SRA Toolkit默认下载文件存放位置\"></p>\n<p>  <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"设置SRA Toolkit默认下载文件存放位置\"></p>\n</li>\n<li><p>准备包含<code>SRA号</code>的列表文件，每一行含有一个编号，文件命名为<code>SRA.list</code>。</p>\n</li>\n<li><p>开始下载<br>将列表文件与脚本<code>downloadSRA.pl</code>放在同一目录下，在终端中运行<code>perl downloadSRA.pl</code>。</p>\n</li>\n</ul>\n<h1 id=\"利用FTP软件根据物种下载基因组\"><a href=\"#利用FTP软件根据物种下载基因组\" class=\"headerlink\" title=\"利用FTP软件根据物种下载基因组\"></a>利用FTP软件根据物种下载基因组</h1><p> <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_8.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_8.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"通过FileZilla批量下载基因组\"><br> <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_9.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_9.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"通过FileZilla批量下载基因组\"><br>    在右侧的列表中选中所有目录拖拽到本地即可开始下载。</p>\n<h1 id=\"根据WGA-assession-number下载基因组\"><a href=\"#根据WGA-assession-number下载基因组\" class=\"headerlink\" title=\"根据WGA assession number下载基因组\"></a>根据WGA assession number下载基因组</h1><ul>\n<li><p>安装<a href=\"https://github.com/kblin/ncbi-genome-download\">ncbi-genome-download</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install -c bioconda ncbi-genome-download</span><br></pre></td></tr></table></figure></li>\n<li><p>准备WGA assession number列表文件</p>\n</li>\n<li><p>开始下载<br>终端里输入如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ncbi-genome-download --assembly-accessions GCA.txt --output-folder 6_3 bacteria --section genbank --formats fasta</span><br></pre></td></tr></table></figure>\n<p>其中<code>GCA.txt</code>为包含assession number的列表文件，每行一个assession number。<br>该软件的问题在于，需要<code>科学上网</code>，所以很多时候会掉链子。</p>\n</li>\n</ul>\n<h1 id=\"代码获取\"><a href=\"#代码获取\" class=\"headerlink\" title=\"代码获取\"></a>代码获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“213”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","more":"<h1 id=\"下载有summary的基因组\"><a href=\"#下载有summary的基因组\" class=\"headerlink\" title=\"下载有summary的基因组\"></a>下载有summary的基因组</h1><ul>\n<li><p>在NCBI基因组数据库搜索物种</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_1.png\" alt=\"搜索物种\"></p>\n</li>\n<li><p>下载元数据</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.png\" alt=\"下载TSV元数据\"></p>\n</li>\n<li><p>获取下载链接<br>打开下载的元数据文件<code>prokaryotes.csv</code>（该文件也可以直接去NCBI FTP中下载，一般在各物种的目录下，名字为<code>assembly_summary.txt</code>，其格式与<code>prokaryotes.csv</code>略有不同，但都含有链接），将倒数第二列或最后一列的链接拷贝到TXT文本文档中，在每一行的最后加上要下载的文件名和数据类型：</p>\n<ul>\n<li>基因组：文件名 _genomic.fna.gz</li>\n<li>蛋白序列：文件名 _protein.faa.gz</li>\n<li>CDs序列：文件名 _cds_from_genomic.fna.gz </li>\n<li>…</li>\n</ul>\n<p>可参考下图中的示例进行命名：<br><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_2.5.png\" alt=\"NCBI文件命名示例\"></p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_3.png\" alt=\"获取下载链接\"></p>\n<p>建议用正则表达式替换（依赖EditPlus或其他具有正则表达式功能的文本编辑器），以基因组序列为例：</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_4.png\" alt=\"正则表达式批量替换获取基因组下载链接\"><br><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_5.png\" alt=\"替换后获得的基因组完整下载链接\"></p>\n</li>\n<li><p>开始下载<br>将获得的完整链接保存到名字为<code>link.txt</code>的文本文档中，在LINUX终端中运行<code>for link in $(cat link.txt); do wget -c $link; done</code>即可批量下载基因组到<code>genome</code>目录中。若不慎在行末引入了看不见的换行符，可以用命令<code>perl -pe &#39;s/[\\n\\r]+//g&#39; link.txt &gt; link2.txt</code>进行删除。再用<code>for link in $(cat link2.txt); do wget -c $link; done</code>下载。</p>\n</li>\n</ul>\n<h1 id=\"SRA数据下载\"><a href=\"#SRA数据下载\" class=\"headerlink\" title=\"SRA数据下载\"></a>SRA数据下载</h1><ul>\n<li><p>下载<a href=\"https://github.com/ncbi/sra-tools/wiki/01.-Downloading-SRA-Toolkit\">SRA Toolkit</a></p>\n<p>根据自己的系统选择合适的版本进行下载，并将软件包中<code>bin</code>的绝对路径或相对路径加入到环境变量中，以便可以在终端中直接调用。</p>\n</li>\n<li><p>设置默认下载目录</p>\n<p>如果不设置，默认会将基因组下载到家目录下，通过在终端里输入<code>vdb-config -i</code>命令配置下载目录，即下载到当前目录下。</p>\n<p> <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_6.jpg\" alt=\"设置SRA Toolkit默认下载文件存放位置\"></p>\n<p>  <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_7.jpg\" alt=\"设置SRA Toolkit默认下载文件存放位置\"></p>\n</li>\n<li><p>准备包含<code>SRA号</code>的列表文件，每一行含有一个编号，文件命名为<code>SRA.list</code>。</p>\n</li>\n<li><p>开始下载<br>将列表文件与脚本<code>downloadSRA.pl</code>放在同一目录下，在终端中运行<code>perl downloadSRA.pl</code>。</p>\n</li>\n</ul>\n<h1 id=\"利用FTP软件根据物种下载基因组\"><a href=\"#利用FTP软件根据物种下载基因组\" class=\"headerlink\" title=\"利用FTP软件根据物种下载基因组\"></a>利用FTP软件根据物种下载基因组</h1><p> <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_8.png\" alt=\"通过FileZilla批量下载基因组\"><br> <img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/213_9.png\" alt=\"通过FileZilla批量下载基因组\"><br>    在右侧的列表中选中所有目录拖拽到本地即可开始下载。</p>\n<h1 id=\"根据WGA-assession-number下载基因组\"><a href=\"#根据WGA-assession-number下载基因组\" class=\"headerlink\" title=\"根据WGA assession number下载基因组\"></a>根据WGA assession number下载基因组</h1><ul>\n<li><p>安装<a href=\"https://github.com/kblin/ncbi-genome-download\">ncbi-genome-download</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install -c bioconda ncbi-genome-download</span><br></pre></td></tr></table></figure></li>\n<li><p>准备WGA assession number列表文件</p>\n</li>\n<li><p>开始下载<br>终端里输入如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ncbi-genome-download --assembly-accessions GCA.txt --output-folder 6_3 bacteria --section genbank --formats fasta</span><br></pre></td></tr></table></figure>\n<p>其中<code>GCA.txt</code>为包含assession number的列表文件，每行一个assession number。<br>该软件的问题在于，需要<code>科学上网</code>，所以很多时候会掉链子。</p>\n</li>\n</ul>\n<h1 id=\"代码获取\"><a href=\"#代码获取\" class=\"headerlink\" title=\"代码获取\"></a>代码获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“213”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"NCBI","path":"api/tags/NCBI.json"},{"name":"下载","path":"api/tags/下载.json"}]}