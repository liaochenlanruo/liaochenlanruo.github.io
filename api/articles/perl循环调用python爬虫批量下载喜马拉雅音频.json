{"title":"perl循环调用python爬虫批量下载喜马拉雅音频","slug":"perl循环调用python爬虫批量下载喜马拉雅音频","date":"2018-09-16T11:30:38.000Z","updated":"2022-01-08T02:16:28.422Z","comments":true,"path":"api/articles/perl循环调用python爬虫批量下载喜马拉雅音频.json","excerpt":"手机下载喜马拉雅音频后，获得的音频文件虽然可以转成 mp3 格式，但其文件名却是一长串字符串，无法辨别是哪一集，网上找了各种工具，都有局限性，庆幸的是发现了一个 python 爬虫可以在电脑上实行批零下载文件名正确的音频，项目地址如下：","covers":null,"content":"<p>手机下载喜马拉雅音频后，获得的音频文件虽然可以转成 mp3 格式，但其文件名却是一长串字符串，无法辨别是哪一集，网上找了各种工具，都有局限性，庆幸的是发现了一个 python 爬虫可以在电脑上实行批零下载文件名正确的音频，项目地址如下：</p>\n<span id=\"more\"></span>\n<pre><code>    xmlyfetcher用于下载喜马拉雅歌曲资源，可以下载单个音频资源，也可以下载整个专辑. 项目地址：https://github.com/smallmuou/xmlyfetcher\n</code></pre>\n<p>运行之后发现一个小问题，该脚本只能爬取一页的内容，于是写了一个 perl 脚本循环调用该爬虫，实现一个脚本下载一部作品。<br />\n<strong>脚本如下，运行前做适当修改 (专辑地址、保存路径、页数)：</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/perl</span>\n\nuse strict<span class=\"token punctuation\">;</span>\n\nuse warnings<span class=\"token punctuation\">;</span>\n\nmy <span class=\"token variable\">$url</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://www.ximalaya.com/youshengshu/16951017/\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#专辑地址</span>\n\nmy <span class=\"token variable\">$dir</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"/mnt/e/BaiduYunDownload/Ximalaya/daomubiji2\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#文件保存路径，提前创建</span>\n\nmy <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token number\">29</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#专辑总页数</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>my <span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;=</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span>++<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\nmy <span class=\"token variable\">$url2</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$url</span> <span class=\"token builtin class-name\">.</span> <span class=\"token string\">\"p<span class=\"token variable\">$i</span>/\"</span><span class=\"token punctuation\">;</span>\n\nsystem <span class=\"token punctuation\">(</span><span class=\"token string\">\"xmlyfetcher -o <span class=\"token variable\">$dir</span> <span class=\"token variable\">$url2</span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","more":"<pre><code>    xmlyfetcher用于下载喜马拉雅歌曲资源，可以下载单个音频资源，也可以下载整个专辑. 项目地址：https://github.com/smallmuou/xmlyfetcher\n</code></pre>\n<p>运行之后发现一个小问题，该脚本只能爬取一页的内容，于是写了一个 perl 脚本循环调用该爬虫，实现一个脚本下载一部作品。<br />\n<strong>脚本如下，运行前做适当修改 (专辑地址、保存路径、页数)：</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/perl</span>\n\nuse strict<span class=\"token punctuation\">;</span>\n\nuse warnings<span class=\"token punctuation\">;</span>\n\nmy <span class=\"token variable\">$url</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://www.ximalaya.com/youshengshu/16951017/\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#专辑地址</span>\n\nmy <span class=\"token variable\">$dir</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"/mnt/e/BaiduYunDownload/Ximalaya/daomubiji2\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#文件保存路径，提前创建</span>\n\nmy <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token number\">29</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#专辑总页数</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>my <span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;=</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span>++<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\nmy <span class=\"token variable\">$url2</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$url</span> <span class=\"token builtin class-name\">.</span> <span class=\"token string\">\"p<span class=\"token variable\">$i</span>/\"</span><span class=\"token punctuation\">;</span>\n\nsystem <span class=\"token punctuation\">(</span><span class=\"token string\">\"xmlyfetcher -o <span class=\"token variable\">$dir</span> <span class=\"token variable\">$url2</span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>","categories":[{"name":"IT","path":"api/categories/IT.json"}],"tags":[{"name":"音乐","path":"api/tags/音乐.json"},{"name":"爬虫","path":"api/tags/爬虫.json"}]}