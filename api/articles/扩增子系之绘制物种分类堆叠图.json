{"title":"扩增子系之绘制物种分类堆叠图","slug":"扩增子系之绘制物种分类堆叠图","date":"2021-09-27T09:09:53.000Z","updated":"2024-03-11T13:07:17.363Z","comments":true,"path":"api/articles/扩增子系之绘制物种分类堆叠图.json","excerpt":null,"covers":null,"content":"<p><strong>为何要手绘堆叠图？</strong><br>QIIME2虽然可以生成堆叠图，然而图片只能在网页上查看，无法下载。此外，QIIME2的图有几分丑，且不可个性化修改，因此，手绘最靠谱。手绘当然不是用手画，而是用手敲代码。</p>\n<h1 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h1><ul>\n<li>各级别的物种分布文件，可以直接从QIIME2 生成的taxa_barplot.qzv文件提交至 <a href=\"https://view.qiime2.org/\">https://view.qiime2.org</a> ，随后从网页左上角“CSV”按钮处导出各分类级别的丰度表，但是要删除风度表最后几列的元数据信息，只保留丰度信息，各列之间以逗号分隔，内容如下所示，该文件是LEVEL-2（Phylum）水平的物种丰度分布：</li>\n</ul>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index,Bacteria;Chloroflexi,Bacteria;Planctomycetota,Archaea;Nanoarchaeota,Bacteria;Patescibacteria,Bacteria;Proteobacteria,Bacteria;Actinobacteriota,Archaea;Aenigmarchaeota,Bacteria;Acidobacteriota,Archaea;Altiarchaeota,Bacteria;Firmicutes,Bacteria;Bdellovibrionota,Bacteria;Dependentiae,Bacteria;Spirochaetota,Bacteria;Margulisbacteria,Bacteria;Myxococcota,Archaea;Halobacterota,Archaea;Crenarchaeota,Bacteria;Latescibacterota,Bacteria;NB1-j,Bacteria;Desulfobacterota,Bacteria;Verrucomicrobiota,Archaea;Iainarchaeota,Bacteria;DTB120,Bacteria;Elusimicrobiota,Eukaryota;SAR,Archaea;Asgardarchaeota,Archaea;Euryarchaeota,Bacteria;CK-2C2-2,Bacteria;Sva0485,Archaea;Thermoplasmatota,Bacteria;Bacteroidota,Bacteria;Marinimicrobia (SAR406 clade),Bacteria;MBNT15,Bacteria;Nitrospinota,Bacteria;Zixibacteria,Bacteria;Nitrospirota,Archaea;Micrarchaeota,Bacteria;LCP-89,Bacteria;Armatimonadota,Bacteria;WOR-1,Bacteria;Gemmatimonadota,Bacteria;Fibrobacterota,Bacteria;Calditrichota,Bacteria;Sumerlaeota,Bacteria;Aerophobota,Bacteria;WS1,Bacteria;NKB15,Bacteria;SAR324 clade(Marine group B),Bacteria;Dadabacteria,Bacteria;BHI80-139,Bacteria;Desantisbacteria,Bacteria;Schekmanbacteria,Archaea;Hadarchaeota,Archaea;Hydrothermarchaeota,Bacteria;Caldatribacteriota,Bacteria;TA06,Bacteria;WS2,Eukaryota;Amorphea,Bacteria;Cyanobacteria,Bacteria;Hydrogenedentes,Bacteria;Cloacimonadota,Bacteria;WPS-2,Bacteria;Modulibacteria,Eukaryota;Archaeplastida,Bacteria;10bav-F6,Bacteria;Methylomirabilota,Bacteria;Deferrisomatota,Bacteria;Fusobacteriota,Bacteria;Fermentibacterota,Bacteria;Entotheonellaeota,Eukaryota;Discoba,Bacteria;Campylobacterota,Bacteria;PAUC34f,Bacteria;Poribacteria,Bacteria;AncK6,Bacteria;GN01,Bacteria;Acetothermia,Bacteria;FCPU426</span><br><span class=\"line\">B01,383,1058,157,274,7755,1317,0,1025,0,39,22,16,0,0,71,0,6841,20,633,49,145,0,0,0,247,13,0,0,0,13,1012,0,0,53,0,137,0,0,39,0,271,7,17,4,0,0,0,7,471,0,0,0,0,0,3,0,0,69,3,53,0,0,0,0,0,46,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B02,225,507,98,27,3279,228,0,522,0,10,4,0,0,0,25,0,7995,8,336,6,54,0,0,0,9,4,0,0,0,0,259,0,12,65,0,29,0,0,0,0,163,0,16,0,0,0,0,22,106,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B03,196,360,246,38,2605,119,0,587,0,8,5,0,0,0,172,0,11619,16,370,11,0,3,0,0,13,0,0,0,0,0,206,5,0,83,8,67,0,0,0,0,130,0,5,0,0,0,0,27,136,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B04,437,922,636,61,4209,195,0,1051,0,9,5,6,0,0,274,0,14573,22,628,5,88,9,0,0,17,8,0,0,0,26,271,14,0,129,7,95,0,0,0,0,219,0,20,0,0,0,0,84,145,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,467,0,0,0,5,0,0,12,0,0,0,0,0</span><br><span class=\"line\">B05,240,1159,187,26,2929,149,0,778,0,8,0,0,0,0,204,0,10918,26,473,0,20,0,0,7,10,8,0,0,0,0,193,9,0,209,0,96,0,0,2,0,244,3,19,0,0,0,0,131,125,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,532,0,0,0,12,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B06,211,2003,1380,168,2469,188,12,617,3,13,4,15,7,2,196,0,7802,16,383,47,94,0,0,22,7,43,25,0,0,84,223,33,0,244,5,112,0,0,0,0,204,8,28,8,0,0,0,69,105,0,5,0,0,8,0,0,0,0,0,0,0,0,0,0,0,639,0,0,0,9,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B07,231,2607,4129,694,2667,231,20,399,12,36,10,21,37,0,156,0,5611,47,453,76,93,112,0,16,21,187,53,0,0,267,196,73,0,106,0,74,0,0,0,24,169,8,37,6,6,0,5,82,118,0,7,0,0,0,0,0,0,4,0,0,0,0,0,0,0,399,0,0,0,8,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B08,228,2573,4942,604,2084,150,51,507,7,14,0,22,32,2,109,0,6026,28,269,58,156,94,0,31,7,193,21,0,0,264,220,11,4,212,0,67,4,0,0,65,113,3,26,0,0,0,0,81,108,0,0,5,0,0,0,0,0,0,0,13,0,0,0,0,0,468,0,0,0,21,0,0,7,0,0,0,0,0</span><br><span class=\"line\">B09,606,3235,2950,1247,1922,696,52,487,16,21,20,84,12,0,107,0,1559,80,341,478,198,148,0,34,63,131,6,3,9,144,141,30,6,106,13,87,42,0,4,0,205,6,76,5,8,11,8,142,70,9,0,3,0,15,0,0,0,0,0,7,0,0,0,0,0,508,0,0,0,18,0,5,0,0,0,0,0,0</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>样本元数据，描述各样本特征的文件，以制表符分隔各列，内容如下：</li>\n</ul>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ID\tSamples\tLayer\tDepth\tLocation\tPosition\tSite</span><br><span class=\"line\">B01\tB01\t0-1\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B02\tB02\t1-2\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B03\tB03\t2-3\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B04\tB04\t3-4\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B05\tB05\t4-5\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B06\tB06\t5-6\t10\tRight\tDownstream\tB</span><br><span class=\"line\">B07\tB07\t6-7\t10\tRight\tDownstream\tB</span><br><span class=\"line\">B08\tB08\t7-8\t10\tRight\tDownstream\tB</span><br><span class=\"line\">B09\tB09\t8-9\t10\tRight\tDownstream\tB</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h1><p><strong>建议在Rstudio中运行。</strong></p>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 首先需要安装依赖包“amplicon”，如果没有安装“devtools”需要先安装，命令如下：</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"punctuation\">(</span><span class=\"operator\">!</span>requireNamespace<span class=\"punctuation\">(</span><span class=\"string\">&quot;devtools&quot;</span><span class=\"punctuation\">,</span> quietly<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">    install.packages<span class=\"punctuation\">(</span><span class=\"string\">&quot;devtools&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>devtools<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装依赖包“amplicon”，我对原作者的程序做了些许的优化，所以，可以从我的GitHub进行安装，命令如下：</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"punctuation\">(</span><span class=\"operator\">!</span>requireNamespace<span class=\"punctuation\">(</span><span class=\"string\">&quot;amplicon&quot;</span><span class=\"punctuation\">,</span> quietly<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">    install_github<span class=\"punctuation\">(</span><span class=\"string\">&quot;liaochenlanruo/amplicon&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">suppressWarnings<span class=\"punctuation\">(</span>suppressMessages<span class=\"punctuation\">(</span>library<span class=\"punctuation\">(</span>amplicon<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置工作目录，视自己的具体情况而定，工作目录中当包含输入文件：</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/ALL/细菌V6V8-1/Analysis_20210624/barplot&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 从文件读取元数据和物种注释</span></span><br><span class=\"line\">metadata<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;sample-metadata.tsv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">taxonomy<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;taxonomy.tsv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制堆叠柱状图，颜色自定义。界水平物种组成表和元数据作为输入，分组列名为Group，显示前4个分类，其余归类为其他(Other)，按丰度排序。</span></span><br><span class=\"line\">otutab1<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-1.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab1<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab1<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组，通过“groupID”参数设置分组信息，这里我选择根据站位（Site）分组，用户当根据自己的实际情况来设置。</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>ds<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab1<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">4</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ds2 <span class=\"operator\">=</span> ds <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 出图</span></span><br><span class=\"line\">ds2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>dd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab1<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">4</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">dd2 <span class=\"operator\">=</span> dd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">dd2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 门水平物种组成表和元数据作为输入，分组列名为Group，显示前19个分类，按丰度排序</span></span><br><span class=\"line\">otutab2<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-2.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab2<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab2<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>ps<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab2<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ps2 <span class=\"operator\">=</span> ps <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ps2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>pd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab2<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">pd2 <span class=\"operator\">=</span> pd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">pd2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 纲水平物种组成表和元数据作为输入，分组列名为Group，显示前19个分类，按丰度排序</span></span><br><span class=\"line\">otutab3<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-3.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">,</span> <span class=\"built_in\">quote</span><span class=\"operator\">=</span><span class=\"string\">&quot;\\&quot;&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab3<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab3<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>cs<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab3<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cs2 <span class=\"operator\">=</span> cs <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cs2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>cd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab3<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cd2 <span class=\"operator\">=</span> cd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cd2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 属水平物种组成表和元数据作为输入，分组列名为Site，显示前19个分类，按丰度排序</span></span><br><span class=\"line\">otutab6<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-6.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab6<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab6<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>gs<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab6<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gs2 <span class=\"operator\">=</span> gs <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gs2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>gd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab6<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gd2 <span class=\"operator\">=</span> gd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gd2</span><br></pre></td></tr></table></figure>\n\n<p>最后的图可以在Rstudio中手动导出。</p>\n<div style=\"position: relative; width: 100%; height: 0; padding-bottom: 75%;\"><iframe src=\"//player.bilibili.com/player.html?aid=378319348&page=\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" style=\"position: absolute; width: 100%; height: 100%; left: 0; top: 0;\"></iframe></div>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","more":"<p><strong>为何要手绘堆叠图？</strong><br>QIIME2虽然可以生成堆叠图，然而图片只能在网页上查看，无法下载。此外，QIIME2的图有几分丑，且不可个性化修改，因此，手绘最靠谱。手绘当然不是用手画，而是用手敲代码。</p>\n<h1 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h1><ul>\n<li>各级别的物种分布文件，可以直接从QIIME2 生成的taxa_barplot.qzv文件提交至 <a href=\"https://view.qiime2.org/\">https://view.qiime2.org</a> ，随后从网页左上角“CSV”按钮处导出各分类级别的丰度表，但是要删除风度表最后几列的元数据信息，只保留丰度信息，各列之间以逗号分隔，内容如下所示，该文件是LEVEL-2（Phylum）水平的物种丰度分布：</li>\n</ul>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index,Bacteria;Chloroflexi,Bacteria;Planctomycetota,Archaea;Nanoarchaeota,Bacteria;Patescibacteria,Bacteria;Proteobacteria,Bacteria;Actinobacteriota,Archaea;Aenigmarchaeota,Bacteria;Acidobacteriota,Archaea;Altiarchaeota,Bacteria;Firmicutes,Bacteria;Bdellovibrionota,Bacteria;Dependentiae,Bacteria;Spirochaetota,Bacteria;Margulisbacteria,Bacteria;Myxococcota,Archaea;Halobacterota,Archaea;Crenarchaeota,Bacteria;Latescibacterota,Bacteria;NB1-j,Bacteria;Desulfobacterota,Bacteria;Verrucomicrobiota,Archaea;Iainarchaeota,Bacteria;DTB120,Bacteria;Elusimicrobiota,Eukaryota;SAR,Archaea;Asgardarchaeota,Archaea;Euryarchaeota,Bacteria;CK-2C2-2,Bacteria;Sva0485,Archaea;Thermoplasmatota,Bacteria;Bacteroidota,Bacteria;Marinimicrobia (SAR406 clade),Bacteria;MBNT15,Bacteria;Nitrospinota,Bacteria;Zixibacteria,Bacteria;Nitrospirota,Archaea;Micrarchaeota,Bacteria;LCP-89,Bacteria;Armatimonadota,Bacteria;WOR-1,Bacteria;Gemmatimonadota,Bacteria;Fibrobacterota,Bacteria;Calditrichota,Bacteria;Sumerlaeota,Bacteria;Aerophobota,Bacteria;WS1,Bacteria;NKB15,Bacteria;SAR324 clade(Marine group B),Bacteria;Dadabacteria,Bacteria;BHI80-139,Bacteria;Desantisbacteria,Bacteria;Schekmanbacteria,Archaea;Hadarchaeota,Archaea;Hydrothermarchaeota,Bacteria;Caldatribacteriota,Bacteria;TA06,Bacteria;WS2,Eukaryota;Amorphea,Bacteria;Cyanobacteria,Bacteria;Hydrogenedentes,Bacteria;Cloacimonadota,Bacteria;WPS-2,Bacteria;Modulibacteria,Eukaryota;Archaeplastida,Bacteria;10bav-F6,Bacteria;Methylomirabilota,Bacteria;Deferrisomatota,Bacteria;Fusobacteriota,Bacteria;Fermentibacterota,Bacteria;Entotheonellaeota,Eukaryota;Discoba,Bacteria;Campylobacterota,Bacteria;PAUC34f,Bacteria;Poribacteria,Bacteria;AncK6,Bacteria;GN01,Bacteria;Acetothermia,Bacteria;FCPU426</span><br><span class=\"line\">B01,383,1058,157,274,7755,1317,0,1025,0,39,22,16,0,0,71,0,6841,20,633,49,145,0,0,0,247,13,0,0,0,13,1012,0,0,53,0,137,0,0,39,0,271,7,17,4,0,0,0,7,471,0,0,0,0,0,3,0,0,69,3,53,0,0,0,0,0,46,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B02,225,507,98,27,3279,228,0,522,0,10,4,0,0,0,25,0,7995,8,336,6,54,0,0,0,9,4,0,0,0,0,259,0,12,65,0,29,0,0,0,0,163,0,16,0,0,0,0,22,106,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B03,196,360,246,38,2605,119,0,587,0,8,5,0,0,0,172,0,11619,16,370,11,0,3,0,0,13,0,0,0,0,0,206,5,0,83,8,67,0,0,0,0,130,0,5,0,0,0,0,27,136,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B04,437,922,636,61,4209,195,0,1051,0,9,5,6,0,0,274,0,14573,22,628,5,88,9,0,0,17,8,0,0,0,26,271,14,0,129,7,95,0,0,0,0,219,0,20,0,0,0,0,84,145,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,467,0,0,0,5,0,0,12,0,0,0,0,0</span><br><span class=\"line\">B05,240,1159,187,26,2929,149,0,778,0,8,0,0,0,0,204,0,10918,26,473,0,20,0,0,7,10,8,0,0,0,0,193,9,0,209,0,96,0,0,2,0,244,3,19,0,0,0,0,131,125,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,532,0,0,0,12,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B06,211,2003,1380,168,2469,188,12,617,3,13,4,15,7,2,196,0,7802,16,383,47,94,0,0,22,7,43,25,0,0,84,223,33,0,244,5,112,0,0,0,0,204,8,28,8,0,0,0,69,105,0,5,0,0,8,0,0,0,0,0,0,0,0,0,0,0,639,0,0,0,9,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B07,231,2607,4129,694,2667,231,20,399,12,36,10,21,37,0,156,0,5611,47,453,76,93,112,0,16,21,187,53,0,0,267,196,73,0,106,0,74,0,0,0,24,169,8,37,6,6,0,5,82,118,0,7,0,0,0,0,0,0,4,0,0,0,0,0,0,0,399,0,0,0,8,0,0,0,0,0,0,0,0</span><br><span class=\"line\">B08,228,2573,4942,604,2084,150,51,507,7,14,0,22,32,2,109,0,6026,28,269,58,156,94,0,31,7,193,21,0,0,264,220,11,4,212,0,67,4,0,0,65,113,3,26,0,0,0,0,81,108,0,0,5,0,0,0,0,0,0,0,13,0,0,0,0,0,468,0,0,0,21,0,0,7,0,0,0,0,0</span><br><span class=\"line\">B09,606,3235,2950,1247,1922,696,52,487,16,21,20,84,12,0,107,0,1559,80,341,478,198,148,0,34,63,131,6,3,9,144,141,30,6,106,13,87,42,0,4,0,205,6,76,5,8,11,8,142,70,9,0,3,0,15,0,0,0,0,0,7,0,0,0,0,0,508,0,0,0,18,0,5,0,0,0,0,0,0</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>样本元数据，描述各样本特征的文件，以制表符分隔各列，内容如下：</li>\n</ul>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ID\tSamples\tLayer\tDepth\tLocation\tPosition\tSite</span><br><span class=\"line\">B01\tB01\t0-1\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B02\tB02\t1-2\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B03\tB03\t2-3\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B04\tB04\t3-4\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B05\tB05\t4-5\t5\tRight\tDownstream\tB</span><br><span class=\"line\">B06\tB06\t5-6\t10\tRight\tDownstream\tB</span><br><span class=\"line\">B07\tB07\t6-7\t10\tRight\tDownstream\tB</span><br><span class=\"line\">B08\tB08\t7-8\t10\tRight\tDownstream\tB</span><br><span class=\"line\">B09\tB09\t8-9\t10\tRight\tDownstream\tB</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h1><p><strong>建议在Rstudio中运行。</strong></p>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 首先需要安装依赖包“amplicon”，如果没有安装“devtools”需要先安装，命令如下：</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"punctuation\">(</span><span class=\"operator\">!</span>requireNamespace<span class=\"punctuation\">(</span><span class=\"string\">&quot;devtools&quot;</span><span class=\"punctuation\">,</span> quietly<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">    install.packages<span class=\"punctuation\">(</span><span class=\"string\">&quot;devtools&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>devtools<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装依赖包“amplicon”，我对原作者的程序做了些许的优化，所以，可以从我的GitHub进行安装，命令如下：</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"punctuation\">(</span><span class=\"operator\">!</span>requireNamespace<span class=\"punctuation\">(</span><span class=\"string\">&quot;amplicon&quot;</span><span class=\"punctuation\">,</span> quietly<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">    install_github<span class=\"punctuation\">(</span><span class=\"string\">&quot;liaochenlanruo/amplicon&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">suppressWarnings<span class=\"punctuation\">(</span>suppressMessages<span class=\"punctuation\">(</span>library<span class=\"punctuation\">(</span>amplicon<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置工作目录，视自己的具体情况而定，工作目录中当包含输入文件：</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/ALL/细菌V6V8-1/Analysis_20210624/barplot&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 从文件读取元数据和物种注释</span></span><br><span class=\"line\">metadata<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;sample-metadata.tsv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">taxonomy<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;taxonomy.tsv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制堆叠柱状图，颜色自定义。界水平物种组成表和元数据作为输入，分组列名为Group，显示前4个分类，其余归类为其他(Other)，按丰度排序。</span></span><br><span class=\"line\">otutab1<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-1.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab1<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab1<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组，通过“groupID”参数设置分组信息，这里我选择根据站位（Site）分组，用户当根据自己的实际情况来设置。</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>ds<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab1<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">4</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ds2 <span class=\"operator\">=</span> ds <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 出图</span></span><br><span class=\"line\">ds2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>dd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab1<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">4</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">dd2 <span class=\"operator\">=</span> dd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">dd2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 门水平物种组成表和元数据作为输入，分组列名为Group，显示前19个分类，按丰度排序</span></span><br><span class=\"line\">otutab2<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-2.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab2<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab2<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>ps<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab2<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ps2 <span class=\"operator\">=</span> ps <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ps2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>pd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab2<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">pd2 <span class=\"operator\">=</span> pd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">pd2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 纲水平物种组成表和元数据作为输入，分组列名为Group，显示前19个分类，按丰度排序</span></span><br><span class=\"line\">otutab3<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-3.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">,</span> <span class=\"built_in\">quote</span><span class=\"operator\">=</span><span class=\"string\">&quot;\\&quot;&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab3<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab3<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>cs<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab3<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cs2 <span class=\"operator\">=</span> cs <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cs2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>cd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab3<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cd2 <span class=\"operator\">=</span> cd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">cd2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 属水平物种组成表和元数据作为输入，分组列名为Site，显示前19个分类，按丰度排序</span></span><br><span class=\"line\">otutab6<span class=\"operator\">=</span>read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;level-6.csv&quot;</span><span class=\"punctuation\">,</span> header<span class=\"operator\">=</span><span class=\"built_in\">T</span><span class=\"punctuation\">,</span> row.names<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> sep<span class=\"operator\">=</span><span class=\"string\">&quot;,&quot;</span><span class=\"punctuation\">,</span> comment.char<span class=\"operator\">=</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> stringsAsFactors<span class=\"operator\">=</span><span class=\"built_in\">F</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">otutab6<span class=\"operator\">=</span>t<span class=\"punctuation\">(</span>otutab6<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照站位分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>gs<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab6<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Site&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gs2 <span class=\"operator\">=</span> gs <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gs2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#按照深度分组</span></span><br><span class=\"line\"><span class=\"punctuation\">(</span>gd<span class=\"operator\">=</span>tax_stackplot<span class=\"punctuation\">(</span>otutab6<span class=\"punctuation\">,</span> metadata<span class=\"punctuation\">,</span> groupID<span class=\"operator\">=</span><span class=\"string\">&quot;Depth&quot;</span><span class=\"punctuation\">,</span> topN<span class=\"operator\">=</span><span class=\"number\">20</span><span class=\"punctuation\">,</span> style<span class=\"operator\">=</span><span class=\"string\">&quot;sample&quot;</span><span class=\"punctuation\">,</span> sorted<span class=\"operator\">=</span><span class=\"string\">&quot;abundance&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gd2 <span class=\"operator\">=</span> gd <span class=\"operator\">+</span> scale_fill_manual<span class=\"punctuation\">(</span>values <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#aec7e8&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff7f0e&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ffbb78&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#98df8a&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#d62728&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#ff9896&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c5b0d5&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#8c564b&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c49c94&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#f7b6d2&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#7f7f7f&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#c7c7c7&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#dbdb8d&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;#9edae5&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">90</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">gd2</span><br></pre></td></tr></table></figure>\n\n<p>最后的图可以在Rstudio中手动导出。</p>\n<div style=\"position: relative; width: 100%; height: 0; padding-bottom: 75%;\"><iframe src=\"//player.bilibili.com/player.html?aid=378319348&page=\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" style=\"position: absolute; width: 100%; height: 100%; left: 0; top: 0;\"></iframe></div>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"扩增子","path":"api/tags/扩增子.json"},{"name":"SY179","path":"api/tags/SY179.json"},{"name":"R语言","path":"api/tags/R语言.json"}]}