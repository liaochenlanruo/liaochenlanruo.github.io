{"title":"R语言绘制分组条形图","slug":"R语言绘制分组条形图","date":"2021-11-26T06:37:02.000Z","updated":"2024-03-11T13:07:17.326Z","comments":true,"path":"api/articles/R语言绘制分组条形图.json","excerpt":null,"covers":["https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg"],"content":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a href=\"#输入文件样式\" class=\"headerlink\" title=\"输入文件样式\"></a>输入文件样式</h1><p>本例中数据内容如下图所示，将其保存在名为<code>CAZy.Category.Matrix.txt</code>的文件中。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"CAZy.Category.Matrix.txt\"></p>\n<h1 id=\"绘图代码\"><a href=\"#绘图代码\" class=\"headerlink\" title=\"绘图代码\"></a>绘图代码</h1><p>在Rstudio中运行如下代码，细节可根据具体情况修改</p>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">windowsFonts<span class=\"punctuation\">(</span>Arial<span class=\"operator\">=</span>windowsFont<span class=\"punctuation\">(</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"comment\">#加载Windows字体</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span> <span class=\"comment\">#设定工作目录</span></span><br><span class=\"line\">cazy <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;CAZy.Category.Matrix.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">cazy_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>cazy<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>cazy_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Cazy&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">ggplot<span class=\"punctuation\">(</span>cazy_melt<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">     geom_bar<span class=\"punctuation\">(</span>stat <span class=\"operator\">=</span> <span class=\"string\">&#x27;identity&#x27;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span></span><br><span class=\"line\">              aes<span class=\"punctuation\">(</span>fill <span class=\"operator\">=</span> Cazy<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">              position <span class=\"operator\">=</span> position_dodge<span class=\"punctuation\">(</span><span class=\"number\">0.9</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span><span class=\"comment\">#使柱子并排放置</span></span><br><span class=\"line\">     theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> </span><br><span class=\"line\">     theme<span class=\"punctuation\">(</span>text<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>family<span class=\"operator\">=</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">12</span><span class=\"punctuation\">,</span>face <span class=\"operator\">=</span> <span class=\"string\">&quot;plain&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"comment\">#设置文字的字体字号</span></span><br><span class=\"line\">           axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\"># 设置X轴文字大小</span></span><br><span class=\"line\">      scale_fill_manual<span class=\"punctuation\">(</span>values<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span>  <span class=\"comment\"># 设置填充颜色</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"分组条形图\"></p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R语言ggplot2分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar()函数绘制条形图</a></li>\n</ul>\n","more":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a href=\"#输入文件样式\" class=\"headerlink\" title=\"输入文件样式\"></a>输入文件样式</h1><p>本例中数据内容如下图所示，将其保存在名为<code>CAZy.Category.Matrix.txt</code>的文件中。</p>\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" alt=\"CAZy.Category.Matrix.txt\"></p>\n<h1 id=\"绘图代码\"><a href=\"#绘图代码\" class=\"headerlink\" title=\"绘图代码\"></a>绘图代码</h1><p>在Rstudio中运行如下代码，细节可根据具体情况修改</p>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">windowsFonts<span class=\"punctuation\">(</span>Arial<span class=\"operator\">=</span>windowsFont<span class=\"punctuation\">(</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"comment\">#加载Windows字体</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span> <span class=\"comment\">#设定工作目录</span></span><br><span class=\"line\">cazy <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;CAZy.Category.Matrix.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">cazy_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>cazy<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>cazy_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Cazy&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">ggplot<span class=\"punctuation\">(</span>cazy_melt<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span>y <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">     geom_bar<span class=\"punctuation\">(</span>stat <span class=\"operator\">=</span> <span class=\"string\">&#x27;identity&#x27;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span></span><br><span class=\"line\">              aes<span class=\"punctuation\">(</span>fill <span class=\"operator\">=</span> Cazy<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">              position <span class=\"operator\">=</span> position_dodge<span class=\"punctuation\">(</span><span class=\"number\">0.9</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span><span class=\"comment\">#使柱子并排放置</span></span><br><span class=\"line\">     theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> </span><br><span class=\"line\">     theme<span class=\"punctuation\">(</span>text<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>family<span class=\"operator\">=</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">12</span><span class=\"punctuation\">,</span>face <span class=\"operator\">=</span> <span class=\"string\">&quot;plain&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"comment\">#设置文字的字体字号</span></span><br><span class=\"line\">           axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\"># 设置X轴文字大小</span></span><br><span class=\"line\">      scale_fill_manual<span class=\"punctuation\">(</span>values<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#1f77b4&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#bcbd22&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2ca02c&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#17becf&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#9467bd&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#e377c2&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span>  <span class=\"comment\"># 设置填充颜色</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" alt=\"分组条形图\"></p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R语言ggplot2分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar()函数绘制条形图</a></li>\n</ul>\n","categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"SY179","path":"api/tags/SY179.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]}