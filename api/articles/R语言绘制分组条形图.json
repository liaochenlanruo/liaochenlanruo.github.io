{"title":"R语言绘制分组条形图","slug":"R语言绘制分组条形图","date":"2021-11-26T06:37:02.000Z","updated":"2022-01-08T02:16:28.413Z","comments":true,"path":"api/articles/R语言绘制分组条形图.json","excerpt":null,"covers":["https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg","https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg"],"content":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a class=\"markdownIt-Anchor\" href=\"#输入文件样式\"></a> 输入文件样式</h1>\n<p>本例中数据内容如下图所示，将其保存在名为 <code>CAZy.Category.Matrix.txt</code>  的文件中。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"CAZy.Category.Matrix.txt\" /></p>\n<h1 id=\"绘图代码\"><a class=\"markdownIt-Anchor\" href=\"#绘图代码\"></a> 绘图代码</h1>\n<p>在 Rstudio 中运行如下代码，细节可根据具体情况修改</p>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\nwindowsFonts<span class=\"token punctuation\">(</span>Arial<span class=\"token operator\">=</span>windowsFont<span class=\"token punctuation\">(</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#加载Windows字体</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#设定工作目录</span>\ncazy <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"CAZy.Category.Matrix.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\ncazy_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>cazy<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Cazy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\nggplot<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">,</span>aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n     geom_bar<span class=\"token punctuation\">(</span>stat <span class=\"token operator\">=</span> <span class=\"token string\">'identity'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span>\n              aes<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> Cazy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              position <span class=\"token operator\">=</span> position_dodge<span class=\"token punctuation\">(</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token comment\">#使柱子并排放置</span>\n     theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> \n     theme<span class=\"token punctuation\">(</span>text<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span>face <span class=\"token operator\">=</span> <span class=\"token string\">\"plain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#设置文字的字体字号</span>\n           axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token comment\"># 设置X轴文字大小</span>\n      scale_fill_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设置填充颜色</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"分组条形图\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R 语言 ggplot2 分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar () 函数绘制条形图</a></li>\n</ul>\n","more":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a class=\"markdownIt-Anchor\" href=\"#输入文件样式\"></a> 输入文件样式</h1>\n<p>本例中数据内容如下图所示，将其保存在名为 <code>CAZy.Category.Matrix.txt</code>  的文件中。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" alt=\"CAZy.Category.Matrix.txt\" /></p>\n<h1 id=\"绘图代码\"><a class=\"markdownIt-Anchor\" href=\"#绘图代码\"></a> 绘图代码</h1>\n<p>在 Rstudio 中运行如下代码，细节可根据具体情况修改</p>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\nwindowsFonts<span class=\"token punctuation\">(</span>Arial<span class=\"token operator\">=</span>windowsFont<span class=\"token punctuation\">(</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#加载Windows字体</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#设定工作目录</span>\ncazy <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"CAZy.Category.Matrix.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\ncazy_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>cazy<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Cazy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\nggplot<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">,</span>aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n     geom_bar<span class=\"token punctuation\">(</span>stat <span class=\"token operator\">=</span> <span class=\"token string\">'identity'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span>\n              aes<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> Cazy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              position <span class=\"token operator\">=</span> position_dodge<span class=\"token punctuation\">(</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token comment\">#使柱子并排放置</span>\n     theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> \n     theme<span class=\"token punctuation\">(</span>text<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span>face <span class=\"token operator\">=</span> <span class=\"token string\">\"plain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#设置文字的字体字号</span>\n           axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token comment\"># 设置X轴文字大小</span>\n      scale_fill_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设置填充颜色</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" alt=\"分组条形图\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R 语言 ggplot2 分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar () 函数绘制条形图</a></li>\n</ul>\n","categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"SY179","path":"api/tags/SY179.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]}