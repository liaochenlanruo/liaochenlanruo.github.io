{"title":"Linux骚操作","slug":"Linux骚操作","date":"2021-01-15T07:37:43.000Z","updated":"2024-03-11T13:07:17.318Z","comments":true,"path":"api/articles/Linux骚操作.json","excerpt":"记录一些平时遇到的Linux问题及解决方法！","covers":["https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill1.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill2.png","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill3.png"],"content":"<p>记录一些平时遇到的Linux问题及解决方法！</p>\n<span id=\"more\"></span>\n\n<h1 id=\"骚操作1：查杀僵尸进程\"><a href=\"#骚操作1：查杀僵尸进程\" class=\"headerlink\" title=\"骚操作1：查杀僵尸进程\"></a>骚操作1：查杀僵尸进程</h1><h2 id=\"通过top命令发现了僵尸进程\"><a href=\"#通过top命令发现了僵尸进程\" class=\"headerlink\" title=\"通过top命令发现了僵尸进程\"></a>通过top命令发现了僵尸进程</h2><p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill1.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill1.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"发现僵尸进程\"></p>\n<p>这里的aragorn和prodigal为僵尸进程。</p>\n<h2 id=\"寻找僵尸进程的父进程\"><a href=\"#寻找僵尸进程的父进程\" class=\"headerlink\" title=\"寻找僵尸进程的父进程\"></a>寻找僵尸进程的父进程</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -A -ostat,ppid,pid,cmd | grep -e <span class=\"string\">&#x27;^[Zz]&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill2.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill2.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"寻找父进程ppid\"></p>\n<p>aragorn和prodigal的父进程的ppid为133619。</p>\n<h2 id=\"杀死父进程\"><a href=\"#杀死父进程\" class=\"headerlink\" title=\"杀死父进程\"></a>杀死父进程</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">kill</span> -9 133619</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill3.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill3.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"僵尸进程已被杀死\"></p>\n<p>之所以选择杀死父进程是因为僵尸进程本身很难被杀掉！</p>\n<h1 id=\"骚操作2：使用sudo或nohup运行bash报错\"><a href=\"#骚操作2：使用sudo或nohup运行bash报错\" class=\"headerlink\" title=\"骚操作2：使用sudo或nohup运行bash报错\"></a>骚操作2：使用sudo或nohup运行bash报错</h1><h2 id=\"错误\"><a href=\"#错误\" class=\"headerlink\" title=\"错误\"></a>错误</h2><p>在终端里使用sudo或nohup运行bash的时候经常报错：-bash: syntax error near unexpected token ‘do’。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>将要运行的命令加到如下语句中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#用超级用户运行时</span></span><br><span class=\"line\">sudo bash -c <span class=\"string\">&#x27;your commands&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#服务器投后台运行</span></span><br><span class=\"line\"><span class=\"built_in\">nohup</span> bash -c <span class=\"string\">&#x27;your commands&#x27;</span> &amp;</span><br></pre></td></tr></table></figure>\n<h1 id=\"骚操作3：CentOS升级GCC\"><a href=\"#骚操作3：CentOS升级GCC\" class=\"headerlink\" title=\"骚操作3：CentOS升级GCC\"></a>骚操作3：CentOS升级GCC</h1><h2 id=\"安装SCL（第三方软件选集）\"><a href=\"#安装SCL（第三方软件选集）\" class=\"headerlink\" title=\"安装SCL（第三方软件选集）\"></a>安装SCL（第三方软件选集）</h2><p>使用下面命令安装SCL<br>SCL可以在不覆盖原有软件包的情况下与其共存，缺点就是仅支持64位<br>SCL仅支持安装devtoolset-4（gcc 5.2）（不含）之后的gcc版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y centos-release-scl</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装gcc\"><a href=\"#安装gcc\" class=\"headerlink\" title=\"安装gcc\"></a>安装gcc</h2><p>使用以下命令安装gcc，其中的9表示大版本号，默认安装大版本下的最新稳定版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"将gcc加入环境变量\"><a href=\"#将gcc加入环境变量\" class=\"headerlink\" title=\"将gcc加入环境变量\"></a>将gcc加入环境变量</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;source /opt/rh/devtoolset-9/enable&quot;</span> &gt;&gt; /etc/profile</span><br><span class=\"line\"><span class=\"built_in\">source</span> /etc/profile</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"骚操作4：CentOS-7防火墙\"><a href=\"#骚操作4：CentOS-7防火墙\" class=\"headerlink\" title=\"骚操作4：CentOS 7防火墙\"></a>骚操作4：CentOS 7防火墙</h1><h2 id=\"启动防火墙\"><a href=\"#启动防火墙\" class=\"headerlink\" title=\"启动防火墙\"></a>启动防火墙</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">启动： systemctl start firewalld</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"开启端口\"><a href=\"#开启端口\" class=\"headerlink\" title=\"开启端口\"></a>开启端口</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=80/tcp --permanent </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"重新载入\"><a href=\"#重新载入\" class=\"headerlink\" title=\"重新载入\"></a>重新载入</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看防火墙状态\"><a href=\"#查看防火墙状态\" class=\"headerlink\" title=\"查看防火墙状态\"></a>查看防火墙状态</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status firewalld.service</span><br><span class=\"line\"></span><br><span class=\"line\">firewall-cmd --state</span><br></pre></td></tr></table></figure>\n<h2 id=\"查看当前开了哪些端口\"><a href=\"#查看当前开了哪些端口\" class=\"headerlink\" title=\"查看当前开了哪些端口\"></a>查看当前开了哪些端口</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --list-services</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看所有打开的端口\"><a href=\"#查看所有打开的端口\" class=\"headerlink\" title=\"查看所有打开的端口\"></a>查看所有打开的端口</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"骚操作5：Linux基本指令丢失修复办法\"><a href=\"#骚操作5：Linux基本指令丢失修复办法\" class=\"headerlink\" title=\"骚操作5：Linux基本指令丢失修复办法\"></a>骚操作5：Linux基本指令丢失修复办法</h1><p>如输入ls、cd、cat等基本指令提示找不到命令，可以通过以下命令修复：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br></pre></td></tr></table></figure>\n","more":"<h1 id=\"骚操作1：查杀僵尸进程\"><a href=\"#骚操作1：查杀僵尸进程\" class=\"headerlink\" title=\"骚操作1：查杀僵尸进程\"></a>骚操作1：查杀僵尸进程</h1><h2 id=\"通过top命令发现了僵尸进程\"><a href=\"#通过top命令发现了僵尸进程\" class=\"headerlink\" title=\"通过top命令发现了僵尸进程\"></a>通过top命令发现了僵尸进程</h2><p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill1.png\" alt=\"发现僵尸进程\"></p>\n<p>这里的aragorn和prodigal为僵尸进程。</p>\n<h2 id=\"寻找僵尸进程的父进程\"><a href=\"#寻找僵尸进程的父进程\" class=\"headerlink\" title=\"寻找僵尸进程的父进程\"></a>寻找僵尸进程的父进程</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -A -ostat,ppid,pid,cmd | grep -e <span class=\"string\">&#x27;^[Zz]&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill2.png\" alt=\"寻找父进程ppid\"></p>\n<p>aragorn和prodigal的父进程的ppid为133619。</p>\n<h2 id=\"杀死父进程\"><a href=\"#杀死父进程\" class=\"headerlink\" title=\"杀死父进程\"></a>杀死父进程</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">kill</span> -9 133619</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/custom/papers/LinuxKill3.png\" alt=\"僵尸进程已被杀死\"></p>\n<p>之所以选择杀死父进程是因为僵尸进程本身很难被杀掉！</p>\n<h1 id=\"骚操作2：使用sudo或nohup运行bash报错\"><a href=\"#骚操作2：使用sudo或nohup运行bash报错\" class=\"headerlink\" title=\"骚操作2：使用sudo或nohup运行bash报错\"></a>骚操作2：使用sudo或nohup运行bash报错</h1><h2 id=\"错误\"><a href=\"#错误\" class=\"headerlink\" title=\"错误\"></a>错误</h2><p>在终端里使用sudo或nohup运行bash的时候经常报错：-bash: syntax error near unexpected token ‘do’。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>将要运行的命令加到如下语句中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#用超级用户运行时</span></span><br><span class=\"line\">sudo bash -c <span class=\"string\">&#x27;your commands&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#服务器投后台运行</span></span><br><span class=\"line\"><span class=\"built_in\">nohup</span> bash -c <span class=\"string\">&#x27;your commands&#x27;</span> &amp;</span><br></pre></td></tr></table></figure>\n<h1 id=\"骚操作3：CentOS升级GCC\"><a href=\"#骚操作3：CentOS升级GCC\" class=\"headerlink\" title=\"骚操作3：CentOS升级GCC\"></a>骚操作3：CentOS升级GCC</h1><h2 id=\"安装SCL（第三方软件选集）\"><a href=\"#安装SCL（第三方软件选集）\" class=\"headerlink\" title=\"安装SCL（第三方软件选集）\"></a>安装SCL（第三方软件选集）</h2><p>使用下面命令安装SCL<br>SCL可以在不覆盖原有软件包的情况下与其共存，缺点就是仅支持64位<br>SCL仅支持安装devtoolset-4（gcc 5.2）（不含）之后的gcc版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y centos-release-scl</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装gcc\"><a href=\"#安装gcc\" class=\"headerlink\" title=\"安装gcc\"></a>安装gcc</h2><p>使用以下命令安装gcc，其中的9表示大版本号，默认安装大版本下的最新稳定版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"将gcc加入环境变量\"><a href=\"#将gcc加入环境变量\" class=\"headerlink\" title=\"将gcc加入环境变量\"></a>将gcc加入环境变量</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;source /opt/rh/devtoolset-9/enable&quot;</span> &gt;&gt; /etc/profile</span><br><span class=\"line\"><span class=\"built_in\">source</span> /etc/profile</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"骚操作4：CentOS-7防火墙\"><a href=\"#骚操作4：CentOS-7防火墙\" class=\"headerlink\" title=\"骚操作4：CentOS 7防火墙\"></a>骚操作4：CentOS 7防火墙</h1><h2 id=\"启动防火墙\"><a href=\"#启动防火墙\" class=\"headerlink\" title=\"启动防火墙\"></a>启动防火墙</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">启动： systemctl start firewalld</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"开启端口\"><a href=\"#开启端口\" class=\"headerlink\" title=\"开启端口\"></a>开启端口</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=80/tcp --permanent </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"重新载入\"><a href=\"#重新载入\" class=\"headerlink\" title=\"重新载入\"></a>重新载入</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看防火墙状态\"><a href=\"#查看防火墙状态\" class=\"headerlink\" title=\"查看防火墙状态\"></a>查看防火墙状态</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status firewalld.service</span><br><span class=\"line\"></span><br><span class=\"line\">firewall-cmd --state</span><br></pre></td></tr></table></figure>\n<h2 id=\"查看当前开了哪些端口\"><a href=\"#查看当前开了哪些端口\" class=\"headerlink\" title=\"查看当前开了哪些端口\"></a>查看当前开了哪些端口</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --list-services</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看所有打开的端口\"><a href=\"#查看所有打开的端口\" class=\"headerlink\" title=\"查看所有打开的端口\"></a>查看所有打开的端口</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"骚操作5：Linux基本指令丢失修复办法\"><a href=\"#骚操作5：Linux基本指令丢失修复办法\" class=\"headerlink\" title=\"骚操作5：Linux基本指令丢失修复办法\"></a>骚操作5：Linux基本指令丢失修复办法</h1><p>如输入ls、cd、cat等基本指令提示找不到命令，可以通过以下命令修复：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br></pre></td></tr></table></figure>","categories":[{"name":"IT","path":"api/categories/IT.json"}],"tags":[{"name":"Linux","path":"api/tags/Linux.json"}]}