{"title":"利用NCycDB数据库从宏基因组中预测氮循环基因","slug":"利用NCycDB数据库从宏基因组中预测氮循环基因","date":"2021-11-25T03:19:20.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/利用NCycDB数据库从宏基因组中预测氮循环基因.json","excerpt":null,"covers":["https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png"],"content":"<p>氮（N）循环是地球生态系统中重要的生物地球化学途径的集合，在生态学和环境研究中得到了广泛的关注。目前，<ruby>鸟枪法宏基因组测序<rt>Shotgun metagenome sequencing</rt></ruby>已被广泛应用于探索负责 N 循环过程的基因家族。NCycDB是一个手动管理的综合数据库，用于从鸟枪法宏基因组测序数据中快速准确地分析 N 循环基因（亚）家族。 NCycDB 总共包含 68 个基因（亚）家族，涵盖 8 个 N 循环过程，分别具有 95% 和 100% 一致性阈值的 84 759 和 219 146 个代表性序列。数据库中还包含了1958 个<ruby>同源直系同源组<rt>Homologous orthology groups</rt></ruby>的序列，以避免由于“小数据库”问题导致的假阳性分配。</p>\n<h1 id=\"数据库及脚本\"><a href=\"#数据库及脚本\" class=\"headerlink\" title=\"数据库及脚本\"></a>数据库及脚本</h1><h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><ul>\n<li><p>通过Git</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/liaochenlanruo/NCyc.git</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>通过wget</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/liaochenlanruo/NCyc/archive/refs/heads/master.zip</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><ul>\n<li>通过<code>Git</code>下载的不需要解压，通过<code>Wget</code>下载的需要先解压。</li>\n<li>修改<code>NCycProfilter.PL</code>文件的第8-13行中4个依赖软件的安装路径。</li>\n<li>将<code>data</code>目录下的<code>NCyc_100_2019Jul.7z</code>解压，将解压得到的<code>NCyc_100_2019Jul</code>重命名为<code>NCyc_100.faa</code>并移动至<code>data</code>目录下。</li>\n</ul>\n<h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><ul>\n<li>Blast</li>\n<li>diamond</li>\n<li>usearch</li>\n<li>Perl</li>\n</ul>\n<h1 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h1><ul>\n<li><p>序列文件<br>宏基因组测序得到的Reads文件、组装后的序列文件以及通过基因预测后得到的氨基酸序列文件均可。序列文件可以是压缩的，也可以是解压的。</p>\n</li>\n<li><p>基因组-序列数对应文件<br>提供一份文本文档，共包含两列，第一列为<code>样本名称</code>(即序列文件的名字，不带文件后缀名)，第二列为<code>样本包含的序列数量</code>。</p>\n</li>\n</ul>\n<h1 id=\"预测\"><a href=\"#预测\" class=\"headerlink\" title=\"预测\"></a>预测</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl NCycProfiler.PL -d ./ -m diamond -f faa -s prot -si SI.txt -o Ncycle.out.txt</span><br></pre></td></tr></table></figure>\n<p>:::info<br>参数解析：<br>:::</p>\n<p>-d 指定工作目录，即序列文件所在目录。<br>-m 指定用哪个软件进行序列比对，可选<code>diamond</code>，<code>blast</code>，<code>usearch</code>。<br>-f 指定序列文件的后缀名，不需要带<code>.</code>。<br>-s 指定序列类型，氨基酸为<code>prot</code>，核苷酸为<code>nucl</code>。<br>-si 基因组-序列数对应文件<br>-rs 随机取样大小，如果不指定，将取包含序列最少的样本的序列数<br>-o 指定输出的文件名称</p>\n<h1 id=\"结果解析\"><a href=\"#结果解析\" class=\"headerlink\" title=\"结果解析\"></a>结果解析</h1><p>得到的结果文件是一个表格，第一行为随机取样大小。第一列为参与N循环的基因名，其他列为各样本含有的对应基因的数量。</p>\n<h1 id=\"可视化\"><a href=\"#可视化\" class=\"headerlink\" title=\"可视化\"></a>可视化</h1><p>可参考本站另一篇文章<a href=\"https://www.liaochenlanruo.fun/post/b68c.html\">R语言绘制气泡图Bubb_Plot</a>进行数据可视化。</p>\n<ul>\n<li>不带分组</li>\n</ul>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;Ncycle.out.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>data<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Genes&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span>as.data.frame<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 做主图</span></span><br><span class=\"line\">bubble <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">[</span>which<span class=\"punctuation\">(</span>data_melt<span class=\"operator\">$</span>Abundances<span class=\"operator\">&gt;</span><span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> Genes<span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">,</span> color <span class=\"operator\">=</span> Samples<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> geom_point<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 修改细节 — 图注，点大小，点shape</span></span><br><span class=\"line\">bubble_style <span class=\"operator\">&lt;-</span> bubble <span class=\"operator\">+</span> theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    labs<span class=\"punctuation\">(</span></span><br><span class=\"line\">        x <span class=\"operator\">=</span> <span class=\"string\">&quot;Sediment layers&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        y <span class=\"operator\">=</span> <span class=\"string\">&quot;N cycling genes&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        color<span class=\"operator\">=</span><span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\"># 颜色图注名</span></span><br><span class=\"line\">        size<span class=\"operator\">=</span><span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>    <span class=\"comment\"># 大小图注名</span></span><br><span class=\"line\">    scale_size<span class=\"punctuation\">(</span><span class=\"built_in\">range</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">0.1</span><span class=\"punctuation\">,</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0.1</span><span class=\"punctuation\">,</span> <span class=\"number\">0.6</span><span class=\"punctuation\">,</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span>  <span class=\"comment\">#等比修改圆圈大小</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>plot.title<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>family<span class=\"operator\">=</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                                  color<span class=\"operator\">=</span><span class=\"string\">&quot;red&quot;</span><span class=\"punctuation\">,</span>face<span class=\"operator\">=</span><span class=\"string\">&quot;italic&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                                  hjust<span class=\"operator\">=</span><span class=\"number\">0.5</span><span class=\"punctuation\">,</span>lineheight<span class=\"operator\">=</span><span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          plot.subtitle <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> </span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">bubble_style</span><br></pre></td></tr></table></figure>\n\n<p>依据下表获得基因的<code>Pathways</code>和<code>Annotation</code>，随后依据<code>Pathways</code>进行分组并绘图。</p>\n<table>\n<thead>\n<tr>\n<th>Pathways</th>\n<th>Gene (sub) families</th>\n<th>Annotation</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Nitrification</td>\n<td>amoA_A</td>\n<td>Ammonia monooxygenase subunit A (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoB_A</td>\n<td>Ammonia monooxygenase subunit B (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoC_A</td>\n<td>Ammonia monooxygenase subunit C (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoA_B</td>\n<td>Ammonia monooxygenase subunit A (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoB_B</td>\n<td>Ammonia monooxygenase subunit B (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoC_B</td>\n<td>Ammonia monooxygenase subunit C (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hao</td>\n<td>Hydroxylamine dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nxrA</td>\n<td>Nitrite oxidoreductase, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nxrB</td>\n<td>Nitrite oxidoreductase, beta subunit</td>\n</tr>\n<tr>\n<td>Denitrification</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirK</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirS</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>norB</td>\n<td>Nitric oxide reductase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>norC</td>\n<td>Nitric oxide reductase subunit C</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nosZ</td>\n<td>Nitrous-oxide reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>Assimilatory nitrate reduction</td>\n<td>nasA</td>\n<td>Assimilatory nitrate reductase catalytic subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nasB</td>\n<td>Assimilatory nitrate reductase electron transfer subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirA</td>\n<td>Ferredoxin-nitrite reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>NR</td>\n<td>Nitrate reductase (NAD(P)H)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narB</td>\n<td>Assimilatory nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narC</td>\n<td>Cytochrome b-561</td>\n</tr>\n<tr>\n<td>Dissimilatory nitrate reduction</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirB</td>\n<td>Nitrite reductase (NADH) large subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirD</td>\n<td>Nitrite reductase (NADH) small subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfA</td>\n<td>Nitrite reductase (cytochrome c-552)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfB</td>\n<td>Cytochrome c-type protein NrfB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfC</td>\n<td>Protein NrfC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfD</td>\n<td>Protein NrfD</td>\n</tr>\n<tr>\n<td>Nitrogen fixation</td>\n<td>anfG</td>\n<td>Nitrogenase delta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifD</td>\n<td>Nitrogenase molybdenum-iron protein alpha chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifH</td>\n<td>Nitrogenase iron protein NifH</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifK</td>\n<td>Nitrogenase molybdenum-iron protein beta chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifW</td>\n<td>Nitrogenase-stabilizing&#x2F;protective protein</td>\n</tr>\n<tr>\n<td>Anammox</td>\n<td>hzo</td>\n<td>Hydrazine oxidoreductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsA</td>\n<td>Hydrazine synthase subunit A</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsB</td>\n<td>Hydrazine synthase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsC</td>\n<td>Hydrazine synthase subunit C</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hdh</td>\n<td>Hydrazine dehydrogenase</td>\n</tr>\n<tr>\n<td>Organic degradation and synthesis</td>\n<td>ureA</td>\n<td>Urease subunit gamma</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ureB</td>\n<td>Urease subunit beta</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ureC</td>\n<td>Urease subunit alpha</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nao</td>\n<td>Nitroalkane oxidase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nmo</td>\n<td>Nitronate monooxygenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00260</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00261</td>\n<td>Glutamate dehydrogenase (NAD(P)+)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00262</td>\n<td>Glutamate dehydrogenase (NADP+)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K15371</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00264</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00265</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH) large chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00266</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH) small chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00284</td>\n<td>Glutamate synthase (ferredoxin)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>glsA</td>\n<td>Glutaminase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>glnA</td>\n<td>Glutamine synthetase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>asnB</td>\n<td>Asparagine synthase (glutamine-hydrolysing)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ansB</td>\n<td>Glutamin-(asparagin-)ase</td>\n</tr>\n<tr>\n<td>Others</td>\n<td>hcp</td>\n<td>Hydroxylamine reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoA</td>\n<td>Particulate methane monooxygenase subunit A</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoB</td>\n<td>Particulate methane monooxygenase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoC</td>\n<td>Particulate methane monooxygenase subunit C</td>\n</tr>\n</tbody></table>\n<ul>\n<li>带分组</li>\n</ul>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">data <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;Ncycle.out.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>data<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Genes&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Annotation&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Pathways&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span>as.data.frame<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span></span><br><span class=\"line\">bubble <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">[</span>which<span class=\"punctuation\">(</span>data_melt<span class=\"operator\">$</span>Abundances<span class=\"operator\">&gt;</span><span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> Genes<span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">,</span> color <span class=\"operator\">=</span> Samples<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme_bw<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> <span class=\"string\">&quot;Sediment layers&quot;</span><span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"string\">&quot;N cycling genes&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> colour <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> axis.text.y <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.grid <span class=\"operator\">=</span> element_blank<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> panel.border <span class=\"operator\">=</span> element_blank<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.spacing <span class=\"operator\">=</span> unit<span class=\"punctuation\">(</span><span class=\"number\">.1</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;lines&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> </span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>plot.margin<span class=\"operator\">=</span>unit<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;cm&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> geom_point<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> facet_grid<span class=\"punctuation\">(</span>Pathways <span class=\"operator\">~</span> .<span class=\"punctuation\">,</span> drop<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> scale<span class=\"operator\">=</span><span class=\"string\">&quot;free&quot;</span><span class=\"punctuation\">,</span>space<span class=\"operator\">=</span><span class=\"string\">&quot;free&quot;</span><span class=\"punctuation\">,</span> <span class=\"built_in\">switch</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>strip.background <span class=\"operator\">=</span> element_rect<span class=\"punctuation\">(</span>fill <span class=\"operator\">=</span> <span class=\"string\">&quot;grey95&quot;</span><span class=\"punctuation\">,</span> colour <span class=\"operator\">=</span> <span class=\"string\">&quot;white&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> strip.text.y.left <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle<span class=\"operator\">=</span><span class=\"number\">360</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> strip.text<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://doi.org/10.1093/bioinformatics/bty741\">NCycDB: a curated integrative database for fast and accurate metagenomic profiling of nitrogen cycling genes</a></li>\n<li><a href=\"https://github.com/qichao1984/NCyc\">GitHub</a></li>\n</ul>\n<h1 id=\"脚本获取\"><a href=\"#脚本获取\" class=\"headerlink\" title=\"脚本获取\"></a>脚本获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“18ea”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","more":"<p>氮（N）循环是地球生态系统中重要的生物地球化学途径的集合，在生态学和环境研究中得到了广泛的关注。目前，<ruby>鸟枪法宏基因组测序<rt>Shotgun metagenome sequencing</rt></ruby>已被广泛应用于探索负责 N 循环过程的基因家族。NCycDB是一个手动管理的综合数据库，用于从鸟枪法宏基因组测序数据中快速准确地分析 N 循环基因（亚）家族。 NCycDB 总共包含 68 个基因（亚）家族，涵盖 8 个 N 循环过程，分别具有 95% 和 100% 一致性阈值的 84 759 和 219 146 个代表性序列。数据库中还包含了1958 个<ruby>同源直系同源组<rt>Homologous orthology groups</rt></ruby>的序列，以避免由于“小数据库”问题导致的假阳性分配。</p>\n<h1 id=\"数据库及脚本\"><a href=\"#数据库及脚本\" class=\"headerlink\" title=\"数据库及脚本\"></a>数据库及脚本</h1><h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><ul>\n<li><p>通过Git</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/liaochenlanruo/NCyc.git</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>通过wget</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/liaochenlanruo/NCyc/archive/refs/heads/master.zip</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><ul>\n<li>通过<code>Git</code>下载的不需要解压，通过<code>Wget</code>下载的需要先解压。</li>\n<li>修改<code>NCycProfilter.PL</code>文件的第8-13行中4个依赖软件的安装路径。</li>\n<li>将<code>data</code>目录下的<code>NCyc_100_2019Jul.7z</code>解压，将解压得到的<code>NCyc_100_2019Jul</code>重命名为<code>NCyc_100.faa</code>并移动至<code>data</code>目录下。</li>\n</ul>\n<h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><ul>\n<li>Blast</li>\n<li>diamond</li>\n<li>usearch</li>\n<li>Perl</li>\n</ul>\n<h1 id=\"输入文件\"><a href=\"#输入文件\" class=\"headerlink\" title=\"输入文件\"></a>输入文件</h1><ul>\n<li><p>序列文件<br>宏基因组测序得到的Reads文件、组装后的序列文件以及通过基因预测后得到的氨基酸序列文件均可。序列文件可以是压缩的，也可以是解压的。</p>\n</li>\n<li><p>基因组-序列数对应文件<br>提供一份文本文档，共包含两列，第一列为<code>样本名称</code>(即序列文件的名字，不带文件后缀名)，第二列为<code>样本包含的序列数量</code>。</p>\n</li>\n</ul>\n<h1 id=\"预测\"><a href=\"#预测\" class=\"headerlink\" title=\"预测\"></a>预测</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl NCycProfiler.PL -d ./ -m diamond -f faa -s prot -si SI.txt -o Ncycle.out.txt</span><br></pre></td></tr></table></figure>\n<p>:::info<br>参数解析：<br>:::</p>\n<p>-d 指定工作目录，即序列文件所在目录。<br>-m 指定用哪个软件进行序列比对，可选<code>diamond</code>，<code>blast</code>，<code>usearch</code>。<br>-f 指定序列文件的后缀名，不需要带<code>.</code>。<br>-s 指定序列类型，氨基酸为<code>prot</code>，核苷酸为<code>nucl</code>。<br>-si 基因组-序列数对应文件<br>-rs 随机取样大小，如果不指定，将取包含序列最少的样本的序列数<br>-o 指定输出的文件名称</p>\n<h1 id=\"结果解析\"><a href=\"#结果解析\" class=\"headerlink\" title=\"结果解析\"></a>结果解析</h1><p>得到的结果文件是一个表格，第一行为随机取样大小。第一列为参与N循环的基因名，其他列为各样本含有的对应基因的数量。</p>\n<h1 id=\"可视化\"><a href=\"#可视化\" class=\"headerlink\" title=\"可视化\"></a>可视化</h1><p>可参考本站另一篇文章<a href=\"https://www.liaochenlanruo.fun/post/b68c.html\">R语言绘制气泡图Bubb_Plot</a>进行数据可视化。</p>\n<ul>\n<li>不带分组</li>\n</ul>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;Ncycle.out.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>data<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Genes&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span>as.data.frame<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 做主图</span></span><br><span class=\"line\">bubble <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">[</span>which<span class=\"punctuation\">(</span>data_melt<span class=\"operator\">$</span>Abundances<span class=\"operator\">&gt;</span><span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> Genes<span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">,</span> color <span class=\"operator\">=</span> Samples<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> geom_point<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 修改细节 — 图注，点大小，点shape</span></span><br><span class=\"line\">bubble_style <span class=\"operator\">&lt;-</span> bubble <span class=\"operator\">+</span> theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    labs<span class=\"punctuation\">(</span></span><br><span class=\"line\">        x <span class=\"operator\">=</span> <span class=\"string\">&quot;Sediment layers&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        y <span class=\"operator\">=</span> <span class=\"string\">&quot;N cycling genes&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        color<span class=\"operator\">=</span><span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\"># 颜色图注名</span></span><br><span class=\"line\">        size<span class=\"operator\">=</span><span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>    <span class=\"comment\"># 大小图注名</span></span><br><span class=\"line\">    scale_size<span class=\"punctuation\">(</span><span class=\"built_in\">range</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">0.1</span><span class=\"punctuation\">,</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0.1</span><span class=\"punctuation\">,</span> <span class=\"number\">0.6</span><span class=\"punctuation\">,</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span>  <span class=\"comment\">#等比修改圆圈大小</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>plot.title<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>family<span class=\"operator\">=</span><span class=\"string\">&quot;Arial&quot;</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                                  color<span class=\"operator\">=</span><span class=\"string\">&quot;red&quot;</span><span class=\"punctuation\">,</span>face<span class=\"operator\">=</span><span class=\"string\">&quot;italic&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                                  hjust<span class=\"operator\">=</span><span class=\"number\">0.5</span><span class=\"punctuation\">,</span>lineheight<span class=\"operator\">=</span><span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          plot.subtitle <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> </span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">bubble_style</span><br></pre></td></tr></table></figure>\n\n<p>依据下表获得基因的<code>Pathways</code>和<code>Annotation</code>，随后依据<code>Pathways</code>进行分组并绘图。</p>\n<table>\n<thead>\n<tr>\n<th>Pathways</th>\n<th>Gene (sub) families</th>\n<th>Annotation</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Nitrification</td>\n<td>amoA_A</td>\n<td>Ammonia monooxygenase subunit A (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoB_A</td>\n<td>Ammonia monooxygenase subunit B (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoC_A</td>\n<td>Ammonia monooxygenase subunit C (archaea)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoA_B</td>\n<td>Ammonia monooxygenase subunit A (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoB_B</td>\n<td>Ammonia monooxygenase subunit B (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>amoC_B</td>\n<td>Ammonia monooxygenase subunit C (bacteria)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hao</td>\n<td>Hydroxylamine dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nxrA</td>\n<td>Nitrite oxidoreductase, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nxrB</td>\n<td>Nitrite oxidoreductase, beta subunit</td>\n</tr>\n<tr>\n<td>Denitrification</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirK</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirS</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>norB</td>\n<td>Nitric oxide reductase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>norC</td>\n<td>Nitric oxide reductase subunit C</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nosZ</td>\n<td>Nitrous-oxide reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>Assimilatory nitrate reduction</td>\n<td>nasA</td>\n<td>Assimilatory nitrate reductase catalytic subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nasB</td>\n<td>Assimilatory nitrate reductase electron transfer subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirA</td>\n<td>Ferredoxin-nitrite reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>NR</td>\n<td>Nitrate reductase (NAD(P)H)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narB</td>\n<td>Assimilatory nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narC</td>\n<td>Cytochrome b-561</td>\n</tr>\n<tr>\n<td>Dissimilatory nitrate reduction</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirB</td>\n<td>Nitrite reductase (NADH) large subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nirD</td>\n<td>Nitrite reductase (NADH) small subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfA</td>\n<td>Nitrite reductase (cytochrome c-552)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfB</td>\n<td>Cytochrome c-type protein NrfB</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfC</td>\n<td>Protein NrfC</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nrfD</td>\n<td>Protein NrfD</td>\n</tr>\n<tr>\n<td>Nitrogen fixation</td>\n<td>anfG</td>\n<td>Nitrogenase delta subunit</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifD</td>\n<td>Nitrogenase molybdenum-iron protein alpha chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifH</td>\n<td>Nitrogenase iron protein NifH</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifK</td>\n<td>Nitrogenase molybdenum-iron protein beta chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nifW</td>\n<td>Nitrogenase-stabilizing&#x2F;protective protein</td>\n</tr>\n<tr>\n<td>Anammox</td>\n<td>hzo</td>\n<td>Hydrazine oxidoreductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsA</td>\n<td>Hydrazine synthase subunit A</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsB</td>\n<td>Hydrazine synthase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hzsC</td>\n<td>Hydrazine synthase subunit C</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>hdh</td>\n<td>Hydrazine dehydrogenase</td>\n</tr>\n<tr>\n<td>Organic degradation and synthesis</td>\n<td>ureA</td>\n<td>Urease subunit gamma</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ureB</td>\n<td>Urease subunit beta</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ureC</td>\n<td>Urease subunit alpha</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nao</td>\n<td>Nitroalkane oxidase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>nmo</td>\n<td>Nitronate monooxygenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00260</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00261</td>\n<td>Glutamate dehydrogenase (NAD(P)+)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K00262</td>\n<td>Glutamate dehydrogenase (NADP+)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gdh_K15371</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00264</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00265</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH) large chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00266</td>\n<td>Glutamate synthase (NADPH&#x2F;NADH) small chain</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>gs_K00284</td>\n<td>Glutamate synthase (ferredoxin)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>glsA</td>\n<td>Glutaminase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>glnA</td>\n<td>Glutamine synthetase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>asnB</td>\n<td>Asparagine synthase (glutamine-hydrolysing)</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>ansB</td>\n<td>Glutamin-(asparagin-)ase</td>\n</tr>\n<tr>\n<td>Others</td>\n<td>hcp</td>\n<td>Hydroxylamine reductase</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoA</td>\n<td>Particulate methane monooxygenase subunit A</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoB</td>\n<td>Particulate methane monooxygenase subunit B</td>\n</tr>\n<tr>\n<td>^^</td>\n<td>pmoC</td>\n<td>Particulate methane monooxygenase subunit C</td>\n</tr>\n</tbody></table>\n<ul>\n<li>带分组</li>\n</ul>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setwd<span class=\"punctuation\">(</span><span class=\"string\">&quot;E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">data <span class=\"operator\">&lt;-</span> read.table<span class=\"punctuation\">(</span><span class=\"string\">&quot;Ncycle.out.txt&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> sep <span class=\"operator\">=</span> <span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reshape<span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span> melt<span class=\"punctuation\">(</span>data<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;Genes&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Annotation&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Pathways&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Samples&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;Abundances&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">data_melt <span class=\"operator\">&lt;-</span>as.data.frame<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">)</span></span><br><span class=\"line\">bubble <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data_melt<span class=\"punctuation\">[</span>which<span class=\"punctuation\">(</span>data_melt<span class=\"operator\">$</span>Abundances<span class=\"operator\">&gt;</span><span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> Samples<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> Genes<span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> Abundances<span class=\"punctuation\">,</span> color <span class=\"operator\">=</span> Samples<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> theme_bw<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> labs<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> <span class=\"string\">&quot;Sediment layers&quot;</span><span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"string\">&quot;N cycling genes&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> colour <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span> vjust <span class=\"operator\">=</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> hjust <span class=\"operator\">=</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> axis.text.y <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.grid <span class=\"operator\">=</span> element_blank<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> panel.border <span class=\"operator\">=</span> element_blank<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.spacing <span class=\"operator\">=</span> unit<span class=\"punctuation\">(</span><span class=\"number\">.1</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;lines&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> </span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>plot.margin<span class=\"operator\">=</span>unit<span class=\"punctuation\">(</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">1</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;cm&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> geom_point<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span> facet_grid<span class=\"punctuation\">(</span>Pathways <span class=\"operator\">~</span> .<span class=\"punctuation\">,</span> drop<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span> scale<span class=\"operator\">=</span><span class=\"string\">&quot;free&quot;</span><span class=\"punctuation\">,</span>space<span class=\"operator\">=</span><span class=\"string\">&quot;free&quot;</span><span class=\"punctuation\">,</span> <span class=\"built_in\">switch</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>strip.background <span class=\"operator\">=</span> element_rect<span class=\"punctuation\">(</span>fill <span class=\"operator\">=</span> <span class=\"string\">&quot;grey95&quot;</span><span class=\"punctuation\">,</span> colour <span class=\"operator\">=</span> <span class=\"string\">&quot;white&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> strip.text.y.left <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>angle<span class=\"operator\">=</span><span class=\"number\">360</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> strip.text<span class=\"operator\">=</span>element_text<span class=\"punctuation\">(</span>size<span class=\"operator\">=</span><span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://doi.org/10.1093/bioinformatics/bty741\">NCycDB: a curated integrative database for fast and accurate metagenomic profiling of nitrogen cycling genes</a></li>\n<li><a href=\"https://github.com/qichao1984/NCyc\">GitHub</a></li>\n</ul>\n<h1 id=\"脚本获取\"><a href=\"#脚本获取\" class=\"headerlink\" title=\"脚本获取\"></a>脚本获取</h1><p>关注公众号“生信之巅”，聊天窗口回复“18ea”获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://fastly.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n\n\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"宏基因组","path":"api/tags/宏基因组.json"},{"name":"Functional genomics","path":"api/tags/Functional genomics.json"},{"name":"SY179","path":"api/tags/SY179.json"},{"name":"生信软件","path":"api/tags/生信软件.json"}]}