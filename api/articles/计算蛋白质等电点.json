{"title":"计算蛋白质等电点并绘制全局pI图","slug":"计算蛋白质等电点","date":"2022-01-03T02:49:17.000Z","updated":"2022-01-08T02:16:28.468Z","comments":true,"path":"api/articles/计算蛋白质等电点.json","excerpt":null,"covers":["https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png","https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg","https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png"],"content":"<h1 id=\"蛋白质组的全局-pis\"><a class=\"markdownIt-Anchor\" href=\"#蛋白质组的全局-pis\"></a> 蛋白质组的全局 pIs</h1>\n<p>细胞全局蛋白质组 pI 图的变化取决于氨基酸的总电荷，并对蛋白质的结构和特性具有重要意义。</p>\n<p>普遍认为原核基因组具有两个最大的双峰形状，一个在酸性 pH 值下主要对应于溶解的蛋白质（细胞质蛋白或分泌蛋白），另一种在膜蛋白的碱性 pH 值下，具有细胞内碱性（带正电荷）结构域以促进质子动力的产生。在这两个峰之间，有一个最小的中性值，对应于细胞内的 pH 值（如下图）。</p>\n<p>蛋白质氨基酸组成和 pI 水平的显着变化提供了一种工具来预测培养物或宏基因组组装基因组 (MAG) 的首选栖息地。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"蛋白质组的全局 pIs\" /><br />\n<a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n<h1 id=\"安装emboss\"><a class=\"markdownIt-Anchor\" href=\"#安装emboss\"></a> 安装 EMBOSS</h1>\n<ul>\n<li>下载</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span>  ftp://emboss.open-bio.org/pub/EMBOSS/emboss-latest.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 解压</span>\n<span class=\"token function\">tar</span> zxvf emboss-latest.tar.gz\n\n<span class=\"token comment\"># 防止报错 (error while loading shared libraries: libnucleus.so.6)</span>\n<span class=\"token function\">sudo</span> /sbin/ldconfig\n\n<span class=\"token comment\"># 配置、编译与安装</span>\n<span class=\"token builtin class-name\">cd</span> emboss-latest\n./configure\n<span class=\"token function\">make</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"输入文件\"><a class=\"markdownIt-Anchor\" href=\"#输入文件\"></a> 输入文件</h1>\n<p>输入文件为含有一条或多条氨基酸序列的 FASTA 格式文件。</p>\n<h1 id=\"ruby计算氨基酸序列的各特征数据rtcalculate-statistics-of-protein-propertiesrtruby\"><a class=\"markdownIt-Anchor\" href=\"#ruby计算氨基酸序列的各特征数据rtcalculate-statistics-of-protein-propertiesrtruby\"></a> <ruby>计算氨基酸序列的各特征数据<rt>Calculate statistics of protein properties</rt></ruby></h1>\n<h2 id=\"逐个文件计算\"><a class=\"markdownIt-Anchor\" href=\"#逐个文件计算\"></a> 逐个文件计算</h2>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pepstats -sequence F01_bin.1.faa -outfile F01_bin.1.out<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note primary 参数解析\">\n<ul>\n<li>\n<p>Standard (Mandatory) qualifiers:</p>\n<ul>\n<li>[-sequence]          seqall     Protein sequence(s) filename and optional<br />\nformat, or reference (input USA)</li>\n<li>[-outfile]           outfile    [*.pepstats] Pepstats program output file</li>\n</ul>\n</li>\n<li>\n<p>Advanced (Unprompted) qualifiers:</p>\n<ul>\n<li>-aadata             datafile   [Eamino.dat] Amino acid properties</li>\n<li>-mwdata             datafile   [Emolwt.dat] Molecular weight data for amino<br />\nacids</li>\n<li>-pkdata             datafile   [Epk.dat] Values of pKa for amino acids</li>\n<li>-[no]termini        boolean    [Y] Include charge at N and C terminus</li>\n<li>-mono               boolean    [N] Use monoisotopic weights</li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"批量计算与pi提取并输出为相对丰度\"><a class=\"markdownIt-Anchor\" href=\"#批量计算与pi提取并输出为相对丰度\"></a> 批量计算与 pI 提取并输出为相对丰度</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># name: print_pI.pl</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.03</span>\n\n<span class=\"token keyword\">my</span> <span class=\"token variable\">@genome</span> <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"*.faa\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span><span class=\"token variable\">@genome</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$_</span><span class=\"token operator\">=~</span><span class=\"token regex\">/(\\S+).faa/</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$out</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">.</span> <span class=\"token string\">\".pepstats\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$pi</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">.</span> <span class=\"token string\">\".pI\"</span><span class=\"token punctuation\">;</span>\n\tsystem<span class=\"token punctuation\">(</span><span class=\"token string\">\"pepstats -sequence $_ -outfile $out\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">%hash</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$seqnum</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\topen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$out\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tchomp<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token regex\">/^(Isoelectric Point = )(\\S+)/</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$pi</span> <span class=\"token operator\">=</span> sprintf <span class=\"token string\">\"%.1f\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$2</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$pi</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$seqnum</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose IN<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">#my @records = values %hash;</span>\n\t<span class=\"token comment\">#my $seqnum = @records;</span>\n\t<span class=\"token comment\">#print $seqnum . \"\\n\";</span>\n\topen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">$pi\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"Isoelectric point\\tRelative frequency\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span>keys <span class=\"token variable\">%hash</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$frequency</span> <span class=\"token operator\">=</span> sprintf <span class=\"token string\">\"%.2f\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">/</span><span class=\"token variable\">$seqnum</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#@records;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$_\\t$frequency\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose OUT<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"选择性忽略-这是我自己用的\"><a class=\"markdownIt-Anchor\" href=\"#选择性忽略-这是我自己用的\"></a> 选择性忽略 （这是我自己用的）</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># name: co_sample_pI.pl</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.03</span>\n\nopen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">F06.pi\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"MAGs\\tIsoelectric point\\tRelative frequency\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">@pI</span> <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"F06*.pI\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span><span class=\"token variable\">@pI</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$_</span><span class=\"token operator\">=~</span><span class=\"token regex\">/(\\S+).pI/</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$mag</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span><span class=\"token punctuation\">;</span>\n\topen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$_\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tchomp<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$mag\\t$_\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose IN<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose OUT<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"可视化\"><a class=\"markdownIt-Anchor\" href=\"#可视化\"></a> 可视化</h1>\n<h2 id=\"绘制蛋白质组的全局-pis图\"><a class=\"markdownIt-Anchor\" href=\"#绘制蛋白质组的全局-pis图\"></a> 绘制蛋白质组的全局 pIs 图</h2>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\"><span class=\"token comment\"># Step 1 读入数据</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/Results/Annotations/AAs\"</span><span class=\"token punctuation\">)</span>\n\nF1 <span class=\"token operator\">&lt;-</span>read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"F01_bin.1.pI\"</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Step 2 绘图，以下5选1</span>\n<span class=\"token comment\">## 单组加点，运行完后跳到Step 3</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_point<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>shape<span class=\"token operator\">=</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## 单组无点，运行完后跳到Step 3</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">## 多组加点</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_point<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>shape<span class=\"token operator\">=</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">## 多组无点显示置信区间</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## 多组无点去除置信区间</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">,</span>se <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># Step 3 美化，看下图</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## ==============以下代码为自用========================</span>\n<span class=\"token comment\">## F04自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## F05自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## F06自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#f7b6d2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#5254a3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#000000\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"蛋白质组的全局 pIs\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li>\n<p><a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n</li>\n<li>\n<p><a href=\"http://emboss.sourceforge.net/\">EMBOSS</a></p>\n</li>\n</ul>\n<h1 id=\"代码获取\"><a class=\"markdownIt-Anchor\" href=\"#代码获取\"></a> 代码获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “85d7” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","more":"<h1 id=\"蛋白质组的全局-pis\"><a class=\"markdownIt-Anchor\" href=\"#蛋白质组的全局-pis\"></a> 蛋白质组的全局 pIs</h1>\n<p>细胞全局蛋白质组 pI 图的变化取决于氨基酸的总电荷，并对蛋白质的结构和特性具有重要意义。</p>\n<p>普遍认为原核基因组具有两个最大的双峰形状，一个在酸性 pH 值下主要对应于溶解的蛋白质（细胞质蛋白或分泌蛋白），另一种在膜蛋白的碱性 pH 值下，具有细胞内碱性（带正电荷）结构域以促进质子动力的产生。在这两个峰之间，有一个最小的中性值，对应于细胞内的 pH 值（如下图）。</p>\n<p>蛋白质氨基酸组成和 pI 水平的显着变化提供了一种工具来预测培养物或宏基因组组装基因组 (MAG) 的首选栖息地。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" alt=\"蛋白质组的全局 pIs\" /><br />\n<a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n<h1 id=\"安装emboss\"><a class=\"markdownIt-Anchor\" href=\"#安装emboss\"></a> 安装 EMBOSS</h1>\n<ul>\n<li>下载</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span>  ftp://emboss.open-bio.org/pub/EMBOSS/emboss-latest.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 解压</span>\n<span class=\"token function\">tar</span> zxvf emboss-latest.tar.gz\n\n<span class=\"token comment\"># 防止报错 (error while loading shared libraries: libnucleus.so.6)</span>\n<span class=\"token function\">sudo</span> /sbin/ldconfig\n\n<span class=\"token comment\"># 配置、编译与安装</span>\n<span class=\"token builtin class-name\">cd</span> emboss-latest\n./configure\n<span class=\"token function\">make</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"输入文件\"><a class=\"markdownIt-Anchor\" href=\"#输入文件\"></a> 输入文件</h1>\n<p>输入文件为含有一条或多条氨基酸序列的 FASTA 格式文件。</p>\n<h1 id=\"ruby计算氨基酸序列的各特征数据rtcalculate-statistics-of-protein-propertiesrtruby\"><a class=\"markdownIt-Anchor\" href=\"#ruby计算氨基酸序列的各特征数据rtcalculate-statistics-of-protein-propertiesrtruby\"></a> <ruby>计算氨基酸序列的各特征数据<rt>Calculate statistics of protein properties</rt></ruby></h1>\n<h2 id=\"逐个文件计算\"><a class=\"markdownIt-Anchor\" href=\"#逐个文件计算\"></a> 逐个文件计算</h2>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pepstats -sequence F01_bin.1.faa -outfile F01_bin.1.out<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note primary 参数解析\">\n<ul>\n<li>\n<p>Standard (Mandatory) qualifiers:</p>\n<ul>\n<li>[-sequence]          seqall     Protein sequence(s) filename and optional<br />\nformat, or reference (input USA)</li>\n<li>[-outfile]           outfile    [*.pepstats] Pepstats program output file</li>\n</ul>\n</li>\n<li>\n<p>Advanced (Unprompted) qualifiers:</p>\n<ul>\n<li>-aadata             datafile   [Eamino.dat] Amino acid properties</li>\n<li>-mwdata             datafile   [Emolwt.dat] Molecular weight data for amino<br />\nacids</li>\n<li>-pkdata             datafile   [Epk.dat] Values of pKa for amino acids</li>\n<li>-[no]termini        boolean    [Y] Include charge at N and C terminus</li>\n<li>-mono               boolean    [N] Use monoisotopic weights</li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"批量计算与pi提取并输出为相对丰度\"><a class=\"markdownIt-Anchor\" href=\"#批量计算与pi提取并输出为相对丰度\"></a> 批量计算与 pI 提取并输出为相对丰度</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># name: print_pI.pl</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.03</span>\n\n<span class=\"token keyword\">my</span> <span class=\"token variable\">@genome</span> <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"*.faa\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span><span class=\"token variable\">@genome</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$_</span><span class=\"token operator\">=~</span><span class=\"token regex\">/(\\S+).faa/</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$out</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">.</span> <span class=\"token string\">\".pepstats\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$pi</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">.</span> <span class=\"token string\">\".pI\"</span><span class=\"token punctuation\">;</span>\n\tsystem<span class=\"token punctuation\">(</span><span class=\"token string\">\"pepstats -sequence $_ -outfile $out\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">%hash</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$seqnum</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\topen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$out\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tchomp<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token regex\">/^(Isoelectric Point = )(\\S+)/</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$pi</span> <span class=\"token operator\">=</span> sprintf <span class=\"token string\">\"%.1f\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$2</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$pi</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$seqnum</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose IN<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">#my @records = values %hash;</span>\n\t<span class=\"token comment\">#my $seqnum = @records;</span>\n\t<span class=\"token comment\">#print $seqnum . \"\\n\";</span>\n\topen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">$pi\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"Isoelectric point\\tRelative frequency\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span>keys <span class=\"token variable\">%hash</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$frequency</span> <span class=\"token operator\">=</span> sprintf <span class=\"token string\">\"%.2f\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">/</span><span class=\"token variable\">$seqnum</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#@records;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$_\\t$frequency\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose OUT<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"选择性忽略-这是我自己用的\"><a class=\"markdownIt-Anchor\" href=\"#选择性忽略-这是我自己用的\"></a> 选择性忽略 （这是我自己用的）</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># name: co_sample_pI.pl</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.03</span>\n\nopen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">F06.pi\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"MAGs\\tIsoelectric point\\tRelative frequency\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">@pI</span> <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"F06*.pI\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span><span class=\"token variable\">@pI</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$_</span><span class=\"token operator\">=~</span><span class=\"token regex\">/(\\S+).pI/</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$mag</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span><span class=\"token punctuation\">;</span>\n\topen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$_\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tchomp<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$mag\\t$_\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose IN<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose OUT<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"可视化\"><a class=\"markdownIt-Anchor\" href=\"#可视化\"></a> 可视化</h1>\n<h2 id=\"绘制蛋白质组的全局-pis图\"><a class=\"markdownIt-Anchor\" href=\"#绘制蛋白质组的全局-pis图\"></a> 绘制蛋白质组的全局 pIs 图</h2>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\"><span class=\"token comment\"># Step 1 读入数据</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/Results/Annotations/AAs\"</span><span class=\"token punctuation\">)</span>\n\nF1 <span class=\"token operator\">&lt;-</span>read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"F01_bin.1.pI\"</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Step 2 绘图，以下5选1</span>\n<span class=\"token comment\">## 单组加点，运行完后跳到Step 3</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_point<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>shape<span class=\"token operator\">=</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## 单组无点，运行完后跳到Step 3</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">## 多组加点</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_point<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>shape<span class=\"token operator\">=</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">## 多组无点显示置信区间</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## 多组无点去除置信区间</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">,</span>se <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># Step 3 美化，看下图</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## ==============以下代码为自用========================</span>\n<span class=\"token comment\">## F04自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## F05自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## F06自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#f7b6d2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#5254a3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#000000\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" alt=\"蛋白质组的全局 pIs\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li>\n<p><a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n</li>\n<li>\n<p><a href=\"http://emboss.sourceforge.net/\">EMBOSS</a></p>\n</li>\n</ul>\n<h1 id=\"代码获取\"><a class=\"markdownIt-Anchor\" href=\"#代码获取\"></a> 代码获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “85d7” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"WGS","path":"api/tags/WGS.json"},{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"蛋白质组","path":"api/tags/蛋白质组.json"}]}