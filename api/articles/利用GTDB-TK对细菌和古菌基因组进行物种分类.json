{"title":"利用GTDB-TK对细菌和古菌基因组进行物种分类","slug":"利用GTDB-TK对细菌和古菌基因组进行物种分类","date":"2021-12-10T03:14:45.000Z","updated":"2024-03-11T13:07:17.000Z","comments":true,"path":"api/articles/利用GTDB-TK对细菌和古菌基因组进行物种分类.json","excerpt":null,"covers":null,"content":"<p>GTDB-Tk 是一个软件工具包，用于根据<ruby>基因组数据库分类 GTDB<rt>Genome Database Taxonomy GTDB</rt></ruby> 为细菌和古菌基因组<ruby>分配客观分类学分类<rt>assigning objective taxonomic classifications</rt></ruby>。可以用于宏基因组组装基因组 (MAG)、单菌基因组和单细胞基因组。</p>\n<h1 id=\"安装GTDB-Tk\"><a href=\"#安装GTDB-Tk\" class=\"headerlink\" title=\"安装GTDB-Tk\"></a>安装GTDB-Tk</h1><ul>\n<li><p>通过conda安装主程序</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># latest version</span></span><br><span class=\"line\">conda create -n gtdbtk -c conda-forge -c bioconda gtdbtk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># specific version (replace 2.3.0 with the version you wish to install, recommended)</span></span><br><span class=\"line\">conda create -n gtdbtk -c conda-forge -c bioconda gtdbtk=2.3.0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>下载GTDB-Tk数据库 (~47 G)</p>\n<p>最新版本的数据库为R214，需要 &gt;&#x3D;2.1.0 版本的GTDB-Tk。</p>\n<ul>\n<li><p>自动 (非常慢)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">download-db.sh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>手动</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> \t<span class=\"comment\"># 找到下载脚本的路径并打开，从中找到数据库的链接</span></span><br><span class=\"line\"><span class=\"built_in\">which</span> download-db.sh</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># 进入数据库默认路径</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/miniconda3/envs/gtdbtk/share/gtdbtk-2.3.0/db/</span><br><span class=\"line\">\t  </span><br><span class=\"line\">   <span class=\"comment\"># 用wget下载 (非常慢)，推荐在Windows下用其他软件下载，再上传服务器</span></span><br><span class=\"line\"><span class=\"built_in\">nohup</span> wget -c https://data.gtdb.ecogenomic.org/releases/release214/214.0/auxillary_files/gtdbtk_r214_data.tar.gz --no-check-certificate &amp;</span><br><span class=\"line\"></span><br><span class=\"line\">tar zxvf gtdbtk_r214_data.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">mv</span> release214/* ./</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 也可自定义数据库的存放位置</span></span><br><span class=\"line\">编辑`~/miniconda3/envs/gtdbtk/etc/conda/activate.d/gtdbtk.sh`，将`<span class=\"built_in\">export</span> GTDBTK_DATA_PATH=`后面的内容改成数据库所在的路径。</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"运行软件\"><a href=\"#运行软件\" class=\"headerlink\" title=\"运行软件\"></a>运行软件</h1><p>:::info<br>注意：pplacer requires ~215 GB of RAM to fully load the bacterial tree into memory. 因此要么在服务器上运行，要么设置足够大的swap分区方可在PC中运行。<br>:::</p>\n<h2 id=\"classify-wf\"><a href=\"#classify-wf\" class=\"headerlink\" title=\"classify_wf\"></a>classify_wf</h2><p>:::default<br>可以通过<code>classify_wf</code>命令完成整个工作流程。<br>:::</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># v2.3.0增加了两个参数（二选一）：--skip_ani_screen，--mash_db，前者无参数值，后者指定MASH参考数据库 (.msh)的输出或读取路径</span></span><br><span class=\"line\">gtdbtk classify_wf --genome_dir &lt;my_genomes&gt; --out_dir &lt;output_dir&gt; --extension fna --cpus 20 --force --skip_ani_screen</span><br></pre></td></tr></table></figure>\n\n<p>+++primary 参数解析</p>\n<ul>\n<li><p>--genome_dir<br>directory containing genome files in FASTA format</p>\n</li>\n<li><p>--batchfile<br>path to file describing genomes - tab separated in 2 or 3 columns (FASTA file, genome ID, translation table [optional])</p>\n</li>\n<li><p>--out_dir<br>directory to output files</p>\n</li>\n<li><p>--skip_ani_screen     Skip the ani_screening step to classify genomes using mash and FastANI (default: False)</p>\n</li>\n<li><p>--mash_db MASH_DB     path to save&#x2F;read (if exists) the Mash reference sketch database (.msh)</p>\n</li>\n<li><p>-x, --extension<br>extension of files to process, gz &#x3D; gzipped (Default: fna)</p>\n</li>\n<li><p>--min_perc_aa<br>exclude genomes that do not have at least this percentage of AA in the MSA (inclusive bound) (Default: 10)</p>\n</li>\n<li><p>--prefix<br>prefix for all output files (Default: gtdbtk)</p>\n</li>\n<li><p>--cpus<br>number of CPUs to use (Default: 1)</p>\n</li>\n<li><p>--pplacer_cpus<br>use pplacer_cpus during placement (default: cpus)</p>\n</li>\n<li><p>--force<br>continue processing if an error occurs on a single genome</p>\n</li>\n<li><p>--scratch_dir<br>Reduce pplacer memory usage by writing to disk (slower).</p>\n</li>\n<li><p>--min_af<br>minimum alignment fraction to consider closest genome (Default: 0.65)</p>\n</li>\n<li><p>--tmpdir<br>specify alternative directory for temporary files （Default: &#x2F;tmp</p>\n</li>\n<li><p>--debug<br>create intermediate files for debugging purposes<br>+++</p>\n</li>\n</ul>\n<p>:::default<br>但下面我们演示分步运行。在处理大型管道时，单独运行这些步骤有时会很有用。<br>:::</p>\n<h2 id=\"Step-1-准备输入文件\"><a href=\"#Step-1-准备输入文件\" class=\"headerlink\" title=\"Step 1 准备输入文件\"></a>Step 1 准备输入文件</h2><p>以下两个基因组作为示例文件：* Genome A: <code>GCF_003947435.1</code> [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> &#x2F; <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCF_003947435.1/\">NCBI</a>] * Genome B: <code>GCA_002011125.1</code> [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> &#x2F; <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCA_002011125.1/\">NCBI</a>]。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Create the directory.</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /tmp/gtdbtk &amp;&amp; <span class=\"built_in\">cd</span> /tmp/gtdbtk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Obtain the genomes.</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /tmp/gtdbtk/genomes</span><br><span class=\"line\">wget -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/003/947/435/GCF_003947435.1_ASM394743v1/GCF_003947435.1_ASM394743v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_a.fna.gz</span><br><span class=\"line\"></span><br><span class=\"line\">wget -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/002/011/125/GCA_002011125.1_ASM201112v1/GCA_002011125.1_ASM201112v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_b.fna.gz</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-2-Gene-calling-identify\"><a href=\"#Step-2-Gene-calling-identify\" class=\"headerlink\" title=\"Step 2 Gene calling (identify)\"></a>Step 2 Gene calling (identify)</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk identify --genome_dir /tmp/gtdbtk/genomes --out_dir /tmp/gtdbtk/identify --extension gz --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>获得的基因和<ruby>标记<rt>marker</rt></ruby>信息可以在每个<ruby>基因组反应中间文件目录<rt>genomes respeective intermediate files directory</rt></ruby>下找到，如下所示。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/identify/identify/intermediate_results/marker_genes/genome_a.fna/</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam<span class=\"built_in\">_</span>tophit.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.gff.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam<span class=\"built_in\">_</span>tophit.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.out</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.out.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam<span class=\"built_in\">_</span>tophit.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.faa</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam<span class=\"built_in\">_</span>tophit.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.faa.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.fna</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.fna.sha256</span><br><span class=\"line\">prodigal<span class=\"built_in\">_</span>translation<span class=\"built_in\">_</span>table.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.gff</span><br><span class=\"line\">prodigal<span class=\"built_in\">_</span>translation<span class=\"built_in\">_</span>table.tsv.sha256</span><br></pre></td></tr></table></figure>\n<p>:::default<br>大部分情况下只需要读取摘要文件，其中详细说明了从archaeal 122或bacterial 120<ruby>标记集<rt>marker set</rt></ruby>识别的标记。<br>:::</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> /tmp/gtdbtk/identify/gtdbtk.ar122.markers_summary.tsv</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name    number<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes     number<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>genes   number<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes    number<span class=\"built_in\">_</span>missing<span class=\"built_in\">_</span>genes    list<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes       list<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>genes     list<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes      list<span class=\"built_in\">_</span>missing<span class=\"built_in\">_</span>genes</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna    109     3       0       10      PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,PF13685.1,TIGR00021,TIGR00037,TIGR00042,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00549,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01213,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02390,TIGR02651,TIGR03626,TIGR03627,TIGR03628,TIGR03636,TIGR03653,TIGR03665,TIGR03671,TIGR03672,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684    PF01496.14,TIGR00458,TIGR00658          PF01866.12,TIGR00064,TIGR00373,TIGR00522,TIGR02338,TIGR02389,TIGR03629,TIGR03670,TIGR03673,TIGR03722</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>b.fna    118     2       0       2       PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01866.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,TIGR00021,TIGR00037,TIGR00042,TIGR00064,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00373,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00458,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00522,TIGR00549,TIGR00658,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02338,TIGR02389,TIGR02390,TIGR02651,TIGR03626,TIGR03628,TIGR03629,TIGR03636,TIGR03653,TIGR03665,TIGR03670,TIGR03671,TIGR03672,TIGR03673,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684,TIGR03722 PF01496.14,PF13685.1            TIGR01213,TIGR03627</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"Step-3-Aligning-genomes-align\"><a href=\"#Step-3-Aligning-genomes-align\" class=\"headerlink\" title=\"Step 3 Aligning genomes (align)\"></a>Step 3 Aligning genomes (align)</h2><p>该步骤将对齐所有已识别的标记，确定最可能的<ruby>域<rt>domain </rt></ruby>并输出串联的MSA。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk align --identify_dir /tmp/gtdbtk/identify --out_dir /tmp/gtdbtk/align --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>:::warning<br>要注意输出，如果一个基因组识别出的标记数量较少，那么在这一步，它将被排除在分析之外。如果出现这种情况，将出现警告。<br>:::</p>\n<p>根据domain的不同，<code>ar122</code>或<code>bac120</code>的前缀文件将出现，其中包含用户基因组和GTDB基因组的MSA，或仅包含用户基因组（<code>gtdbtk.ar122.MSA.fasta</code>和<code>gtdbtk.ar122.user_MSA.fasta</code>）。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/align</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">align/</span><br><span class=\"line\">gtdbtk.ar122.user<span class=\"built_in\">_</span>msa.fasta</span><br><span class=\"line\">identify/</span><br><span class=\"line\">gtdbtk.ar122.filtered.tsv</span><br><span class=\"line\">gtdbtk.log</span><br><span class=\"line\">gtdbtk.ar122.msa.fasta</span><br><span class=\"line\">gtdbtk.warnings.log</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"Step-4-基因组分类-classify\"><a href=\"#Step-4-基因组分类-classify\" class=\"headerlink\" title=\"Step 4 基因组分类 (classify)\"></a>Step 4 基因组分类 (classify)</h2><p>将用户的基因组放置于参考树上，然后决定其最为可能的分类。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk classify --genome_dir /tmp/gtdbtk/genomes --align_dir /tmp/gtdbtk/align --out_dir /tmp/gtdbtk/classify -x gz --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>两个主要的输出文件包括<ruby>总结文件<rt>summary file</rt></ruby>和包含基因组的参考树 (<code>gtdbtk.ar122.summary.tsv</code>和<code>gtdbtk.ar122.classify.tree</code>)。基因组的分类信息呈现于总结文件中。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/classify</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classify/</span><br><span class=\"line\">gtdbtk.ar122.summary.tsv</span><br><span class=\"line\">gtdbtk.warnings.log</span><br><span class=\"line\">gtdbtk.ar122.classify.tree</span><br><span class=\"line\">gtdbtk.log</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"错误信息处理\"><a href=\"#错误信息处理\" class=\"headerlink\" title=\"错误信息处理\"></a>错误信息处理</h2><ul>\n<li><p>OpenBLAS blas_thread_init: pthread_create failed for thread 109 of 128: Resource temporarily unavailable</p>\n<ul>\n<li>解决方案：少调用一些线程就ok了。</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://ecogenomics.github.io/GTDBTk\">GTBD-Tk Documentation</a></li>\n</ul>\n","more":"<p>GTDB-Tk 是一个软件工具包，用于根据<ruby>基因组数据库分类 GTDB<rt>Genome Database Taxonomy GTDB</rt></ruby> 为细菌和古菌基因组<ruby>分配客观分类学分类<rt>assigning objective taxonomic classifications</rt></ruby>。可以用于宏基因组组装基因组 (MAG)、单菌基因组和单细胞基因组。</p>\n<h1 id=\"安装GTDB-Tk\"><a href=\"#安装GTDB-Tk\" class=\"headerlink\" title=\"安装GTDB-Tk\"></a>安装GTDB-Tk</h1><ul>\n<li><p>通过conda安装主程序</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># latest version</span></span><br><span class=\"line\">conda create -n gtdbtk -c conda-forge -c bioconda gtdbtk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># specific version (replace 2.3.0 with the version you wish to install, recommended)</span></span><br><span class=\"line\">conda create -n gtdbtk -c conda-forge -c bioconda gtdbtk=2.3.0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>下载GTDB-Tk数据库 (~47 G)</p>\n<p>最新版本的数据库为R214，需要 &gt;&#x3D;2.1.0 版本的GTDB-Tk。</p>\n<ul>\n<li><p>自动 (非常慢)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">download-db.sh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>手动</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> \t<span class=\"comment\"># 找到下载脚本的路径并打开，从中找到数据库的链接</span></span><br><span class=\"line\"><span class=\"built_in\">which</span> download-db.sh</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># 进入数据库默认路径</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/miniconda3/envs/gtdbtk/share/gtdbtk-2.3.0/db/</span><br><span class=\"line\">\t  </span><br><span class=\"line\">   <span class=\"comment\"># 用wget下载 (非常慢)，推荐在Windows下用其他软件下载，再上传服务器</span></span><br><span class=\"line\"><span class=\"built_in\">nohup</span> wget -c https://data.gtdb.ecogenomic.org/releases/release214/214.0/auxillary_files/gtdbtk_r214_data.tar.gz --no-check-certificate &amp;</span><br><span class=\"line\"></span><br><span class=\"line\">tar zxvf gtdbtk_r214_data.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">mv</span> release214/* ./</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 也可自定义数据库的存放位置</span></span><br><span class=\"line\">编辑`~/miniconda3/envs/gtdbtk/etc/conda/activate.d/gtdbtk.sh`，将`<span class=\"built_in\">export</span> GTDBTK_DATA_PATH=`后面的内容改成数据库所在的路径。</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"运行软件\"><a href=\"#运行软件\" class=\"headerlink\" title=\"运行软件\"></a>运行软件</h1><p>:::info<br>注意：pplacer requires ~215 GB of RAM to fully load the bacterial tree into memory. 因此要么在服务器上运行，要么设置足够大的swap分区方可在PC中运行。<br>:::</p>\n<h2 id=\"classify-wf\"><a href=\"#classify-wf\" class=\"headerlink\" title=\"classify_wf\"></a>classify_wf</h2><p>:::default<br>可以通过<code>classify_wf</code>命令完成整个工作流程。<br>:::</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># v2.3.0增加了两个参数（二选一）：--skip_ani_screen，--mash_db，前者无参数值，后者指定MASH参考数据库 (.msh)的输出或读取路径</span></span><br><span class=\"line\">gtdbtk classify_wf --genome_dir &lt;my_genomes&gt; --out_dir &lt;output_dir&gt; --extension fna --cpus 20 --force --skip_ani_screen</span><br></pre></td></tr></table></figure>\n\n<p>+++primary 参数解析</p>\n<ul>\n<li><p>--genome_dir<br>directory containing genome files in FASTA format</p>\n</li>\n<li><p>--batchfile<br>path to file describing genomes - tab separated in 2 or 3 columns (FASTA file, genome ID, translation table [optional])</p>\n</li>\n<li><p>--out_dir<br>directory to output files</p>\n</li>\n<li><p>--skip_ani_screen     Skip the ani_screening step to classify genomes using mash and FastANI (default: False)</p>\n</li>\n<li><p>--mash_db MASH_DB     path to save&#x2F;read (if exists) the Mash reference sketch database (.msh)</p>\n</li>\n<li><p>-x, --extension<br>extension of files to process, gz &#x3D; gzipped (Default: fna)</p>\n</li>\n<li><p>--min_perc_aa<br>exclude genomes that do not have at least this percentage of AA in the MSA (inclusive bound) (Default: 10)</p>\n</li>\n<li><p>--prefix<br>prefix for all output files (Default: gtdbtk)</p>\n</li>\n<li><p>--cpus<br>number of CPUs to use (Default: 1)</p>\n</li>\n<li><p>--pplacer_cpus<br>use pplacer_cpus during placement (default: cpus)</p>\n</li>\n<li><p>--force<br>continue processing if an error occurs on a single genome</p>\n</li>\n<li><p>--scratch_dir<br>Reduce pplacer memory usage by writing to disk (slower).</p>\n</li>\n<li><p>--min_af<br>minimum alignment fraction to consider closest genome (Default: 0.65)</p>\n</li>\n<li><p>--tmpdir<br>specify alternative directory for temporary files （Default: &#x2F;tmp</p>\n</li>\n<li><p>--debug<br>create intermediate files for debugging purposes<br>+++</p>\n</li>\n</ul>\n<p>:::default<br>但下面我们演示分步运行。在处理大型管道时，单独运行这些步骤有时会很有用。<br>:::</p>\n<h2 id=\"Step-1-准备输入文件\"><a href=\"#Step-1-准备输入文件\" class=\"headerlink\" title=\"Step 1 准备输入文件\"></a>Step 1 准备输入文件</h2><p>以下两个基因组作为示例文件：* Genome A: <code>GCF_003947435.1</code> [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> &#x2F; <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCF_003947435.1/\">NCBI</a>] * Genome B: <code>GCA_002011125.1</code> [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> &#x2F; <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCA_002011125.1/\">NCBI</a>]。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Create the directory.</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /tmp/gtdbtk &amp;&amp; <span class=\"built_in\">cd</span> /tmp/gtdbtk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Obtain the genomes.</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /tmp/gtdbtk/genomes</span><br><span class=\"line\">wget -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/003/947/435/GCF_003947435.1_ASM394743v1/GCF_003947435.1_ASM394743v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_a.fna.gz</span><br><span class=\"line\"></span><br><span class=\"line\">wget -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/002/011/125/GCA_002011125.1_ASM201112v1/GCA_002011125.1_ASM201112v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_b.fna.gz</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-2-Gene-calling-identify\"><a href=\"#Step-2-Gene-calling-identify\" class=\"headerlink\" title=\"Step 2 Gene calling (identify)\"></a>Step 2 Gene calling (identify)</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk identify --genome_dir /tmp/gtdbtk/genomes --out_dir /tmp/gtdbtk/identify --extension gz --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>获得的基因和<ruby>标记<rt>marker</rt></ruby>信息可以在每个<ruby>基因组反应中间文件目录<rt>genomes respeective intermediate files directory</rt></ruby>下找到，如下所示。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/identify/identify/intermediate_results/marker_genes/genome_a.fna/</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam<span class=\"built_in\">_</span>tophit.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.gff.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam<span class=\"built_in\">_</span>tophit.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.out</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.out.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>pfam.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam<span class=\"built_in\">_</span>tophit.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.faa</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam<span class=\"built_in\">_</span>tophit.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.faa.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.fna</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>tigrfam.tsv.sha256</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.fna.sha256</span><br><span class=\"line\">prodigal<span class=\"built_in\">_</span>translation<span class=\"built_in\">_</span>table.tsv</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna<span class=\"built_in\">_</span>protein.gff</span><br><span class=\"line\">prodigal<span class=\"built_in\">_</span>translation<span class=\"built_in\">_</span>table.tsv.sha256</span><br></pre></td></tr></table></figure>\n<p>:::default<br>大部分情况下只需要读取摘要文件，其中详细说明了从archaeal 122或bacterial 120<ruby>标记集<rt>marker set</rt></ruby>识别的标记。<br>:::</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> /tmp/gtdbtk/identify/gtdbtk.ar122.markers_summary.tsv</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name    number<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes     number<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>genes   number<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes    number<span class=\"built_in\">_</span>missing<span class=\"built_in\">_</span>genes    list<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes       list<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>genes     list<span class=\"built_in\">_</span>multiple<span class=\"built_in\">_</span>unique<span class=\"built_in\">_</span>genes      list<span class=\"built_in\">_</span>missing<span class=\"built_in\">_</span>genes</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>a.fna    109     3       0       10      PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,PF13685.1,TIGR00021,TIGR00037,TIGR00042,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00549,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01213,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02390,TIGR02651,TIGR03626,TIGR03627,TIGR03628,TIGR03636,TIGR03653,TIGR03665,TIGR03671,TIGR03672,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684    PF01496.14,TIGR00458,TIGR00658          PF01866.12,TIGR00064,TIGR00373,TIGR00522,TIGR02338,TIGR02389,TIGR03629,TIGR03670,TIGR03673,TIGR03722</span><br><span class=\"line\">genome<span class=\"built_in\">_</span>b.fna    118     2       0       2       PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01866.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,TIGR00021,TIGR00037,TIGR00042,TIGR00064,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00373,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00458,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00522,TIGR00549,TIGR00658,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02338,TIGR02389,TIGR02390,TIGR02651,TIGR03626,TIGR03628,TIGR03629,TIGR03636,TIGR03653,TIGR03665,TIGR03670,TIGR03671,TIGR03672,TIGR03673,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684,TIGR03722 PF01496.14,PF13685.1            TIGR01213,TIGR03627</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"Step-3-Aligning-genomes-align\"><a href=\"#Step-3-Aligning-genomes-align\" class=\"headerlink\" title=\"Step 3 Aligning genomes (align)\"></a>Step 3 Aligning genomes (align)</h2><p>该步骤将对齐所有已识别的标记，确定最可能的<ruby>域<rt>domain </rt></ruby>并输出串联的MSA。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk align --identify_dir /tmp/gtdbtk/identify --out_dir /tmp/gtdbtk/align --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>:::warning<br>要注意输出，如果一个基因组识别出的标记数量较少，那么在这一步，它将被排除在分析之外。如果出现这种情况，将出现警告。<br>:::</p>\n<p>根据domain的不同，<code>ar122</code>或<code>bac120</code>的前缀文件将出现，其中包含用户基因组和GTDB基因组的MSA，或仅包含用户基因组（<code>gtdbtk.ar122.MSA.fasta</code>和<code>gtdbtk.ar122.user_MSA.fasta</code>）。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/align</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">align/</span><br><span class=\"line\">gtdbtk.ar122.user<span class=\"built_in\">_</span>msa.fasta</span><br><span class=\"line\">identify/</span><br><span class=\"line\">gtdbtk.ar122.filtered.tsv</span><br><span class=\"line\">gtdbtk.log</span><br><span class=\"line\">gtdbtk.ar122.msa.fasta</span><br><span class=\"line\">gtdbtk.warnings.log</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"Step-4-基因组分类-classify\"><a href=\"#Step-4-基因组分类-classify\" class=\"headerlink\" title=\"Step 4 基因组分类 (classify)\"></a>Step 4 基因组分类 (classify)</h2><p>将用户的基因组放置于参考树上，然后决定其最为可能的分类。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtdbtk classify --genome_dir /tmp/gtdbtk/genomes --align_dir /tmp/gtdbtk/align --out_dir /tmp/gtdbtk/classify -x gz --cpus 20</span><br></pre></td></tr></table></figure>\n\n<p>+++success Results</p>\n<p>两个主要的输出文件包括<ruby>总结文件<rt>summary file</rt></ruby>和包含基因组的参考树 (<code>gtdbtk.ar122.summary.tsv</code>和<code>gtdbtk.ar122.classify.tree</code>)。基因组的分类信息呈现于总结文件中。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ls</span> /tmp/gtdbtk/classify</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classify/</span><br><span class=\"line\">gtdbtk.ar122.summary.tsv</span><br><span class=\"line\">gtdbtk.warnings.log</span><br><span class=\"line\">gtdbtk.ar122.classify.tree</span><br><span class=\"line\">gtdbtk.log</span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<h2 id=\"错误信息处理\"><a href=\"#错误信息处理\" class=\"headerlink\" title=\"错误信息处理\"></a>错误信息处理</h2><ul>\n<li><p>OpenBLAS blas_thread_init: pthread_create failed for thread 109 of 128: Resource temporarily unavailable</p>\n<ul>\n<li>解决方案：少调用一些线程就ok了。</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><ul>\n<li><a href=\"https://ecogenomics.github.io/GTDBTk\">GTBD-Tk Documentation</a></li>\n</ul>\n","categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"WGS","path":"api/tags/WGS.json"}]}