{"total":101,"pageSize":10,"pageCount":11,"data":[{"title":"使用DeepARG预测抗生素抗性基因ARGs","slug":"使用DeepARG预测抗生素抗性基因ARGs","date":"2022-01-07T11:50:33.000Z","updated":"2022-01-09T04:30:54.969Z","comments":true,"path":"api/articles/使用DeepARG预测抗生素抗性基因ARGs.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/92eb_1.png","content":"<h1 id=\"介绍\"><a class=\"markdownIt-Anchor\" href=\"#介绍\"></a> 介绍</h1>\n<p>DeepARG 是一种机器学习解决方案，它使用深度学习来表征和注释宏基因组中的抗生素抗性基因。它由两种输入模型组成：短序列 Reads 和 gene-like 序列。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/92eb_1.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/92eb_1.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"Automatic annotation of highly homologous ARGs\" /></p>\n<h1 id=\"安装软件\"><a class=\"markdownIt-Anchor\" href=\"#安装软件\"></a> 安装软件</h1>\n<ul>\n<li>\n<p>通过 <code>conda</code>  安装</p>\n  <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 创建环境</span>\nconda create -n deeparg_env <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">2.7</span>.18\nconda activate deeparg_env\n\n<span class=\"token comment\"># 安装diamond</span>\nconda <span class=\"token function\">install</span> -c bioconda <span class=\"token assign-left variable\">diamond</span><span class=\"token operator\">==</span><span class=\"token number\">0.9</span>.24\n\n<span class=\"token comment\"># 安装其他依赖</span>\nconda <span class=\"token function\">install</span> trimmomatic vsearch bedtools bowtie2 samtools\n\n<span class=\"token comment\"># 安装DeepARG</span>\npip <span class=\"token function\">install</span> <span class=\"token assign-left variable\">deeparg</span><span class=\"token operator\">==</span><span class=\"token number\">1.0</span>.2\n\n<span class=\"token comment\"># 下载数据库等， -o指定下载路径</span>\ndeeparg download_data -o tools/deeparg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>通过其他方法安装</p>\n<p>参考<a href=\"https://bitbucket.org/gusphdproj/deeparg-ss/src/master/\">官方文档</a>进行。</p>\n</li>\n</ul>\n<h1 id=\"使用软件\"><a class=\"markdownIt-Anchor\" href=\"#使用软件\"></a> 使用软件</h1>\n<h2 id=\"预测reads中的args\"><a class=\"markdownIt-Anchor\" href=\"#预测reads中的args\"></a> 预测 Reads 中的 ARGs</h2>\n<h3 id=\"输入文件\"><a class=\"markdownIt-Anchor\" href=\"#输入文件\"></a> 输入文件</h3>\n<p>双端 Reads。</p>\n<h3 id=\"命令\"><a class=\"markdownIt-Anchor\" href=\"#命令\"></a> 命令</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">deeparg short_reads_pipeline --forward_pe_file Reads/LD201221-0003_S20210104-0015_F01_clean.R1.fq.gz --reverse_pe_file Reads/LD201221-0003_S20210104-0015_F01_clean.R2.fq.gz --output_file F01.deeparg -d ~/tools/deeparg/<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"primary\"><summary>参数解析</summary><div>\n<p><code>-h, --help</code>             show this help message and exit<br />\n <code>--forward_pe_file</code>  <strong>FORWARD_PE_FILE</strong>:           forward mate from paired end library<br />\n <code>--reverse_pe_file</code>  <strong>REVERSE_PE_FILE</strong>:             reverse mate from paired end library<br />\n <code>--output_file</code>  <strong>OUTPUT_FILE</strong>:           save results to this file prefix<br />\n <code>-d</code>  <strong>DEEPARG_DATA_PATH</strong>:               Path where data was downloaded [see deeparg download-data --help for details]<br />\n <code>--deeparg_identity</code>  <strong>DEEPARG_IDENTITY</strong>:      minimum identity for ARG alignments [default 80]<br />\n <code>--deeparg_probability</code>  <strong>DEEPARG_PROBABILITY</strong>:      minimum probability for considering a reads as ARG-like [default 0.8]<br />\n <code>--deeparg_evalue</code>  <strong>DEEPARG_EVALUE</strong>:     minimum e-value for ARG alignments [default 1e-10]<br />\n <code>--gene_coverage</code>  <strong>GENE_COVERAGE</strong>:        minimum coverage required for considering a full gene in percentage. This parameter looks at the full gene and all hits that align to the gene. If the overlap of all hits is below the threshold the gene is discarded. Use with caution [default 1]</p>\n</div></details>\n<p><strong>批量运行</strong>：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">perl Run_deepARG_reads.pl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note info\">\n<p>脚本获取方式见文末</p>\n</div>\n<h2 id=\"预测fasta序列中的args\"><a class=\"markdownIt-Anchor\" href=\"#预测fasta序列中的args\"></a> 预测 FASTA 序列中的 ARGs</h2>\n<h3 id=\"输入文件-2\"><a class=\"markdownIt-Anchor\" href=\"#输入文件-2\"></a> 输入文件</h3>\n<p>可以是 <code>核苷酸序列</code> 或者是 <code>氨基酸序列</code> 。</p>\n<h3 id=\"命令-2\"><a class=\"markdownIt-Anchor\" href=\"#命令-2\"></a> 命令</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 1) Annotate gene-like sequences when the input is a nucleotide FASTA file:</span>\n    deeparg predict --model LS --type nucl --input /path/file.fasta --out /path/to/out/file.out\n\n<span class=\"token comment\"># 2) Annotate gene-like sequences when the input is an amino acid FASTA file:</span>\n    deeparg predict --model LS --type prot --input /path/file.fasta --out /path/to/out/file.out\n\n<span class=\"token comment\"># 3) Annotate short sequence reads when the input is a nucleotide FASTA file:</span>\n    deeparg predict --model SS --type nucl --input /path/file.fasta --out /path/to/out/file.out\n\n<span class=\"token comment\"># 4) Annotate short sequence reads when the input is a protein FASTA file (unusual case):</span>\n    deeparg predict --model SS --type prot --input /path/file.fasta --out /path/to/out/file.out<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<details class=\"primary\"><summary>参数解析</summary><div>\n<p>usage: deeparg predict<br />\n <code>-h, --help</code>             show this help message and exit<br />\n <code>--model</code>  <strong>MODEL</strong>:         Select model to use (short sequences for reads | long sequences for genes) SS|LS [No default]<br />\n <code>-i, --input-file</code>  <strong>INPUT_FILE</strong>:     Input file (Fasta input file)<br />\n <code>-o, --output-file</code>  <strong>OUTPUT_FILE</strong>:    Output file where to store results<br />\n <code>-d, --data-path</code>  <strong>DATA_PATH</strong>:       Path where data was downloaded [see deeparg download-data --help for details]<br />\n <code>--type</code>  <strong>TYPE</strong>:       Molecular data type prot/nucl [Default: nucl]<br />\n <code>--min-prob</code>  <strong>MIN_PROB</strong>:   Minimum probability cutoff [Default: 0.8]<br />\n <code>--arg-alignment-identity</code>  <strong>ARG_ALIGNMENT_IDENTITY</strong>:          Identity cutoff for sequence alignment [Default: 50]<br />\n <code>--arg-alignment-evalue</code>  <strong>ARG_ALIGNMENT_EVALUE</strong>:                  Evalue cutoff [Default: 1e-10]<br />\n <code>--arg-alignment-overlap</code>  <strong>ARG_ALIGNMENT_OVERLAP</strong>:                 Alignment read overlap [Default: 0.8]<br />\n <code>--arg-num-alignments-per-entry</code>  <strong>ARG_NUM_ALIGNMENTS_PER_ENTRY</strong>:    Diamond, minimum number of alignments per entry [Default: 1000]<br />\n <code>--model-version</code>  <strong>MODEL_VERSION</strong>:     Model deepARG version [Default: v2]</p>\n</div></details>\n<h2 id=\"输出\"><a class=\"markdownIt-Anchor\" href=\"#输出\"></a> 输出</h2>\n<ul>\n<li>\n<p>有官方说明的两个比对的结果文件</p>\n<ul>\n<li>\n<p><code>.ARG</code>  包含 probability &gt;= --prob (0.8 default) 的序列</p>\n</li>\n<li>\n<p><code>.potential.ARG</code>  包含 probability &lt;--prob (0.8 default) 的序列。 该文件中可能仍含有 ARG-like 序列，想用的话需要人工检查其序列。</p>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">* ARG_NAME\n* QUERY_START\n* QUERY_END\n* QUERY_ID\n* PREDICTED_ARG_CLASS\n* BEST_HIT_FROM_DATABASE\n* PREDICTION_PROBABILITY\n* ALIGNMENT_BESTHIT_IDENTITY (%)\n* ALIGNMENT_BESTHIT_LENGTH\n* ALIGNMENT_BESTHIT_BITSCORE\n* ALIGNMENT_BESTHIT_EVALUE\n* COUNTS<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>ARG.merged.quant.type</p>\n  <pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">#ARG-category\tReadCount\t16s-NormalizedReadCount<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>.ARG.merged.quant.subtype</p>\n  <pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">#ARG-group\tReadCount\t16s-NormalizedReadCount<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note info\">\n<p>上面俩文件官方未给出说明，按照我的理解，是将 <code>.ARG</code>  文件进行了进一步处理，生成了各 ARG 大类和小类的绝对数量（第二列）和相对含量（第三列）。</p>\n</div>\n</li>\n<li>\n<p>其他文件</p>\n<p>主要是一些中间过程文件，占用空间相当大，可以手动删除。</p>\n<h1 id=\"后续个性化分析\"><a class=\"markdownIt-Anchor\" href=\"#后续个性化分析\"></a> 后续个性化分析</h1>\n<h2 id=\"合并多个样本的arg大类形成相对丰度矩阵\"><a class=\"markdownIt-Anchor\" href=\"#合并多个样本的arg大类形成相对丰度矩阵\"></a> 合并多个样本的 ARG 大类形成相对丰度矩阵</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\">perl co_type<span class=\"token operator\">.</span>pl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note info\">\n<p>脚本获取方式见文末</p>\n</div>\n<h2 id=\"绘制气泡图\"><a class=\"markdownIt-Anchor\" href=\"#绘制气泡图\"></a> 绘制气泡图</h2>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\"><span class=\"token comment\">#!/usr/bin/env Rscript</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.09</span>\n<span class=\"token comment\"># Name: Bubble_plot.R</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#设置工作目录</span>\n\n<span class=\"token comment\">#pdf(file=\"FunctionsBubbleChart.pdf\", width=14, height=11)</span>\n\n<span class=\"token comment\"># 读取文件 sep 根据文件格式确定</span>\ndata <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"All.ARGs.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\n\ndata_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Sample\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ARGs\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">##data_melt$Sites=substring(data_melt$Samples,1,3)# 根据第二列的样本名称提取站位信息，用于后续着色</span>\n<span class=\"token comment\">##data_melt &lt;-as.data.frame(data_melt)</span>\n\n<span class=\"token comment\"># 做主图</span>\nbubble <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">[</span>which<span class=\"token punctuation\">(</span>data_melt<span class=\"token operator\">$</span>Abundances<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Sample<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> ARGs<span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> Sample<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> geom_point<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 字体修饰</span>\n<span class=\"token comment\">##windowsFonts(myFont = windowsFont(\"Times New Roman\"))</span>\n\n<span class=\"token comment\"># 修改细节 — 图注，点大小，点shape</span>\nbubble_style <span class=\"token operator\">&lt;-</span> bubble <span class=\"token operator\">+</span> theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n  labs<span class=\"token punctuation\">(</span>\n\tx <span class=\"token operator\">=</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span>\n\ty <span class=\"token operator\">=</span> <span class=\"token string\">\"ARGs\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token comment\">#color=\"Sites\", # 颜色图注名</span>\n\tsize<span class=\"token operator\">=</span><span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>    <span class=\"token comment\"># 大小图注名</span>\n\tscale_size<span class=\"token punctuation\">(</span>range <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>  <span class=\"token comment\">#等比修改圆圈大小</span>\n\ttheme<span class=\"token punctuation\">(</span>plot.title<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Times New Roman\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\t\tcolor<span class=\"token operator\">=</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span>face<span class=\"token operator\">=</span><span class=\"token string\">\"italic\"</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\t\thjust<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>lineheight<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\t\tplot.subtitle <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> \n\ttheme<span class=\"token punctuation\">(</span>axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> hjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#dev.off()</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n</ul>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://bench.cs.vt.edu/deeparg\">DeepARG 官网</a></li>\n<li><a href=\"https://bitbucket.org/gusphdproj/deeparg-ss/src/master/\">DeepARG Repository</a></li>\n</ul>\n<h1 id=\"代码获取\"><a class=\"markdownIt-Anchor\" href=\"#代码获取\"></a> 代码获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “92eb” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"ARGs","path":"api/tags/ARGs.json"}]},{"title":"计算蛋白质等电点并绘制全局pI图","slug":"计算蛋白质等电点","date":"2022-01-03T02:49:17.000Z","updated":"2022-01-08T02:16:28.468Z","comments":true,"path":"api/articles/计算蛋白质等电点.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png","content":"<h1 id=\"蛋白质组的全局-pis\"><a class=\"markdownIt-Anchor\" href=\"#蛋白质组的全局-pis\"></a> 蛋白质组的全局 pIs</h1>\n<p>细胞全局蛋白质组 pI 图的变化取决于氨基酸的总电荷，并对蛋白质的结构和特性具有重要意义。</p>\n<p>普遍认为原核基因组具有两个最大的双峰形状，一个在酸性 pH 值下主要对应于溶解的蛋白质（细胞质蛋白或分泌蛋白），另一种在膜蛋白的碱性 pH 值下，具有细胞内碱性（带正电荷）结构域以促进质子动力的产生。在这两个峰之间，有一个最小的中性值，对应于细胞内的 pH 值（如下图）。</p>\n<p>蛋白质氨基酸组成和 pI 水平的显着变化提供了一种工具来预测培养物或宏基因组组装基因组 (MAG) 的首选栖息地。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_1.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"蛋白质组的全局 pIs\" /><br />\n<a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n<h1 id=\"安装emboss\"><a class=\"markdownIt-Anchor\" href=\"#安装emboss\"></a> 安装 EMBOSS</h1>\n<ul>\n<li>下载</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span>  ftp://emboss.open-bio.org/pub/EMBOSS/emboss-latest.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 解压</span>\n<span class=\"token function\">tar</span> zxvf emboss-latest.tar.gz\n\n<span class=\"token comment\"># 防止报错 (error while loading shared libraries: libnucleus.so.6)</span>\n<span class=\"token function\">sudo</span> /sbin/ldconfig\n\n<span class=\"token comment\"># 配置、编译与安装</span>\n<span class=\"token builtin class-name\">cd</span> emboss-latest\n./configure\n<span class=\"token function\">make</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"输入文件\"><a class=\"markdownIt-Anchor\" href=\"#输入文件\"></a> 输入文件</h1>\n<p>输入文件为含有一条或多条氨基酸序列的 FASTA 格式文件。</p>\n<h1 id=\"ruby计算氨基酸序列的各特征数据rtcalculate-statistics-of-protein-propertiesrtruby\"><a class=\"markdownIt-Anchor\" href=\"#ruby计算氨基酸序列的各特征数据rtcalculate-statistics-of-protein-propertiesrtruby\"></a> <ruby>计算氨基酸序列的各特征数据<rt>Calculate statistics of protein properties</rt></ruby></h1>\n<h2 id=\"逐个文件计算\"><a class=\"markdownIt-Anchor\" href=\"#逐个文件计算\"></a> 逐个文件计算</h2>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pepstats -sequence F01_bin.1.faa -outfile F01_bin.1.out<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note primary 参数解析\">\n<ul>\n<li>\n<p>Standard (Mandatory) qualifiers:</p>\n<ul>\n<li>[-sequence]          seqall     Protein sequence(s) filename and optional<br />\nformat, or reference (input USA)</li>\n<li>[-outfile]           outfile    [*.pepstats] Pepstats program output file</li>\n</ul>\n</li>\n<li>\n<p>Advanced (Unprompted) qualifiers:</p>\n<ul>\n<li>-aadata             datafile   [Eamino.dat] Amino acid properties</li>\n<li>-mwdata             datafile   [Emolwt.dat] Molecular weight data for amino<br />\nacids</li>\n<li>-pkdata             datafile   [Epk.dat] Values of pKa for amino acids</li>\n<li>-[no]termini        boolean    [Y] Include charge at N and C terminus</li>\n<li>-mono               boolean    [N] Use monoisotopic weights</li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"批量计算与pi提取并输出为相对丰度\"><a class=\"markdownIt-Anchor\" href=\"#批量计算与pi提取并输出为相对丰度\"></a> 批量计算与 pI 提取并输出为相对丰度</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># name: print_pI.pl</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.03</span>\n\n<span class=\"token keyword\">my</span> <span class=\"token variable\">@genome</span> <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"*.faa\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span><span class=\"token variable\">@genome</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$_</span><span class=\"token operator\">=~</span><span class=\"token regex\">/(\\S+).faa/</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$out</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">.</span> <span class=\"token string\">\".pepstats\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$pi</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">.</span> <span class=\"token string\">\".pI\"</span><span class=\"token punctuation\">;</span>\n\tsystem<span class=\"token punctuation\">(</span><span class=\"token string\">\"pepstats -sequence $_ -outfile $out\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">%hash</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$seqnum</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\topen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$out\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tchomp<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token regex\">/^(Isoelectric Point = )(\\S+)/</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$pi</span> <span class=\"token operator\">=</span> sprintf <span class=\"token string\">\"%.1f\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$2</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$pi</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$seqnum</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose IN<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">#my @records = values %hash;</span>\n\t<span class=\"token comment\">#my $seqnum = @records;</span>\n\t<span class=\"token comment\">#print $seqnum . \"\\n\";</span>\n\topen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">$pi\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"Isoelectric point\\tRelative frequency\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span>keys <span class=\"token variable\">%hash</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$frequency</span> <span class=\"token operator\">=</span> sprintf <span class=\"token string\">\"%.2f\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">/</span><span class=\"token variable\">$seqnum</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#@records;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$_\\t$frequency\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose OUT<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"选择性忽略-这是我自己用的\"><a class=\"markdownIt-Anchor\" href=\"#选择性忽略-这是我自己用的\"></a> 选择性忽略 （这是我自己用的）</h2>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># name: co_sample_pI.pl</span>\n<span class=\"token comment\"># Author: Liu Hualin</span>\n<span class=\"token comment\"># Date: 2022.01.03</span>\n\nopen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">F06.pi\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"MAGs\\tIsoelectric point\\tRelative frequency\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">@pI</span> <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"F06*.pI\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span>  <span class=\"token punctuation\">(</span><span class=\"token variable\">@pI</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$_</span><span class=\"token operator\">=~</span><span class=\"token regex\">/(\\S+).pI/</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">my</span> <span class=\"token variable\">$mag</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span><span class=\"token punctuation\">;</span>\n\topen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$_\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tchomp<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$mag\\t$_\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\tclose IN<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose OUT<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"可视化\"><a class=\"markdownIt-Anchor\" href=\"#可视化\"></a> 可视化</h1>\n<h2 id=\"绘制蛋白质组的全局-pis图\"><a class=\"markdownIt-Anchor\" href=\"#绘制蛋白质组的全局-pis图\"></a> 绘制蛋白质组的全局 pIs 图</h2>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\"><span class=\"token comment\"># Step 1 读入数据</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/Results/Annotations/AAs\"</span><span class=\"token punctuation\">)</span>\n\nF1 <span class=\"token operator\">&lt;-</span>read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"F01_bin.1.pI\"</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Step 2 绘图，以下5选1</span>\n<span class=\"token comment\">## 单组加点，运行完后跳到Step 3</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_point<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>shape<span class=\"token operator\">=</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## 单组无点，运行完后跳到Step 3</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">## 多组加点</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_point<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>shape<span class=\"token operator\">=</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">## 多组无点显示置信区间</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## 多组无点去除置信区间</span>\np1 <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Isoelectric.point<span class=\"token punctuation\">,</span> Relative.frequency<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>MAGs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>geom_smooth<span class=\"token punctuation\">(</span>method<span class=\"token operator\">=</span> <span class=\"token string\">\"gam\"</span><span class=\"token punctuation\">,</span>se <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># Step 3 美化，看下图</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## ==============以下代码为自用========================</span>\n<span class=\"token comment\">## F04自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## F05自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## F06自定义颜色</span>\np1 <span class=\"token operator\">+</span> scale_x_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_y_continuous<span class=\"token punctuation\">(</span>limits<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>max<span class=\"token punctuation\">(</span>F1<span class=\"token operator\">$</span>Relative.frequency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span> <span class=\"token string\">\"Isoelectric point\"</span><span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> <span class=\"token string\">\"Relative frequency\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> scale_color_manual<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"MAGs\"</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#ff7f0e\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#d62728\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#8c564b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#f7b6d2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#5254a3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#000000\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/85d7_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"蛋白质组的全局 pIs\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li>\n<p><a href=\"https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-019-0731-5#Abs1\">Pedro J. et al., 2019, Microbiome</a></p>\n</li>\n<li>\n<p><a href=\"http://emboss.sourceforge.net/\">EMBOSS</a></p>\n</li>\n</ul>\n<h1 id=\"代码获取\"><a class=\"markdownIt-Anchor\" href=\"#代码获取\"></a> 代码获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “85d7” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"WGS","path":"api/tags/WGS.json"},{"name":"蛋白质组","path":"api/tags/蛋白质组.json"}]},{"title":"利用GTDB-TK对细菌和古菌基因组进行物种分类","slug":"利用GTDB-TK对细菌和古菌基因组进行物种分类","date":"2021-12-10T03:14:45.000Z","updated":"2022-01-08T02:16:28.432Z","comments":true,"path":"api/articles/利用GTDB-TK对细菌和古菌基因组进行物种分类.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>GTDB-Tk 是一个软件工具包，用于根据<ruby>基因组数据库分类 GTDB<rt>Genome Database Taxonomy GTDB</rt></ruby> 为细菌和古菌基因组<ruby>分配客观分类学分类<rt>assigning objective taxonomic classifications</rt></ruby>。可以用于宏基因组组装基因组 (MAG)、单菌基因组和单细胞基因组。</p>\n<h1 id=\"安装gtdb-tk\"><a class=\"markdownIt-Anchor\" href=\"#安装gtdb-tk\"></a> 安装 GTDB-Tk</h1>\n<ul>\n<li>\n<p>通过 conda 安装主程序</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># latest version</span>\nconda create -n gtdbtk -c conda-forge -c bioconda gtdbtk\n\n<span class=\"token comment\"># specific version (replace 1.7.0 with the version you wish to install, recommended)</span>\nconda create -n gtdbtk -c conda-forge -c bioconda <span class=\"token assign-left variable\">gtdbtk</span><span class=\"token operator\">=</span><span class=\"token number\">1.7</span>.0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>下载 GTDB-Tk 数据库 (~47 G)</p>\n<p>最新版本的数据库为 R202，需要 &gt;=1.5.0 版本的 GTDB-Tk。</p>\n<ul>\n<li>\n<p>自动 (非常慢)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">download-db.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>手动</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"> \t<span class=\"token comment\"># 找到下载脚本的路径并打开，从中找到数据库的链接</span>\n<span class=\"token function\">which</span> download-db.sh\n  \n<span class=\"token comment\"># 进入数据库默认路径</span>\n<span class=\"token builtin class-name\">cd</span> ~/miniconda3/envs/gtdbtk/share/gtdbtk-1.7.0/db/\n\t  \n   <span class=\"token comment\"># 用wget下载 (非常慢)，推荐在Windows下用其他软件下载，再上传服务器</span>\n<span class=\"token function\">nohup</span> <span class=\"token function\">wget</span> -c https://data.gtdb.ecogenomic.org/releases/release202/202.0/auxillary_files/gtdbtk_r202_data.tar.gz --no-check-certificate <span class=\"token operator\">&amp;</span>\n\n<span class=\"token function\">tar</span> zxvf gtdbtk_r202_data.tar.gz\n\n<span class=\"token function\">mv</span> release202/* ./<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"运行软件\"><a class=\"markdownIt-Anchor\" href=\"#运行软件\"></a> 运行软件</h1>\n<h2 id=\"classify_wf\"><a class=\"markdownIt-Anchor\" href=\"#classify_wf\"></a> classify_wf</h2>\n<div class=\"note default\">\n<p>可以通过 <code>classify_wf</code>  命令完成整个工作流程。</p>\n</div>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">gtdbtk classify_wf --genome_dir <span class=\"token operator\">&lt;</span>my_genomes<span class=\"token operator\">></span> --out_dir <span class=\"token operator\">&lt;</span>output_dir<span class=\"token operator\">></span> --extension fna --cpus <span class=\"token number\">20</span> --force<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"primary\"><summary>参数解析</summary><div>\n<ul>\n<li>\n<p>--genome_dir<br />\ndirectory containing genome files in FASTA format</p>\n</li>\n<li>\n<p>--batchfile<br />\npath to file describing genomes - tab separated in 2 or 3 columns (FASTA file, genome ID, translation table [optional])</p>\n</li>\n<li>\n<p>--out_dir<br />\ndirectory to output files</p>\n</li>\n<li>\n<p>-x, --extension<br />\nextension of files to process, gz = gzipped (Default: fna)</p>\n</li>\n<li>\n<p>--min_perc_aa<br />\nexclude genomes that do not have at least this percentage of AA in the MSA (inclusive bound) (Default: 10)</p>\n</li>\n<li>\n<p>--prefix<br />\nprefix for all output files (Default: gtdbtk)</p>\n</li>\n<li>\n<p>--cpus<br />\nnumber of CPUs to use (Default: 1)</p>\n</li>\n<li>\n<p>--pplacer_cpus<br />\nuse pplacer_cpus during placement (default: cpus)</p>\n</li>\n<li>\n<p>--force<br />\ncontinue processing if an error occurs on a single genome</p>\n</li>\n<li>\n<p>--scratch_dir<br />\nReduce pplacer memory usage by writing to disk (slower).</p>\n</li>\n<li>\n<p>--min_af<br />\nminimum alignment fraction to consider closest genome (Default: 0.65)</p>\n</li>\n<li>\n<p>--tmpdir<br />\nspecify alternative directory for temporary files （Default: /tmp</p>\n</li>\n<li>\n<p>--debug<br />\ncreate intermediate files for debugging purposes</p>\n</li>\n</ul>\n</div></details>\n<div class=\"note default\">\n<p>但下面我们演示分步运行。在处理大型管道时，单独运行这些步骤有时会很有用。</p>\n</div>\n<h2 id=\"step-1-准备输入文件\"><a class=\"markdownIt-Anchor\" href=\"#step-1-准备输入文件\"></a> Step 1 准备输入文件</h2>\n<p>以下两个基因组作为示例文件：* Genome A:  <code>GCF_003947435.1</code>  [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> / <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCF_003947435.1/\">NCBI</a>] * Genome B:  <code>GCA_002011125.1</code>  [<a href=\"https://gtdb.ecogenomic.org/genomes?gid=GCA_002011125.1\">GTDB</a> / <a href=\"https://www.ncbi.nlm.nih.gov/assembly/GCA_002011125.1/\">NCBI</a>]。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># Create the directory.</span>\n<span class=\"token function\">mkdir</span> -p /tmp/gtdbtk <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> /tmp/gtdbtk\n\n<span class=\"token comment\"># Obtain the genomes.</span>\n<span class=\"token function\">mkdir</span> -p /tmp/gtdbtk/genomes\n<span class=\"token function\">wget</span> -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/003/947/435/GCF_003947435.1_ASM394743v1/GCF_003947435.1_ASM394743v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_a.fna.gz\n\n<span class=\"token function\">wget</span> -q https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/002/011/125/GCA_002011125.1_ASM201112v1/GCA_002011125.1_ASM201112v1_genomic.fna.gz -O /tmp/gtdbtk/genomes/genome_b.fna.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"step-2-gene-calling-identify\"><a class=\"markdownIt-Anchor\" href=\"#step-2-gene-calling-identify\"></a> Step 2 Gene calling (identify)</h2>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">gtdbtk identify --genome_dir /tmp/gtdbtk/genomes --out_dir /tmp/gtdbtk/identify --extension gz --cpus <span class=\"token number\">20</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"success\"><summary>Results</summary><div>\n<p>获得的基因和<ruby>标记<rt>marker</rt></ruby>信息可以在每个<ruby>基因组反应中间文件目录<rt>genomes respeective intermediate files directory</rt></ruby>下找到，如下所示。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">ls</span> /tmp/gtdbtk/identify/identify/intermediate_results/marker_genes/genome_a.fna/<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">genome_a.fna_pfam_tophit.tsv\ngenome_a.fna_protein.gff.sha256\ngenome_a.fna_pfam_tophit.tsv.sha256\ngenome_a.fna_tigrfam.out\ngenome_a.fna_pfam.tsv\ngenome_a.fna_tigrfam.out.sha256\ngenome_a.fna_pfam.tsv.sha256\ngenome_a.fna_tigrfam_tophit.tsv\ngenome_a.fna_protein.faa\ngenome_a.fna_tigrfam_tophit.tsv.sha256\ngenome_a.fna_protein.faa.sha256\ngenome_a.fna_tigrfam.tsv\ngenome_a.fna_protein.fna\ngenome_a.fna_tigrfam.tsv.sha256\ngenome_a.fna_protein.fna.sha256\nprodigal_translation_table.tsv\ngenome_a.fna_protein.gff\nprodigal_translation_table.tsv.sha256<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"note default\">\n<p>大部分情况下只需要读取摘要文件，其中详细说明了从 archaeal 122 或 bacterial 120<ruby>标记集<rt>marker set</rt></ruby>识别的标记。</p>\n</div>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> /tmp/gtdbtk/identify/gtdbtk.ar122.markers_summary.tsv<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">name    number_unique_genes     number_multiple_genes   number_multiple_unique_genes    number_missing_genes    list_unique_genes       list_multiple_genes     list_multiple_unique_genes      list_missing_genes\ngenome_a.fna    109     3       0       10      PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,PF13685.1,TIGR00021,TIGR00037,TIGR00042,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00549,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01213,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02390,TIGR02651,TIGR03626,TIGR03627,TIGR03628,TIGR03636,TIGR03653,TIGR03665,TIGR03671,TIGR03672,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684    PF01496.14,TIGR00458,TIGR00658          PF01866.12,TIGR00064,TIGR00373,TIGR00522,TIGR02338,TIGR02389,TIGR03629,TIGR03670,TIGR03673,TIGR03722\ngenome_b.fna    118     2       0       2       PF00368.13,PF00410.14,PF00466.15,PF00687.16,PF00827.12,PF00900.15,PF01000.21,PF01015.13,PF01090.14,PF01092.14,PF01157.13,PF01191.14,PF01194.12,PF01198.14,PF01200.13,PF01269.12,PF01280.15,PF01282.14,PF01655.13,PF01798.13,PF01864.12,PF01866.12,PF01868.11,PF01984.15,PF01990.12,PF02006.11,PF02978.14,PF03874.11,PF04019.7,PF04104.9,PF04919.7,PF07541.7,PF13656.1,TIGR00021,TIGR00037,TIGR00042,TIGR00064,TIGR00111,TIGR00134,TIGR00240,TIGR00264,TIGR00270,TIGR00279,TIGR00283,TIGR00291,TIGR00293,TIGR00307,TIGR00308,TIGR00323,TIGR00324,TIGR00335,TIGR00336,TIGR00337,TIGR00373,TIGR00389,TIGR00392,TIGR00398,TIGR00405,TIGR00408,TIGR00422,TIGR00425,TIGR00432,TIGR00442,TIGR00448,TIGR00456,TIGR00458,TIGR00463,TIGR00468,TIGR00471,TIGR00490,TIGR00491,TIGR00501,TIGR00521,TIGR00522,TIGR00549,TIGR00658,TIGR00670,TIGR00729,TIGR00936,TIGR00982,TIGR01008,TIGR01012,TIGR01018,TIGR01020,TIGR01025,TIGR01028,TIGR01038,TIGR01046,TIGR01052,TIGR01060,TIGR01077,TIGR01080,TIGR01309,TIGR01952,TIGR02076,TIGR02153,TIGR02236,TIGR02258,TIGR02338,TIGR02389,TIGR02390,TIGR02651,TIGR03626,TIGR03628,TIGR03629,TIGR03636,TIGR03653,TIGR03665,TIGR03670,TIGR03671,TIGR03672,TIGR03673,TIGR03674,TIGR03677,TIGR03680,TIGR03683,TIGR03684,TIGR03722 PF01496.14,PF13685.1            TIGR01213,TIGR03627<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n</div></details>\n<h2 id=\"step-3-aligning-genomes-align\"><a class=\"markdownIt-Anchor\" href=\"#step-3-aligning-genomes-align\"></a> Step 3 Aligning genomes (align)</h2>\n<p>该步骤将对齐所有已识别的标记，确定最可能的<ruby>域<rt>domain </rt></ruby>并输出串联的 MSA。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">gtdbtk align --identify_dir /tmp/gtdbtk/identify --out_dir /tmp/gtdbtk/align --cpus <span class=\"token number\">20</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"success\"><summary>Results</summary><div>\n<div class=\"note warning\">\n<p>要注意输出，如果一个基因组识别出的标记数量较少，那么在这一步，它将被排除在分析之外。如果出现这种情况，将出现警告。</p>\n</div>\n<p>根据 domain 的不同， <code>ar122</code>  或 <code>bac120</code>  的前缀文件将出现，其中包含用户基因组和 GTDB 基因组的 MSA，或仅包含用户基因组（ <code>gtdbtk.ar122.MSA.fasta</code>  和 <code>gtdbtk.ar122.user_MSA.fasta</code> ）。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">ls</span> /tmp/gtdbtk/align<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">align&#x2F;\ngtdbtk.ar122.user_msa.fasta\nidentify&#x2F;\ngtdbtk.ar122.filtered.tsv\ngtdbtk.log\ngtdbtk.ar122.msa.fasta\ngtdbtk.warnings.log<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</div></details>\n<h2 id=\"step-4-基因组分类-classify\"><a class=\"markdownIt-Anchor\" href=\"#step-4-基因组分类-classify\"></a> Step 4 基因组分类 (classify)</h2>\n<p>将用户的基因组放置于参考树上，然后决定其最为可能的分类。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">gtdbtk classify --genome_dir /tmp/gtdbtk/genomes --align_dir /tmp/gtdbtk/align --out_dir /tmp/gtdbtk/classify -x gz --cpus <span class=\"token number\">20</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"success\"><summary>Results</summary><div>\n<p>两个主要的输出文件包括<ruby>总结文件<rt>summary file</rt></ruby>和包含基因组的参考树 ( <code>gtdbtk.ar122.summary.tsv</code>  和 <code>gtdbtk.ar122.classify.tree</code> )。基因组的分类信息呈现于总结文件中。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">ls</span> /tmp/gtdbtk/classify<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">classify&#x2F;\ngtdbtk.ar122.summary.tsv\ngtdbtk.warnings.log\ngtdbtk.ar122.classify.tree\ngtdbtk.log<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</div></details>\n<h2 id=\"错误信息处理\"><a class=\"markdownIt-Anchor\" href=\"#错误信息处理\"></a> 错误信息处理</h2>\n<ul>\n<li>\n<p>OpenBLAS blas_thread_init: pthread_create failed for thread 109 of 128: Resource temporarily unavailable</p>\n<ul>\n<li>解决方案：少调用一些线程就 ok 了。</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://ecogenomics.github.io/GTDBTk\">GTBD-Tk Documentation</a></li>\n</ul>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"WGS","path":"api/tags/WGS.json"}]},{"title":"宏病毒组分析流程1-VirSorter2","slug":"宏病毒组分析流程1-VirSorter2","date":"2021-12-02T01:35:30.000Z","updated":"2022-01-09T14:10:51.664Z","comments":true,"path":"api/articles/宏病毒组分析流程1-VirSorter2.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","content":"<h1 id=\"安装软件\"><a class=\"markdownIt-Anchor\" href=\"#安装软件\"></a> 安装软件</h1>\n<ul>\n<li>\n<p>安装主程序及依赖</p>\n<div class=\"note default\">\n<ul>\n<li><a href=\"https://bitbucket.org/MAVERICLab/virsorter2/src/master\">VirSorter2</a> (version &gt;=2.2.3)</li>\n<li><a href=\"https://bitbucket.org/berkeleylab/checkv/src/master\">CheckV</a> (version &gt;=0.7.0)</li>\n<li><a href=\"https://github.com/shafferm/DRAM\">DRAMv</a> (version &gt;=1.2.0)</li>\n</ul>\n</div>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda create -n virome <span class=\"token assign-left variable\">virsorter</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> checkv dram\nconda activate virome<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>下载数据库</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># vs2 db: db-vs2 ~ 10 min</span>\nvirsorter setup -d /new_data/hualin/db/db-vs2 -j <span class=\"token number\">50</span>\n\n<span class=\"token comment\"># checkv db: checkv-db-v1.0  &lt; 5 mins</span>\ncheckv download_database /new_data/hualin/db/checkv\n\n<span class=\"token comment\"># DRAMv: db-dramv ~5h and ~60GB of memory</span>\nDRAM-setup.py prepare_databases --skip_uniref --output_dir db-dramv<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n</ul>\n<h1 id=\"预测\"><a class=\"markdownIt-Anchor\" href=\"#预测\"></a> 预测</h1>\n<ul>\n<li>\n<p>获取测试数据</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> -O test.fa https://bitbucket.org/MAVERICLab/virsorter2/raw/15a21fa9c1ee1d2af52b0148b167292e549d356e/test/test-for-sop.fa<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>运行 VirSorter2</p>\n<details class=\"info\"><summary>命令解析</summary><div>\n<ul>\n<li>首先以 0.5 的 score 阈值运行 VirSorter2 以保证最大的灵敏度。</li>\n<li>只关注噬菌体 (dsDNA and ssDNA phage)，可选 dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae。</li>\n<li>序列最小长度为 5000 bp，后续病毒分类的最低要求如此。</li>\n<li>可根据自己的 CPU 核心数自行调整 &quot;-j&quot;。</li>\n<li>&quot;--keep-original-seq&quot; 保留了环状和接近完整的病毒 contigs (score&gt;0.8 as a whole sequence)，后续将通过 checkV 修剪其尾端的潜在宿主基因并处理重复的环状 contigs 片段。</li>\n</ul>\n</div></details>\n<div class=\"note default\">\n<p>Time: 31m7.310s with a real dataset of 90.52 MB and 207,544 sequences</p>\n</div>\n  <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">virsorter run --keep-original-seq -w vs2-pass1 -i test.fa --include-groups dsDNAphage,ssDNA --min-length <span class=\"token number\">5000</span>  --min-score <span class=\"token number\">0.5</span> -j <span class=\"token number\">50</span> all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"primary\"><summary>参数解析</summary><div>\n<p>-w 指定输出目录<br />\n - i 指定输入序列<br />\n --min-length 过滤短序列<br />\n --min-score 分数阈值<br />\n --keep-original-seq 保留环状和接近完整的病毒 contigs<br />\n--include-groups 指定包含的病毒类型，用 “,” 分隔。可选：dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae<br />\n-j 线程数<br />\n all 直接写上就可以</p>\n</div></details>\n<details class=\"success\"><summary>结果解析</summary><div>\n<ul>\n<li>\n<p>final-viral-combined.fa: 病毒序列</p>\n<ul>\n<li>鉴定为病毒的完整序列（标识为后缀 ||full）；</li>\n<li>鉴定为病毒的部分序列（用后缀 ||{i}_partial 标识）； {i} 可以是从 0 到该 Contig 中发现的最大病毒片段数的数字；</li>\n<li>带有<ruby>标志基因<rt>hallmark gene</rt></ruby>的短序列（少于两个基因）被鉴定为病毒（用后缀 ||lt2gene 标识）；</li>\n</ul>\n</li>\n<li>\n<p>final-viral-score.tsv: 每个病毒序列的评分跨组和一些关键特征，这可以用于进一步过滤</p>\n<ul>\n<li>sequence name</li>\n<li>score of each viral sequences across groups (多列)</li>\n<li>max score across groups</li>\n<li>max score group</li>\n<li>contig length</li>\n<li>hallmark gene count</li>\n<li>viral gene %</li>\n<li>nonviral gene %</li>\n</ul>\n</li>\n</ul>\n  <div style=\"width:100%;overflow:scroll;\">\n  \t<table border=\"1\" rules=\"all\" style=\"width:2000px; height:100px; text-align:center\">\n  \t    <tr>\n  \t\t<td>seqname</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>NCLDV</td>\n  \t\t<td>RNA</td>\n  \t\t<td>ssDNA</td>\n  \t\t<td>lavidaviridae</td>\n  \t\t<td>max_score</td>\n  \t\t<td>max_score_group</td>\n  \t\t<td>length</td>\n  \t\t<td>hallmark</td>\n  \t\t<td>viral</td>\n  \t\t<td>cellular</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_5_length_17317_cov_8.385876&#124;&#124;full</td>\n  \t\t<td>0.993</td>\n  \t\t<td>0.847</td>\n  \t\t<td>0.005</td>\n  \t\t<td>0.060</td>\n  \t\t<td>0.467</td>\n  \t\t<td>0.993</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>17315</td>\n  \t\t<td>2</td>\n  \t\t<td>64.700</td>\n  \t\t<td>5.900</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_6_length_16611_cov_115.615064&#124;&#124;full</td>\n  \t\t<td>0.920</td>\n  \t\t<td>0.207</td>\n  \t\t<td>0.035</td>\n  \t\t<td>0.087</td>\n  \t\t<td>0.053</td>\n  \t\t<td>0.920</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>16610</td>\n  \t\t<td>0</td>\n  \t\t<td>3.200</td>\n  \t\t<td>0.000</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_8_length_14848_cov_778.417157&#124;&#124;full</td>\n  \t\t<td>1.000</td>\n  \t\t<td>0.220</td>\n  \t\t<td>0.105</td>\n  \t\t<td>0.380</td>\n  \t\t<td>0.627</td>\n  \t\t<td>1.000</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>14848</td>\n  \t\t<td>15</td>\n  \t\t<td>100.000</td>\n  \t\t<td>0.000</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_16_length_12563_cov_14.331948&#124;&#124;full</td>\n  \t\t<td>0.973</td>\n  \t\t<td>0.200</td>\n  \t\t<td>0.165</td>\n  \t\t<td>0.273</td>\n  \t\t<td>0.227</td>\n  \t\t<td>0.973</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>12083</td>\n  \t\t<td>0</td>\n  \t\t<td>8.000</td>\n  \t\t<td>0.000</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_17_length_11885_cov_350.043956&#124;&#124;full</td>\n  \t\t<td>0.653</td>\n  \t\t<td>0.513</td>\n  \t\t<td>0.050</td>\n  \t\t<td>0.080</td>\n  \t\t<td>0.047</td>\n  \t\t<td>0.653</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>11885</td>\n  \t\t<td>0</td>\n  \t\t<td>9.100</td>\n  \t\t<td>0.000</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_21_length_11527_cov_216.405073&#124;&#124;full</td>\n  \t\t<td>0.620</td>\n  \t\t<td>0.407</td>\n  \t\t<td>0.000</td>\n  \t\t<td>0.013</td>\n  \t\t<td>0.060</td>\n  \t\t<td>0.620</td>\n  \t\t<td>dsDNAphage</td>\n  \t\t<td>11526</td>\n  \t\t<td>0</td>\n  \t\t<td>10.500</td>\n  \t\t<td>5.300</td>\n  \t    </tr>\n  \t    <tr>\n  \t\t<td>NODE_23_length_11316_cov_8.144303&#124;&#124;full</td>\n  \t\t<td>0.367</td>\n  \t\t<td>0.540</td>\n  \t\t<td>0.010</td>\n  \t\t<td>0.000</td>\n  \t\t<td>0.400</td>\n  \t\t<td>0.540</td>\n  \t\t<td>NCLDV</td>\n  \t\t<td>11313</td>\n  \t\t<td>1</td>\n  \t\t<td>23.100</td>\n  \t\t<td>7.700</td>\n  \t    </tr>\n  \t</table>\n  </div>\n<div class=\"note warning\">\n<p>不同病毒类群的分类器并非相互排斥，它们的<ruby>目标病毒序列空间<rt>target viral sequence space</rt></ruby>可能存在重叠，这意味着该信息不应被使用或当作<ruby>可靠的分类<rt>reliable taxonomic classification</rt></ruby>。VirSorter2 的用途仅限于病毒鉴定。</p>\n</div>\n<ul>\n<li>\n<p>final-viral-boundary.tsv: 带有边界信息的表 (与其他两个文件相比，可能有额外的记录，应该忽略)。</p>\n<p>only some of the columns in this file might be useful:</p>\n<ul>\n<li>seqname: original sequence name</li>\n<li>trim_orf_index_start, trim_orf_index_end: start and end ORF index on orignal sequence of identified viral sequence</li>\n<li>trim_bp_start, trim_bp_end: start and end position on orignal sequence of identified viral sequence</li>\n<li>trim_pr: score of final trimmed viral sequence</li>\n<li>partial: full sequence as viral or partial sequence as viral; this is defined when a full sequence has score &gt; score cutoff, it is full (0), or else any viral sequence extracted within it is partial (1)</li>\n<li>pr_full: score of the original sequence</li>\n<li>hallmark_cnt: hallmark gene count</li>\n<li>group: the classifier of viral group that gives high score; this should NOT be used as reliable classification</li>\n</ul>\n</li>\n</ul>\n  <div style=\"width:100%;overflow:scroll;\">\n  \t<table border=\"1\" rules=\"all\" style=\"width:2000px; height:100px; text-align:center\">\n  \t    <tr>\n  \t<td>seqname</td>\n  \t<td>trim_orf_index_start</td>\n  \t<td>trim_orf_index_end</td>\n  \t<td>trim_bp_start</td>\n  \t<td>trim_bp_end</td>\n  \t<td>trim_pr</td>\n  \t<td>trim_pr_max</td>\n  \t<td>prox_orf_index_start</td>\n  \t<td>prox_orf_index_end</td>\n  \t<td>prox_bp_start</td>\n  \t<td>prox_bp_end</td>\n  \t<td>prox_pr</td>\n  \t<td>prox_pr_max</td>\n  \t<td>partial</td>\n  \t<td>full_orf_index_start</td>\n  \t<td>full_orf_index_end</td>\n  \t<td>full_bp_start</td>\n  \t<td>full_bp_end</td>\n  \t<td>pr_full</td>\n  \t<td>arc</td>\n  \t<td>bac</td>\n  \t<td>euk</td>\n  \t<td>vir</td>\n  \t<td>mix</td>\n  \t<td>unaligned</td>\n  \t<td>hallmark_cnt</td>\n  \t<td>group</td>\n  \t<td>shape</td>\n  \t<td>seqname_new</td>\n  \t    </tr>\n  \t    <tr>\n  \t<td>NODE_999_length_4026_cov_7.610929</td>\n  \t<td>1</td>\n  \t<td>12</td>\n  \t<td>1</td>\n  \t<td>4025</td>\n  \t<td>0.547</td>\n  \t<td>0.547</td>\n  \t<td>1</td>\n  \t<td>12</td>\n  \t<td>1</td>\n  \t<td>4025</td>\n  \t<td>nan</td>\n  \t<td>nan</td>\n  \t<td>0</td>\n  \t<td>1</td>\n  \t<td>12</td>\n  \t<td>1</td>\n  \t<td>4025</td>\n  \t<td>0.547</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>100.0</td>\n  \t<td>0</td>\n  \t<td>dsDNAphage</td>\n  \t<td>linear</td>\n  \t<td>NODE_999_length_4026_cov_7.610929||full</td>\n  \t    </tr>\n  \t    <tr>\n  \t<td>NODE_9999_length_1276_cov_11.598690</td>\n  \t<td>1</td>\n  \t<td>3</td>\n  \t<td>3</td>\n  \t<td>1274</td>\n  \t<td>0.955</td>\n  \t<td>0.955</td>\n  \t<td>1</td>\n  \t<td>3</td>\n  \t<td>3</td>\n  \t<td>1274</td>\n  \t<td>nan</td>\n  \t<td>nan</td>\n  \t<td>0</td>\n  \t<td>1</td>\n  \t<td>3</td>\n  \t<td>3</td>\n  \t<td>1274</td>\n  \t<td>0.955</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>100.0</td>\n  \t<td>0</td>\n  \t<td>RNA</td>\n  \t<td>linear</td>\n  \t<td>NODE_9999_length_1276_cov_11.598690||full</td>\n  \t    </tr>\n  \t    <tr>\n  \t<td>NODE_99999_length_314_cov_4.000000</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>287</td>\n  \t<td>0.57</td>\n  \t<td>0.57</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>287</td>\n  \t<td>nan</td>\n  \t<td>nan</td>\n  \t<td>0</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>287</td>\n  \t<td>0.57</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>50.0</td>\n  \t<td>50.0</td>\n  \t<td>0</td>\n  \t<td>RNA</td>\n  \t<td>linear</td>\n  \t<td>NODE_99999_length_314_cov_4.000000||full</td>\n  \t    </tr>\n  \t    <tr>\n  \t<td>NODE_99992_length_314_cov_4.389961</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>275</td>\n  \t<td>0.747</td>\n  \t<td>0.747</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>275</td>\n  \t<td>nan</td>\n  \t<td>nan</td>\n  \t<td>0</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>275</td>\n  \t<td>0.747</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>100.0</td>\n  \t<td>0</td>\n  \t<td>ssDNA</td>\n  \t<td>linear</td>\n  \t<td>NODE_99992_length_314_cov_4.389961||full</td>\n  \t    </tr>\n  \t    <tr>\n  \t<td>NODE_9997_length_1276_cov_44.113841</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>1240</td>\n  \t<td>0.98</td>\n  \t<td>0.98</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>1240</td>\n  \t<td>nan</td>\n  \t<td>nan</td>\n  \t<td>0</td>\n  \t<td>1</td>\n  \t<td>2</td>\n  \t<td>1</td>\n  \t<td>1240</td>\n  \t<td>0.98</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>0.0</td>\n  \t<td>50.0</td>\n  \t<td>50.0</td>\n  \t<td>0</td>\n  \t<td>RNA</td>\n  \t<td>linear</td>\n  \t<td>NODE_9997_length_1276_cov_44.113841||full</td>\n  \t    </tr>\n  \t</table>\n  </div>\n<div class=\"note warning\">\n<p>在<ruby>原病毒<rt>provirus </rt></ruby>提取过程中，为了获得更好的敏感性，VirSorter2 有时会高估病毒序列的大小。建议清除这些前病毒预测，以去除预测病毒区域边缘的潜在宿主基因，例如使用<a href=\"https://bitbucket.org/berkeleylab/checkv\"> CheckV</a> 等工具。</p>\n</div>\n<div class=\"note primary\">\n<p>How to pick a score cutoff?</p>\n</div>\n<p>一般来说，score&gt;0.9 的人为高置信度。得分在 0.5 到 0.9 之间的可能是病毒和非病毒的混合体。很难确定区分病毒和非病毒的最佳分数，因为它取决于宿主序列和未知序列的百分比。因此，<span class=\"rainbow\">建议使用默认截止值 (0.5) 以获得最大灵敏度，然后使用 checkV 应用质量检查步骤以消除误报（预测完整性除外）</span>。<mark>请继续下面的流程。</mark></p>\n</div></details>\n</li>\n<li>\n<p>运行 checkV</p>\n<details class=\"info\"><summary>命令解析</summary><div>\n<p>Score 阈值设为 0.5 时，VirSorter2 结果中可能存在一些非病毒序列或区域。因此，使用 CheckV 对 VirSorter2 的结果进行质量控制，并修剪在<ruby>原病毒<rt>proviruses</rt></ruby>末端留下的潜在宿主区域。可以根据 CPU 内核的可用性调整 - t 选项。</p>\n</div></details>\n<div class=\"note default\">\n<p>Time: 0m28.795s</p>\n</div>\n  <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">checkv end_to_end vs2-pass1/final-viral-combined.fa checkv -t <span class=\"token number\">50</span> -d /new_data/hualin/db/checkv/checkv-db-v1.0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<details class=\"success\"><summary>结果解析</summary><div>\n<ul>\n<li>./checkv/</li>\n<li>completeness.tsv</li>\n<li>complete_genomes.tsv</li>\n<li>contamination.tsv</li>\n<li>proviruses.fna</li>\n<li>quality_summary.tsv</li>\n<li>viruses.fna</li>\n<li>tmp</li>\n</ul>\n</div></details>\n</li>\n<li>\n<p>再次运行 VirSorter2</p>\n<details class=\"info\"><summary>命令解析</summary><div>\n<ul>\n<li>再次利用 checkV-trimmed 序列运行 VirSorter2 以得到 &quot;affi-contigs.tab&quot; 文件，该文件将作为 DRAMv 的输入以鉴定 AMGs。</li>\n<li>注意 &quot;--seqname-suffix-off&quot; 选项保留了原始的输入序列名称，因为我们确信在本步骤中，不可能从同一条 contig 中获得 &gt; 1 个原病毒。</li>\n<li>“--viral-gene-enrich-off” 选项关闭了病毒基因要多于宿主基因的要求，以确保 VirSorter2 在这一步不做任何筛查。</li>\n<li>以上两个选项需要 VirSorter2 版本 &gt;=2.2.1。</li>\n<li>可选所有病毒：dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae</li>\n</ul>\n</div></details>\n<div class=\"note default\">\n<p>Time: 18m30.896s</p>\n</div>\n  <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> checkv/proviruses.fna checkv/viruses.fna <span class=\"token operator\">></span> checkv/combined.fna\n\nvirsorter run --seqname-suffix-off --viral-gene-enrich-off --provirus-off --prep-for-dramv -i checkv/combined.fna -w vs2-pass2 --include-groups dsDNAphage,ssDNA --min-length <span class=\"token number\">5000</span> --min-score <span class=\"token number\">0.5</span> -j <span class=\"token number\">50</span> all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<details class=\"success\"><summary>结果解析</summary><div>\n<ul>\n<li>./vs2-pass2/</li>\n<li>inal-viral-combined.fa</li>\n<li>final-viral-score.tsv</li>\n<li>for-dramv/final-viral-combined-for-dramv.fa</li>\n<li>for-dramv/viral-affi-contigs-for-dramv.tab</li>\n</ul>\n</div></details>\n</li>\n<li>\n<p>运行 DRAMv</p>\n<details class=\"info\"><summary>命令解析</summary><div>\n<p>使用 DRAMv 注释鉴定的病毒序列，以用于后续<ruby>人工整理<rt>manual curation</rt></ruby>。可通过 &quot;--threads&quot; 控制调用的 CPU 核心数。</p>\n</div></details>\n<div class=\"note default\">\n<p>Time: 8.81h</p>\n</div>\n  <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># step 1 annotate 耗时步骤，建议投后台运行</span>\nDRAM-v.py annotate -i vs2-pass2/for-dramv/final-viral-combined-for-dramv.fa -v vs2-pass2/for-dramv/viral-affi-contigs-for-dramv.tab -o dramv-annotate --skip_trnascan --threads <span class=\"token number\">50</span> --min_contig_size <span class=\"token number\">1000</span>\n\n<span class=\"token comment\">#step 2 summarize anntotations</span>\nDRAM-v.py distill -i dramv-annotate/annotations.tsv -o dramv-distill<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<details class=\"success\"><summary>结果解析</summary><div>\n<ul>\n<li>dramv-annotate/annotations.tsv</li>\n<li>dramv-annotate/genbank 各条 contig 的 gbk 文件</li>\n<li>dramv-annotate/genes.faa</li>\n<li>dramv-annotate/genes.fna</li>\n<li>dramv-annotate/genes.gff</li>\n<li>dramv-annotate/rrnas.tsv</li>\n<li>dramv-annotate/scaffolds.fna</li>\n<li>dramv-annotate/vMAGs 各条 contig 的 fasta 文件</li>\n</ul>\n</div></details>\n</li>\n</ul>\n<h1 id=\"过滤\"><a class=\"markdownIt-Anchor\" href=\"#过滤\"></a> 过滤</h1>\n<h2 id=\"依据病毒和宿主基因数-分数-hallmark基因数以及contig长度进行筛选\"><a class=\"markdownIt-Anchor\" href=\"#依据病毒和宿主基因数-分数-hallmark基因数以及contig长度进行筛选\"></a> 依据病毒和宿主基因数、分数、hallmark 基因数以及 contig 长度进行筛选</h2>\n<p>来自 checkV 的病毒和宿主基因计数可用于假阳性筛查。由于 checkV 在预测病毒基因方面非常保守，那些由 checkV 预测的病毒基因的序列应该是病毒的，而那些没有被 checkV 预测到病毒基因的序列更可能是非病毒的。</p>\n<p>基于我们对土壤宏基因组的基准测试，(1) 那些没有预测到病毒和宿主基因的序列是病毒；(2) 没有病毒基因但有 2 个或 2 个以上宿主基因的大多数为非病毒基因；(3) 那些没有病毒基因和具有 1 个宿主基因的很难区分其为病毒还是非病毒（可能是可移动的基因元件，类似于 VirSorter1 中的第 3 类），除非手动检查，否则应该丢弃。</p>\n<p>只选择那些大于 10kb 的用于手动检查，因为太短的无法分辨。还有那些 VirSorter2 得分≥0.95 或 hallmark 基因计数 &gt; 2 的大多数是病毒。<mark>这些经验筛选标准总结如下：</mark></p>\n<div class=\"note success\">\n<p>Keep1: viral_gene &gt;0</p>\n</div>\n<div class=\"note success\">\n<p>Keep2: viral_gene =0 AND (host_gene =0 OR score &gt;=0.95 OR hallmark &gt;2)</p>\n</div>\n<div class=\"note warning\">\n<p>Manual check: (NOT in Keep1 OR Keep2) AND viral_gene =0 AND host_gene =1 AND length &gt;=10kb</p>\n</div>\n<div class=\"note danger\">\n<p>Discard: the rest</p>\n</div>\n<p><span class=\"aqua\">要查看病毒基因、宿主基因、评分和<ruby>序列的特征标记<rt>hallmark of sequences</rt></ruby>，您可以合并 &quot;vs2-pass1/final-viral-score.tsv&quot; 和 &quot;checkv/contamination.tsv&quot;，并在电子表格中过滤。</span>本尊为各位提供了 Perl 脚本<a href=\"https://github.com/liaochenlanruo/myScripts/tree/main/1551%20Virome\"> cat_tsv.pl</a> 以实现机动合并！直接在终端运行 <code>perl cat_tsv.pl</code>  即可得到合并后的文件 <code>forCheck.txt</code> 。</p>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">my</span> <span class=\"token variable\">%hash</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">$head_checkv</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">$head_pass1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">$count</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">my</span> <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\nopen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"checkv/contamination.tsv\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\tchomp<span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$_</span> <span class=\"token operator\">=~</span><span class=\"token regex\">s/[\\r\\n]+//g</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$count</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$count</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$head_checkv</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">@lines</span> <span class=\"token operator\">=</span> split <span class=\"token regex\">/\\t/</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose IN<span class=\"token punctuation\">;</span>\n\nopen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"vs2-pass1/final-viral-score.tsv\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\nopen OUT<span class=\"token punctuation\">,</span> <span class=\"token string\">\">forCheck.txt\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\tchomp<span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$_</span> <span class=\"token operator\">=~</span><span class=\"token regex\">s/[\\r\\n]+//g</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$num</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$head_pass1</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$head_pass1\\t$head_checkv\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">@line</span> <span class=\"token operator\">=</span> split <span class=\"token regex\">/\\t/</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>exists <span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$line</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$_\\t$hash&#123;$line[0]&#125;\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">print</span> OUT <span class=\"token string\">\"$_\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose IN<span class=\"token punctuation\">;</span>\nclose OUT<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>接下来按照上面的四条规则对 <code>forCheck.txt</code>  进行拆分，得到病毒 <code>Virus.txt</code> 、手动核对 <code>Manual_check.txt</code>  及抛弃的 <code>Discard.txt</code> 。可以自己看，也可以用 <code>get_virus.pl</code>  来完成。</p>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">use</span> strict<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> warnings<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">my</span> <span class=\"token variable\">$count</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\nopen IN<span class=\"token punctuation\">,</span> <span class=\"token string\">\"forCheck.txt\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\nopen VIRUS<span class=\"token punctuation\">,</span> <span class=\"token string\">\">Virus.txt\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\nopen MANUAL<span class=\"token punctuation\">,</span> <span class=\"token string\">\">Manual_check.txt\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\nopen DISCARD<span class=\"token punctuation\">,</span> <span class=\"token string\">\">Discard.txt\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token filehandle symbol\">&lt;IN></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\tchomp<span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$_</span> <span class=\"token operator\">=~</span><span class=\"token regex\">s/[\\r\\n]+//g</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$count</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$count</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">print</span> VIRUS <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">print</span> MANUAL <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">print</span> DISCARD <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">my</span> <span class=\"token variable\">@lines</span> <span class=\"token operator\">=</span> split <span class=\"token regex\">/\\t/</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\"># virus keep1</span>\n\t\t\t<span class=\"token keyword\">print</span> VIRUS <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">elsif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\"># virus keep2</span>\n\t\t\t<span class=\"token keyword\">print</span> VIRUS <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">elsif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0.95</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\"># virus keep2</span>\n\t\t\t<span class=\"token keyword\">print</span> VIRUS <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">elsif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\"># virus keep2</span>\n\t\t\t<span class=\"token keyword\">print</span> VIRUS <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">elsif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\"># manual check</span>\n\t\t\t<span class=\"token keyword\">print</span> MANUAL <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\"># discard</span>\n\t\t\t<span class=\"token keyword\">print</span> DISCARD <span class=\"token variable\">$_</span> <span class=\"token operator\">.</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose IN<span class=\"token punctuation\">;</span>\nclose VIRUS<span class=\"token punctuation\">;</span>\nclose MANUAL<span class=\"token punctuation\">;</span>\nclose DISCARD<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>用法：脚本与 <code>forCheck.txt</code>  放在同一目录，终端运行如下命令。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">perl get_virus.pl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>对于 <code>Manual_check.txt</code>  中的序列，需要用眼睛和脑袋去 <code>dramv-annotate/annotations.tsv</code>  中找注释信息，然后根据下面的方法判断其属于病毒还是细胞，如果是病毒，就将其所在的那行信息复制到 <code>Virus.txt</code>  文件的末尾，并保存。</p>\n<h2 id=\"依据dramv注释筛选\"><a class=\"markdownIt-Anchor\" href=\"#依据dramv注释筛选\"></a> 依据 DRAMv 注释筛选</h2>\n<p>在病毒和宿主中都有一些共同的基因 (如<ruby>脂多糖<rp> (</rp><rt>LPS</rt><rp>)</rp></ruby> 相关) 和移动元件，这些基因可能导致上述 “Keep2” 类别中的假阳性。因此，<ins class=\"dot\">要谨慎对待带有这些基因的 contigs</ins>。专家们已经编制了一份与此相关的<span class=\"red\"> “可疑”</span> 基因列表。我们可以使用 “Keep2” 类别中的 contigs 对 DRAMv 表取子集，并在 DRAMv 子集表中筛选 “可疑” 基因 (忽略大小写，例如在 “grep” 中使用 “-i” 选项)，然后将带有这些基因的 contigs 放入 “手动检查” 类别中。</p>\n<h2 class=\"tabset\" id=\"手动检查\"><a class=\"markdownIt-Anchor\" href=\"#手动检查\"></a> 手动检查</h2>\n<p>对于存在于<ruby>“手动检查”<rt>manual check</rt></ruby>类别中的序列，可以观察其在 &quot;dramv-annotate/annotations.tsv&quot; 中的注释信息。本步骤很难标准化，下面是一些经验之谈：</p>\n<div class=\"tabs\" id=\"tab-id\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a class=\"#tab-id-1\">判定contig为病毒的标准</a></li><li class=\"tab\"><a class=\"#tab-id-2\">判定contig为非病毒的标准</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"tab-id-1\"><div class=\"tab\" data-id=\"id1\" data-title=\"判定contig为病毒的标准\">\n<ul>\n<li>结构基因、hallmark 基因、<ruby>注释缺失或假设性富集<rt>depletion in annotations or enrichment for hypotheticals</rt> (~10% 的基因具有 non-hypothetical 注释)。</li>\n<li>缺乏 hallmarks，但 &gt;=50% 已注释的基因为病毒，且其中至少一半以上的 viral bitcore &gt;100，且 contig 的长度 &lt; 50kb。</li>\n<li>Provirus: <ruby>整合酶 / 重组酶 / 切除酶 / 阻遏子<rt>Integrase/recombinase/excisionase/repressor</rt></ruby>，在一侧富集了病毒基因。</li>\n<li>Provirus: 基因组中存在 “break”：两个基因之间的<ruby>间隙<rt>gap</rt></ruby>对应于一个<ruby>链开关<rt>strand switch</rt></ruby>，更高的编码密度，注释缺失，以及在一侧噬菌体基因的富集。</li>\n<li><ruby>仅有～1-3 个基因有注释，但至少一半命中病毒，且命中基因的 bitscore 不超过病毒 bitscore 的 150% ，<rt>Few annotations only ~1-3 genes, but with at least half hitting to viruses, and where the genes hitting cells have a bitscore no more than 150% that of the viral bitscores</rt></ruby> <ruby>且 / 或病毒的 bitscore &gt;100 <rt> and/or viral bitscores are &gt;100</rt></ruby>。</li>\n<li>LPS (脂多糖) <ruby>外观区域对病毒基因的命中率也非常高<rt>looking regions if also has very strong hits to viral genes</rt></ruby>，bitscore&gt;100。</li>\n</ul>\n</div></div><div class=\"tab-pane\" id=\"tab-id-2\"><div class=\"tab\" data-id=\"id1\" data-title=\"判定contig为非病毒的标准\">\n<ul>\n<li><ruby>细胞样基因<rt>cellular like genes</rt></ruby>是病毒基因的 3 倍，几乎所有基因都有注释，没有基因只命中病毒，也没有病毒<ruby>标志基因<rt>hallmark genes</rt></ruby>。</li>\n<li>缺乏任何病毒 hallmark genes，且长度 &gt;50kb。</li>\n<li>许多明显的细胞基因字符串，没有其他病毒标志基因。 在基准测试中遇到的例子包括 1) CRISPR Cas, 2) ABC transporters, 3) Sporulation proteins, 4) Two-component systems, 5) Secretion system。这其中一些可能是由病毒编码的，但在没有进一步证据的情况下并不表明是病毒 contig。</li>\n<li>多个质粒基因或转座酶，但没有明确的只命中病毒的基因。</li>\n<li>注释信息很少，仅有～1-3 个基因同时命中了病毒和细胞基因，但有 stronger bitscores 支持其为细胞基因。</li>\n<li><ruby>没有强有力的命中病毒的脂多糖样区域<rt>LPS looking regions if no strong viral hits</rt></ruby>。富含通常与脂多糖相关的基因，如<ruby>外聚酶<rp> (</rp><rt>epimerases</rt><rp>)</rp></ruby>、<ruby>糖<rp> (</rp><rt>glycosyl</rt><rp>)</rp> 基转移酶<rp> (</rp><rt>transferases</rt><rp>)</rp></ruby>、<ruby>酰基转移酶<rp> (</rp><rt>acyltransferase</rt><rp>)</rp></ruby>、<ruby>短<rp> (</rp><rt>dehydrogenase</rt><rp>)</rp> 链<rp> (</rp><rt>reductase</rt><rp>)</rp> 脱氢酶<rp> (</rp><rt>short-ch</rt><rp>)</rp>/<rt></rt> 还原酶<rp> (</rp><rt>ain</rt><rp>)</rp></ruby>、<ruby>脱水酶<rp> (</rp><rt>dehydratase</rt><rp>)</rp></ruby>。</li>\n<li>注释为 Type IV 和 / 或 Type VI 分析系统，并被非病毒基因围绕。</li>\n<li>注释信息很少，仅有～1-3 个基因全部命中细胞基因 (即使 bitscore &lt;100) ，且没有命中病毒的基因。</li>\n</ul>\n</div></div></div></div>\n<div class=\"note warning\">\n<p>最后，用户要注意，VirSorter 2 和 / 或 checkV 预测的任何原病毒边界只是一个近似的估计 (寻找 “ends” 在前噬菌体发现中是一个相当具有挑战性的问题)，也需要仔细地手工检查，特别是在 AMG 研究中。</p>\n</div>\n<p>最终我们需要拿到病毒 contig 的序列，用 <code>get_virus_seqs.pl</code>  完成。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/perl</span>\nuse strict<span class=\"token punctuation\">;</span>\nuse warnings<span class=\"token punctuation\">;</span>\n\nmy %hash<span class=\"token punctuation\">;</span>\n<span class=\"token function\">open</span> IN, <span class=\"token string\">\"checkv/combined.fna\"</span> <span class=\"token operator\">||</span> die<span class=\"token punctuation\">;</span>\n<span class=\"token builtin class-name\">local</span> $/ <span class=\"token operator\">=</span> <span class=\"token string\">\">\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">&lt;</span>IN<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>IN<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\tchomp<span class=\"token punctuation\">;</span>\n\tmy <span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span>, <span class=\"token variable\">$seq</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> split<span class=\"token punctuation\">(</span>/<span class=\"token punctuation\">\\</span>n/, <span class=\"token variable\">$_</span>, <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tmy <span class=\"token variable\">$id</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span> <span class=\"token operator\">=~</span>/<span class=\"token punctuation\">(</span><span class=\"token punctuation\">\\</span>S+<span class=\"token punctuation\">)</span><span class=\"token punctuation\">\\</span><span class=\"token operator\">|</span><span class=\"token punctuation\">\\</span><span class=\"token operator\">|</span>.+/<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>else <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$header</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$seq</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose IN<span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin class-name\">local</span> $/ <span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">open</span> IN, <span class=\"token string\">\"Virus.txt\"</span> <span class=\"token operator\">||</span> die<span class=\"token punctuation\">;</span>\n<span class=\"token function\">open</span> OUT, <span class=\"token string\">\">Virus.fas\"</span> <span class=\"token operator\">||</span> die<span class=\"token punctuation\">;</span>\n<span class=\"token function\">open</span> NO, <span class=\"token string\">\">NoSeqs.ids\"</span> <span class=\"token operator\">||</span> die<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">&lt;</span>IN<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>IN<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\tchomp<span class=\"token punctuation\">;</span>\n\tmy @lines <span class=\"token operator\">=</span> <span class=\"token function\">split</span> /<span class=\"token punctuation\">\\</span>t/<span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$lines</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=~</span>/<span class=\"token punctuation\">(</span><span class=\"token punctuation\">\\</span>S+<span class=\"token punctuation\">)</span><span class=\"token punctuation\">\\</span><span class=\"token operator\">|</span><span class=\"token punctuation\">\\</span><span class=\"token operator\">|</span>/<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>exists <span class=\"token variable\">$hash</span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tprint OUT <span class=\"token string\">\"><span class=\"token variable\">$lines</span>[0]<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token variable\">$hash</span>&#123;<span class=\"token variable\">$1</span>&#125;<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>else <span class=\"token punctuation\">&#123;</span>\n\t\tprint NO <span class=\"token string\">\"<span class=\"token variable\">$lines</span>[0]<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\nclose IN<span class=\"token punctuation\">;</span>\nclose OUT<span class=\"token punctuation\">;</span>\nclose NO<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>用法：终端运行如下命令即可得到序列文件 <code>Virus.fas</code> 。</p>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\">perl get_virus_seqs<span class=\"token operator\">.</span>pl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h1 id=\"脚本获取\"><a class=\"markdownIt-Anchor\" href=\"#脚本获取\"></a> 脚本获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “1551” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://github.com/jiarong/VirSorter2\">VirSorter2</a></li>\n<li><a href=\"https://www.protocols.io/view/viral-sequence-identification-sop-with-virsorter2-bwm5pc86\">Viral sequence identification SOP with VirSorter2 V.3</a></li>\n</ul>\n<h1 id=\"别人用过的多软件结合法流程图\"><a class=\"markdownIt-Anchor\" href=\"#别人用过的多软件结合法流程图\"></a> 别人用过的多软件结合法流程图</h1>\n<div class=\"mermaid\">flowchart TD;\n\tA[Reads] --&gt; B((MetaSpaDES));\n\tB --&gt; C[Contigs];\n\tC --&gt; D((VirSorter));\n\tC --&gt; E((VirFinder));\n\tE --&gt; F{Score &gt;&#x3D; 0.7 &amp; p &lt; 0.05};\n\tF -- YES --&gt; G[Virus];\n\tF -- NO --&gt; H[Contigs];\n\tD --&gt; G;\n\tH --&gt; I((CAT));\n\tI --&gt; J{&lt; 40%};\n\tJ -- YES --&gt; G;\n\tJ -- NO --&gt; K[Not Virus];\n\tG --&gt; L((Nucmer));\n\tL --&gt; M{Identity &gt;&#x3D; 95% &amp; Coverage &gt;&#x3D; 80%};\n\tM -- YES --&gt; N[Grouped];\n\tM -- NO --&gt; O[Not Grouped];\n\tG --&gt; P((Prodigal));\n\tP --&gt; Q[Amino Acid Sequences];\n\tQ --&gt; R{Length &lt; 10 kb};\n\tR -- YES --&gt; S((Blastp));\n\tR -- NO --&gt; T((vConTACT2));\n\tS --&gt; U[Annotated Genes];\n\tT --&gt; U;</div>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"ST179","path":"api/tags/ST179.json"},{"name":"宏病毒组","path":"api/tags/宏病毒组.json"}]},{"title":"Linux中使用tar将大文件压缩为多个小的压缩包","slug":"Linux中使用tar将大文件压缩为多个小的压缩包","date":"2021-11-26T14:35:35.000Z","updated":"2022-01-08T02:16:28.404Z","comments":true,"path":"api/articles/Linux中使用tar将大文件压缩为多个小的压缩包.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>在 GitHub 上传文件时，单个文件不允许超过 100m，超过的话需要使用 Git Large File Storage，操作起来稍有些复杂，而且我记得也有限制。在这里我们可以将大文件压缩并切片，使之被分割为多个小文件，再上传 GitHub，下载之后再合并即可。</p>\n<ul>\n<li>\n<p>压缩</p>\n<p>假设有个大文件 <code>CAZy.faa</code> ，原始大小为 725m，压缩后为 135m，因此我们可以将其压缩为 2~3 个文件 即可避免 100m 的限制。建议上传至 GitHub 的单个文件大小不要超过 50m，因此我们以 50m 为阈值对文件进行切割（参数 - b）。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">tar</span> czf - CAZy.faa <span class=\"token operator\">|</span> <span class=\"token function\">split</span> -b 50m - CAZy.faa.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>运行命令后，得到了 3 个文件：CAZy.faa.tar.gzaa，CAZy.faa.tar.gzab，CAZy.faa.tar.gzac。</p>\n</li>\n<li>\n<p>解压</p>\n<p>通过如下命令解压后可以得到完整的 <code>CAZy.faa</code>  文件。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> CAZy.faa.tar.gz* <span class=\"token operator\">|</span> <span class=\"token function\">tar</span> -xzv<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ul>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://my.oschina.net/yysue/blog/1815340\">Linux 下将一个文件压缩分包成多个小文件</a></li>\n</ul>\n","raw":null,"categories":[{"name":"IT","path":"api/categories/IT.json"}],"tags":[{"name":"Github","path":"api/tags/Github.json"},{"name":"Linux","path":"api/tags/Linux.json"}]},{"title":"R语言绘制分组条形图","slug":"R语言绘制分组条形图","date":"2021-11-26T06:37:02.000Z","updated":"2022-01-08T02:16:28.413Z","comments":true,"path":"api/articles/R语言绘制分组条形图.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg","content":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a class=\"markdownIt-Anchor\" href=\"#输入文件样式\"></a> 输入文件样式</h1>\n<p>本例中数据内容如下图所示，将其保存在名为 <code>CAZy.Category.Matrix.txt</code>  的文件中。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"CAZy.Category.Matrix.txt\" /></p>\n<h1 id=\"绘图代码\"><a class=\"markdownIt-Anchor\" href=\"#绘图代码\"></a> 绘图代码</h1>\n<p>在 Rstudio 中运行如下代码，细节可根据具体情况修改</p>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\nwindowsFonts<span class=\"token punctuation\">(</span>Arial<span class=\"token operator\">=</span>windowsFont<span class=\"token punctuation\">(</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#加载Windows字体</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#设定工作目录</span>\ncazy <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"CAZy.Category.Matrix.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\ncazy_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>cazy<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Cazy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\nggplot<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">,</span>aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n     geom_bar<span class=\"token punctuation\">(</span>stat <span class=\"token operator\">=</span> <span class=\"token string\">'identity'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span>\n              aes<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> Cazy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              position <span class=\"token operator\">=</span> position_dodge<span class=\"token punctuation\">(</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token comment\">#使柱子并排放置</span>\n     theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> \n     theme<span class=\"token punctuation\">(</span>text<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span>face <span class=\"token operator\">=</span> <span class=\"token string\">\"plain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#设置文字的字体字号</span>\n           axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token comment\"># 设置X轴文字大小</span>\n      scale_fill_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设置填充颜色</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"分组条形图\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R 语言 ggplot2 分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar () 函数绘制条形图</a></li>\n</ul>\n","raw":null,"categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"SY179","path":"api/tags/SY179.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]},{"title":"利用NCycDB数据库从宏基因组中预测氮循环基因","slug":"利用NCycDB数据库从宏基因组中预测氮循环基因","date":"2021-11-25T03:19:20.000Z","updated":"2022-01-08T02:16:28.433Z","comments":true,"path":"api/articles/利用NCycDB数据库从宏基因组中预测氮循环基因.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg","content":"<p>氮（N）循环是地球生态系统中重要的生物地球化学途径的集合，在生态学和环境研究中得到了广泛的关注。目前，<ruby>鸟枪法宏基因组测序<rt>Shotgun metagenome sequencing</rt></ruby>已被广泛应用于探索负责 N 循环过程的基因家族。NCycDB 是一个手动管理的综合数据库，用于从鸟枪法宏基因组测序数据中快速准确地分析 N 循环基因（亚）家族。 NCycDB 总共包含 68 个基因（亚）家族，涵盖 8 个 N 循环过程，分别具有 95% 和 100% 一致性阈值的 84 759 和 219 146 个代表性序列。数据库中还包含了 1958 个<ruby>同源直系同源组<rt>Homologous orthology groups</rt></ruby>的序列，以避免由于 “小数据库” 问题导致的假阳性分配。</p>\n<h1 id=\"数据库及脚本\"><a class=\"markdownIt-Anchor\" href=\"#数据库及脚本\"></a> 数据库及脚本</h1>\n<h2 id=\"下载\"><a class=\"markdownIt-Anchor\" href=\"#下载\"></a> 下载</h2>\n<ul>\n<li>\n<p>通过 Git</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/liaochenlanruo/NCyc.git<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>通过 wget</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/liaochenlanruo/NCyc/archive/refs/heads/master.zip<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ul>\n<h2 id=\"配置\"><a class=\"markdownIt-Anchor\" href=\"#配置\"></a> 配置</h2>\n<ul>\n<li>通过 <code>Git</code>  下载的不需要解压，通过 <code>Wget</code>  下载的需要先解压。</li>\n<li>修改 <code>NCycProfilter.PL</code>  文件的第 8-13 行中 4 个依赖软件的安装路径。</li>\n<li>将 <code>data</code>  目录下的 <code>NCyc_100_2019Jul.7z</code>  解压，将解压得到的 <code>NCyc_100_2019Jul</code>  重命名为 <code>NCyc_100.faa</code>  并移动至 <code>data</code>  目录下。</li>\n</ul>\n<h2 id=\"依赖\"><a class=\"markdownIt-Anchor\" href=\"#依赖\"></a> 依赖</h2>\n<ul>\n<li>Blast</li>\n<li>diamond</li>\n<li>usearch</li>\n<li>Perl</li>\n</ul>\n<h1 id=\"输入文件\"><a class=\"markdownIt-Anchor\" href=\"#输入文件\"></a> 输入文件</h1>\n<ul>\n<li>\n<p>序列文件<br />\n宏基因组测序得到的 Reads 文件、组装后的序列文件以及通过基因预测后得到的氨基酸序列文件均可。序列文件可以是压缩的，也可以是解压的。</p>\n</li>\n<li>\n<p>基因组 - 序列数对应文件<br />\n提供一份文本文档，共包含两列，第一列为 <code>样本名称</code>  (即序列文件的名字，不带文件后缀名)，第二列为 <code>样本包含的序列数量</code> 。</p>\n</li>\n</ul>\n<h1 id=\"预测\"><a class=\"markdownIt-Anchor\" href=\"#预测\"></a> 预测</h1>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">perl NCycProfiler.PL -d ./ -m diamond -f faa -s prot -si SI.txt -o Ncycle.out.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<div class=\"note info\">\n<p>参数解析：</p>\n</div>\n<p>-d 指定工作目录，即序列文件所在目录。<br />\n-m 指定用哪个软件进行序列比对，可选 <code>diamond</code> ， <code>blast</code> ， <code>usearch</code> 。<br />\n-f 指定序列文件的后缀名，不需要带 <code>.</code> 。<br />\n-s 指定序列类型，氨基酸为 <code>prot</code> ，核苷酸为 <code>nucl</code> 。<br />\n-si 基因组 - 序列数对应文件<br />\n - rs 随机取样大小，如果不指定，将取包含序列最少的样本的序列数<br />\n - o 指定输出的文件名称</p>\n<h1 id=\"结果解析\"><a class=\"markdownIt-Anchor\" href=\"#结果解析\"></a> 结果解析</h1>\n<p>得到的结果文件是一个表格，第一行为随机取样大小。第一列为参与 N 循环的基因名，其他列为各样本含有的对应基因的数量。</p>\n<h1 id=\"可视化\"><a class=\"markdownIt-Anchor\" href=\"#可视化\"></a> 可视化</h1>\n<p>可参考本站另一篇文章<a href=\"https://www.liaochenlanruo.fun/post/b68c.html\"> R 语言绘制气泡图 Bubb_Plot</a> 进行数据可视化。</p>\n<ul>\n<li>不带分组</li>\n</ul>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\">setwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc\"</span><span class=\"token punctuation\">)</span>\ndata <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"Ncycle.out.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\n\nlibrary<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\ndata_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Genes\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\ndata_melt <span class=\"token operator\">&lt;-</span>as.data.frame<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 做主图</span>\nbubble <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">[</span>which<span class=\"token punctuation\">(</span>data_melt<span class=\"token operator\">$</span>Abundances<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> Genes<span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> geom_point<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 修改细节 — 图注，点大小，点shape</span>\nbubble_style <span class=\"token operator\">&lt;-</span> bubble <span class=\"token operator\">+</span> theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n    labs<span class=\"token punctuation\">(</span>\n        x <span class=\"token operator\">=</span> <span class=\"token string\">\"Sediment layers\"</span><span class=\"token punctuation\">,</span>\n        y <span class=\"token operator\">=</span> <span class=\"token string\">\"N cycling genes\"</span><span class=\"token punctuation\">,</span>\n        color<span class=\"token operator\">=</span><span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 颜色图注名</span>\n        size<span class=\"token operator\">=</span><span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>    <span class=\"token comment\"># 大小图注名</span>\n    scale_size<span class=\"token punctuation\">(</span>range <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>  <span class=\"token comment\">#等比修改圆圈大小</span>\n    theme<span class=\"token punctuation\">(</span>plot.title<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n                                  color<span class=\"token operator\">=</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span>face<span class=\"token operator\">=</span><span class=\"token string\">\"italic\"</span><span class=\"token punctuation\">,</span>\n                                  hjust<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>lineheight<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          plot.subtitle <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> \n    theme<span class=\"token punctuation\">(</span>axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nbubble_style<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>依据下表获得基因的 <code>Pathways</code>  和 <code>Annotation</code> ，随后依据 <code>Pathways</code>  进行分组并绘图。</p>\n<table>\n<thead>\n<tr>\n<th>Pathways</th>\n<th>Gene (sub) families</th>\n<th>Annotation</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td rowspan=\"9\">Nitrification</td>\n<td>amoA_A</td>\n<td>Ammonia monooxygenase subunit A (archaea)</td>\n</tr>\n<tr>\n<td>amoB_A</td>\n<td>Ammonia monooxygenase subunit B (archaea)</td>\n</tr>\n<tr>\n<td>amoC_A</td>\n<td>Ammonia monooxygenase subunit C (archaea)</td>\n</tr>\n<tr>\n<td>amoA_B</td>\n<td>Ammonia monooxygenase subunit A (bacteria)</td>\n</tr>\n<tr>\n<td>amoB_B</td>\n<td>Ammonia monooxygenase subunit B (bacteria)</td>\n</tr>\n<tr>\n<td>amoC_B</td>\n<td>Ammonia monooxygenase subunit C (bacteria)</td>\n</tr>\n<tr>\n<td>hao</td>\n<td>Hydroxylamine dehydrogenase</td>\n</tr>\n<tr>\n<td>nxrA</td>\n<td>Nitrite oxidoreductase, alpha subunit</td>\n</tr>\n<tr>\n<td>nxrB</td>\n<td>Nitrite oxidoreductase, beta subunit</td>\n</tr>\n<tr>\n<td rowspan=\"16\">Denitrification</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>nirK</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>nirS</td>\n<td>Nitrite reductase (NO-forming)</td>\n</tr>\n<tr>\n<td>norB</td>\n<td>Nitric oxide reductase subunit B</td>\n</tr>\n<tr>\n<td>norC</td>\n<td>Nitric oxide reductase subunit C</td>\n</tr>\n<tr>\n<td>nosZ</td>\n<td>Nitrous-oxide reductase</td>\n</tr>\n<tr>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td rowspan=\"6\">Assimilatory nitrate reduction</td>\n<td>nasA</td>\n<td>Assimilatory nitrate reductase catalytic subunit</td>\n</tr>\n<tr>\n<td>nasB</td>\n<td>Assimilatory nitrate reductase electron transfer subunit</td>\n</tr>\n<tr>\n<td>nirA</td>\n<td>Ferredoxin-nitrite reductase</td>\n</tr>\n<tr>\n<td>NR</td>\n<td>Nitrate reductase (NAD(P)H)</td>\n</tr>\n<tr>\n<td>narB</td>\n<td>Assimilatory nitrate reductase</td>\n</tr>\n<tr>\n<td>narC</td>\n<td>Cytochrome b-561</td>\n</tr>\n<tr>\n<td rowspan=\"17\">Dissimilatory nitrate reduction</td>\n<td>napA</td>\n<td>Periplasmic nitrate reductase NapA</td>\n</tr>\n<tr>\n<td>napB</td>\n<td>Cytochrome c-type protein NapB</td>\n</tr>\n<tr>\n<td>napC</td>\n<td>Cytochrome c-type protein NapC</td>\n</tr>\n<tr>\n<td>narG</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>narH</td>\n<td>Nitrate reductase</td>\n</tr>\n<tr>\n<td>narJ</td>\n<td>Nitrate reductase molybdenum cofactor assembly chaperone</td>\n</tr>\n<tr>\n<td>narI</td>\n<td>Nitrate reductase gamma subunit</td>\n</tr>\n<tr>\n<td>narZ</td>\n<td>Nitrate reductase 2, alpha subunit</td>\n</tr>\n<tr>\n<td>narY</td>\n<td>Nitrate reductase 2, beta subunit</td>\n</tr>\n<tr>\n<td>narV</td>\n<td>Nitrate reductase 2, gamma subunit</td>\n</tr>\n<tr>\n<td>narW</td>\n<td>Nitrate reductase 2, delta subunit</td>\n</tr>\n<tr>\n<td>nirB</td>\n<td>Nitrite reductase (NADH) large subunit</td>\n</tr>\n<tr>\n<td>nirD</td>\n<td>Nitrite reductase (NADH) small subunit</td>\n</tr>\n<tr>\n<td>nrfA</td>\n<td>Nitrite reductase (cytochrome c-552)</td>\n</tr>\n<tr>\n<td>nrfB</td>\n<td>Cytochrome c-type protein NrfB</td>\n</tr>\n<tr>\n<td>nrfC</td>\n<td>Protein NrfC</td>\n</tr>\n<tr>\n<td>nrfD</td>\n<td>Protein NrfD</td>\n</tr>\n<tr>\n<td rowspan=\"5\">Nitrogen fixation</td>\n<td>anfG</td>\n<td>Nitrogenase delta subunit</td>\n</tr>\n<tr>\n<td>nifD</td>\n<td>Nitrogenase molybdenum-iron protein alpha chain</td>\n</tr>\n<tr>\n<td>nifH</td>\n<td>Nitrogenase iron protein NifH</td>\n</tr>\n<tr>\n<td>nifK</td>\n<td>Nitrogenase molybdenum-iron protein beta chain</td>\n</tr>\n<tr>\n<td>nifW</td>\n<td>Nitrogenase-stabilizing/protective protein</td>\n</tr>\n<tr>\n<td rowspan=\"5\">Anammox</td>\n<td>hzo</td>\n<td>Hydrazine oxidoreductase</td>\n</tr>\n<tr>\n<td>hzsA</td>\n<td>Hydrazine synthase subunit A</td>\n</tr>\n<tr>\n<td>hzsB</td>\n<td>Hydrazine synthase subunit B</td>\n</tr>\n<tr>\n<td>hzsC</td>\n<td>Hydrazine synthase subunit C</td>\n</tr>\n<tr>\n<td>hdh</td>\n<td>Hydrazine dehydrogenase</td>\n</tr>\n<tr>\n<td rowspan=\"17\">Organic degradation and synthesis</td>\n<td>ureA</td>\n<td>Urease subunit gamma</td>\n</tr>\n<tr>\n<td>ureB</td>\n<td>Urease subunit beta</td>\n</tr>\n<tr>\n<td>ureC</td>\n<td>Urease subunit alpha</td>\n</tr>\n<tr>\n<td>nao</td>\n<td>Nitroalkane oxidase</td>\n</tr>\n<tr>\n<td>nmo</td>\n<td>Nitronate monooxygenase</td>\n</tr>\n<tr>\n<td>gdh_K00260</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>gdh_K00261</td>\n<td>Glutamate dehydrogenase (NAD(P)+)</td>\n</tr>\n<tr>\n<td>gdh_K00262</td>\n<td>Glutamate dehydrogenase (NADP+)</td>\n</tr>\n<tr>\n<td>gdh_K15371</td>\n<td>Glutamate dehydrogenase</td>\n</tr>\n<tr>\n<td>gs_K00264</td>\n<td>Glutamate synthase (NADPH/NADH)</td>\n</tr>\n<tr>\n<td>gs_K00265</td>\n<td>Glutamate synthase (NADPH/NADH) large chain</td>\n</tr>\n<tr>\n<td>gs_K00266</td>\n<td>Glutamate synthase (NADPH/NADH) small chain</td>\n</tr>\n<tr>\n<td>gs_K00284</td>\n<td>Glutamate synthase (ferredoxin)</td>\n</tr>\n<tr>\n<td>glsA</td>\n<td>Glutaminase</td>\n</tr>\n<tr>\n<td>glnA</td>\n<td>Glutamine synthetase</td>\n</tr>\n<tr>\n<td>asnB</td>\n<td>Asparagine synthase (glutamine-hydrolysing)</td>\n</tr>\n<tr>\n<td>ansB</td>\n<td>Glutamin-(asparagin-)ase</td>\n</tr>\n<tr>\n<td rowspan=\"4\">Others</td>\n<td>hcp</td>\n<td>Hydroxylamine reductase</td>\n</tr>\n<tr>\n<td>pmoA</td>\n<td>Particulate methane monooxygenase subunit A</td>\n</tr>\n<tr>\n<td>pmoB</td>\n<td>Particulate methane monooxygenase subunit B</td>\n</tr>\n<tr>\n<td>pmoC</td>\n<td>Particulate methane monooxygenase subunit C</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>带分组</li>\n</ul>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\">setwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc\"</span><span class=\"token punctuation\">)</span>\n\ndata <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"Ncycle.out.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\n\nlibrary<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\ndata_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Genes\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Annotation\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Pathways\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\ndata_melt <span class=\"token operator\">&lt;-</span>as.data.frame<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span>\nbubble <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">[</span>which<span class=\"token punctuation\">(</span>data_melt<span class=\"token operator\">$</span>Abundances<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> Genes<span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> theme_bw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token string\">\"Sediment layers\"</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token string\">\"N cycling genes\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> theme<span class=\"token punctuation\">(</span>axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> colour <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">,</span> vjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> hjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.text.y <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>panel.grid <span class=\"token operator\">=</span> element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> panel.border <span class=\"token operator\">=</span> element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>panel.spacing <span class=\"token operator\">=</span> unit<span class=\"token punctuation\">(</span><span class=\"token number\">.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lines\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> \n    theme<span class=\"token punctuation\">(</span>plot.margin<span class=\"token operator\">=</span>unit<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> geom_point<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> facet_grid<span class=\"token punctuation\">(</span>Pathways <span class=\"token operator\">~</span> .<span class=\"token punctuation\">,</span> drop<span class=\"token operator\">=</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> scale<span class=\"token operator\">=</span><span class=\"token string\">\"free\"</span><span class=\"token punctuation\">,</span>space<span class=\"token operator\">=</span><span class=\"token string\">\"free\"</span><span class=\"token punctuation\">,</span> switch <span class=\"token operator\">=</span> <span class=\"token string\">\"y\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>strip.background <span class=\"token operator\">=</span> element_rect<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"grey95\"</span><span class=\"token punctuation\">,</span> colour <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> strip.text.y.left <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle<span class=\"token operator\">=</span><span class=\"token number\">360</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> strip.text<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://doi.org/10.1093/bioinformatics/bty741\">NCycDB: a curated integrative database for fast and accurate metagenomic profiling of nitrogen cycling genes</a></li>\n<li><a href=\"https://github.com/qichao1984/NCyc\">GitHub</a></li>\n</ul>\n<h1 id=\"脚本获取\"><a class=\"markdownIt-Anchor\" href=\"#脚本获取\"></a> 脚本获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “18ea” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"Functional genomics","path":"api/tags/Functional genomics.json"},{"name":"SY179","path":"api/tags/SY179.json"},{"name":"生信软件","path":"api/tags/生信软件.json"},{"name":"宏基因组","path":"api/tags/宏基因组.json"}]},{"title":"NCBI上传基因簇之tbl2asn的使用","slug":"NCBI上传基因簇之tbl2asn的使用","date":"2021-11-12T11:47:28.000Z","updated":"2022-01-08T02:16:28.406Z","comments":true,"path":"api/articles/NCBI上传基因簇之tbl2asn的使用.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>向<a href=\"https://www.ncbi.nlm.nih.gov/\"> NCBI</a> 提交基因簇的时候需要提供 sqn 格式的文件，这个文件需要通过<a href=\"https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/\"> tbl2asn</a> 生成。</p>\n<h1 id=\"文件准备\"><a class=\"markdownIt-Anchor\" href=\"#文件准备\"></a> 文件准备</h1>\n<p>tbl2asn 依赖三个文件来生成 sqn 文件：</p>\n<ul>\n<li>文件 1：fasta 格式的基因组序列文件</li>\n</ul>\n<p>Header 处的中括号部分可以不写。</p>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">&gt;Toyoncin_biosynthesis_gene_cluster [organism&#x3D;Bacillus toyonensis] [strain&#x3D;XIN-YC13] [topology&#x3D;linear] [moltype&#x3D;DNA] [tech&#x3D;wgs] [gcode&#x3D;11] [country&#x3D;China] Bacillus toyonensis strain XIN-YC13 Toyoncin biosynthesis gene cluster, complete sequence\nttaaaa taatttaata\ngggaagtttt ttagttgttt tggactcttc ccaaacactg ctttaagtgt tggattaaca\n tcatccctat tccccgaaaa cataatgtga ggatttatga ataatgcata tgctctaaca\nttattatcat caacaccact ctctgaacga gccataatac ccttatcaat taattttcta\naccaatggac taactttagt ttcatgtctt ccaatttttt tagctaattc tcgctgagtt\n aatgggattt gttctttcga attaatatca ttaactaaac aattacttaa aaaacctaca\ncacattgaaa tatctactaa aaataccttc tcagcatttg ttaaataatc aatttcgaac\n aaatactgga tattttgttg aataatctga acaaacttcg ctttattttt cactttacgc\n tcaggaacta atttcattcc tcttgaacga gcttttgatt gaagtttatt tgctaaatac\n atctcttctt cagacaagac ctttaaatcc tcaatatctc tcaatcttga atttttttca\n gcttgttcta agttgataaa ctttgacata ttctttttgc tcctcttttc taagattttc\n aactagagaa ggaaaaaatt ttatgttatg attcctgtag aatttacaat tcaatatgta\n caaaagaact ccccttttct aattgatagt ttggtcgctt tcaattataa tacaagggga\n ttttttacat cttaaaattt ttcatttttg aatcaatccc tgaaaatata aagaacacat\n cacataaatt attcttaata ttttataatc gaaaaaataa taggaataaa gaaaaatact\n gcaataaata tattcatctg tttcttactc aaaccggcca ctatatttaa tcccattcct\n ataataatta attcccaaat tgaaaacact tcaaatttac tacaaattat atatagtaat\n gtacctggtt caaatattga acccaaacta gtatacgtta ctatttctcc tcctataaat\n agtgttaata atgtattaat taatttacct aaaatagaaa ttacactagc aaatattgta\n atagatacta actttttata agaaacatct ttactcatca gcatcattac aatctttaaa\n ataatccccc aaataaaagg tgtaattaaa gcaatgaaaa tcgatgcaaa acctcctaac\n atcatttggg aaacaagggg tatttccata tctgcaaata cttctttttg aattttaacc\n aattctggat tgctatgtct tgcatataca gataaaatcc ctattattgc ttgtataact\n gataaataca taagaggaaa ccatatcgga ctaattattt tcatacgctc gaattcagaa\n ataggagatg taatcataaa aattagagat ggtttttcat aattgttttt ttctttattc\n actactaaac tattatccat atattaacac cttctttttt tattcataac gtaatgcttc\n aattggatct aattttgcag ccttattggc tggaatcaat ccaaatataa taccaagcga\n catcgaaaat aatacgccac ccacaacaac ttcccatgaa acaagaggcg gccattttgc\n aaatgtggac acaatgtacg ctccacaata accaagtcca atcccaatca atccaccaag\n aagtgtcaac ataattgctt caattaaaaa ttgcaacaaa attttaccac gcgttgctcc\naagtgcttta cgtaccccaa tctcacgtgt acgctctgtt acagaaacaa gcatgatatt\ncataactcca attccgccta caactaaaga aatacttgca atacctgcaa taatcattgt\ncataatatta gtaactttag aaataccttt ttggatttct tctaaattta caatttcata\n tttcccttta aactcttcag attgtctatc atttaataat tttactccct tttttccagc\ntgtttgtaat tgatcaaccc ctattgcttg aattgtaata gattgttgag agttatcatc\n tccatataat attggccata ttgaaagtgg tattaaaatt tctgacattc caaaaccaag\n ctcttcatct cctgaactga atagaccaat aatttgaagt ggctgacctt taatttctat\n aattttacca atgactgatt catgctcatt aggaaataac tctttcacta atgtttgatt\n aaccattatt acattattac cttgcatcaa atcatcttca ttaagagaac gacctttctc\n tattttcatt ttagtcatat taaaatattc ttttgtaata ccatttatat tagttacaac\nctttttatca tcaccaatta atgtctctgt actagagttt tgaacaatta catttttaat\n ttcttttatc ttttttaact caaaaagatc ttcttcactt acagatggtt ttttgtcatt\n catagatcct gttgttaata actcattaat atcttcttta tatgtaatcg gaatagtgtt\n attgccagaa gcggtaaatt gtgatttaag cattgcttct ccacctttac caatggctac\n aacagtaata atagaaccta caccaataat aattccaagc atcgtaagag ctgagcgcag\n tttatgagct aaaatagaag ataaggcaat ttttatacta tctaataaac tcataccata\n caccttctat cttctgtaat tttcccatct cgcaatatga tgcgacgtga agaataagct\n gctacctctt cttcatgtgt aaccataacg attgtcgtac cttctgcatt taacttcgta\n aagatatcca taacttgtgc accagacttc gtatcaagcg caccagttgg ctcatcagcc\n ataataaacg ttggattatt cgcaatcgat cttgcaatag caacacgctg cttctgtcca\n cctgacagct cactaggtaa atgatgtact ctatccgcta atccaacttt cccaagcgct\n tcgagcgctc tttgacgacg ctctgctttc ttcactccac cataaatcag tggtaattca\n acgttttcca ctgcggaaag gcgcggcaat aaattaaaat gctggaacac aaaaccgata\ntattcattac gaattaaagc aagttttgac tcatctgctg ttaaaatatt cacatcattc\nagcatatatt cgccttctgt tggacgatct aaacaaccga taatattcat aagagttgat\nttaccagaac cagacggtcc cataattgaa acaaattcac caccttgaat agttaaacta\nataccgtgca aaataggaac cgccattttt ccttgataat acgttttagc aatattattt\naacgtaatca tttctctttc acttccattc cgtcatatac gttgtcggaa ggatttttaa\nccaccttttg ccccactgtt gcgccctcta caatctctgt ccaatctcca tcagtagcac\ncttttttcac attttgttta cgaagcttac ctttctcttc gatatataca aatgcatcat\n      cgcctttttc aacaatactc ttacttggaa cagcaatcat tcttttattc tctaaattta\n      cttgtaacga aacatgataa cctggagata aaccatcttg actatcaaga cttgctttat\n      atgtatattg agacatattt tgagtcactt cccccatgcc atcagcttga gccatttcta\n      cacttgttgg gaactcactt acctctgtaa tcttccctgt ccactttttc ttactatttg\n      ctttcgcagt tacagtaaac gtttgatcct tttgaatttg cgacttctga agctcagtta\n      atgttccttg aatttggaat ggatctttag aagcaacttg taaaaaggct ttcccttgac\n      cacctaacgc ttgtgatgaa ctttgtgctg catctttatc taacttttga acaacaccag\n      caaaattgct ataaatcgta agttcgttct gctttttatt taactcttct ttttgtaact\n      tccctttctc tttctcaagg tctgttgtct tttgcgctat ttctaattca cttacttgct\n      cttccatcgg atctattact tctttcccag ctccgctatc tttcgccttc ttaatttctt\n      tcttcaacga atcaatcttc tttttccctt ggtcataacg catatctgcc atcttttgat\n      caagcacagc ttgcttcatt tgcaaattaa tttcttcatt atcgtaagaa aacaatttcg\n      ttcccttttc tatttcttgt ccttctttca cttcaatatc tttcactttt cctttagtca\n      gatccgcgta gaaactttca atattccccg gcttcacttg accagaaatt aactttgtat\n      tattaagatt gcgctctgtg actttttcaa aactaacagt atctattttt gttaccgctt\n      tcttcttact ttgcactacg aaaatattaa taaatgtaac aataacaatt aacgcaataa\n      ctccaataat agctcctttc tttttatttt taaaaataaa aagttctttt ttaatcacaa\n      caatcttctc cttattcata tctaaaattt aaacttttaa attttacata aaaatttaaa\n      acttctaaaa tataacatgt ataatttacc atagatgatt tattttgtat aatataaaaa\n      tatctatata aataatgcta attttcaaac aatggggtgg aagatactaa tgttagaaaa\n      aaaagataga ctaacagaaa tagaggaaca aattatatac ttaatttcaa aggaattagg\n      aaataaagaa atagcggaaa aattaaatta ttcacaacgt agcatcggtt acaaaataaa\n      taatattttt aaaaaattaa atgttaattc aagaatcgga ctgattatag aagctgtaaa\n      aaaaaatata atttaaatat aagaatgctt tcatgttaat attttataga aactaaatat\n      agaggtgatt aaaatgcaaa aattttttga agctattagt gctataggta tagtaggtta\n      ctttttaggt aaattcacaa gtattccttt aatagacaaa tatacattgt atttcggcgt\n      aatgttgatg attggggtta ttggaagatt tattataaaa gtaattaact cagaagaaga\n      gacacatgat tcaaacaaat aaaatactct aataaaaatg gaagaagatt gcacttaagt\n      gcaatcttct tccattttta ttgaaaattg attaaataat gttaatattg caattgtgtg\n      gtgcagatta gggtgattat gtaatagggg gaaattaaaa atgatcaata cagcttggaa\n      aattattaaa gcactacaaa aatacggtac aaaagcatac aatgttatca aaaaaggcgg\n      ccaagcaatg tacgacagct tcatggcagc taaagctaaa ggttggacac atgcagcttg\n      gtggctagta gaacatggtt caactttagg aacattctat gatttattaa aagctgctgg\n      attaatcgac taattacagc aactaaacaa ctaaacaact aaacaactta aaaatacaaa\n      ttaccctaaa ctgtacccct attacatatt aactaattat tttaaaggtt ggatgataat\n      atgtcaaata acatcatatc tgtaaaaaat ttaattaaaa gcttcgataa caaaatagta\n      ttagataaat taaatttcga aatgaaagaa aactccactg ttgtaataat aggtaaaaac\n      ggtgcaggta aaagtgtctt tctaaattgt ttacttggat ttattcatta caaccaaggt\n      tcaatactaa tagatggaca acctgtagaa aatcgattac atctccgcaa gattacatcg\n      ttaatttctt cagaccatca agaacatcta aatttattaa cccccaatga atatttttct\n      tttttacaag atatttacca actaaaaagt aataataaag acaaaattca aaattactca\n     gaagatctat atgttactaa agaactcaat actgtatttt catcactttc ttttggaaca\n     aaaaagaaaa tacaattaat tggtagccta ttatattctc ctaaattatt gatttgcgac\n     gaaatatttg aagggcttga tacagactca gtaaaatggg ttaaaaactt atttcaacaa\n     agaaaacaag aaaatctttc tactttattt acaactcata ttactgaaca tataacagat\n     ataacagaaa aaaattacat acttgaaaat ggaaaattaa ttgtgtaagt ttaaccactt\n     atatttaaag ctaaaattaa ggagcttaaa atatgaattt taatatatat aagagactat\n     atgataaatc aacagaagaa aaaagcaaaa caataacaaa acaaatatta tttggaatta\n     taaatagttc tatattaata ggtatactac tcacatgttt ggagattttc aactttaaaa\n     tttcaactgt aatgtatggt tatttcacta tatatataat actagaactt ttactattat\n     tctctgcaaa tcaactatat gaaagtacag aattcataat aaaattcctt aaatatacac\n     caataaccat aaataaacta tatttctcac attttctaag ttctaaatat tcattttcca\n     atctttttga aataataact ctcacatcaa ttttattaat atataatgtc gatatcttat\n     attcatttat tttcataatt agcttacaaa ttattagctt aataagaaca tatttagaat\n     ttttactatt atattctcaa aaaaaacagg ttaaaatttt tactctaacc cattttgttt\n     tcataatatc tatggttttt tatattattg ttaaaacaaa atcgatagat ttagtattct\n     ttgaaaacac aaatatgtta attatatctg ttcttctcat aacattcttg atatcacttt\n     taacatataa acatattata gaatacttaa tgaaaaataa tgaaattgta tataatgcta\n     tttttatcaa gttaactttt aacacagcta atttaattag taaattattt aaatttaata\n     catcaattgc atctttaata aaaatacata taatacgatt attacgtaat caagactata\n     taagtagatt actaaaaata ggaatattac tatttatttt ttcttctata agctttctat\n     ttttcgataa atcatcaaca aacaatgaaa tgagtgatat actttacttt tcatttttta\n     tttccttatt tagtttttct aacatacgat tagactataa cttagtttct aaattaagct\n     tagaggatta tccaataaca aaattacaat caagattaag cattgatata gcacatggaa\n     ttttactatt tatactatct ttatttcttt tattaacaca atacttattg aatccaacaa\n     atattctaac tctaattgat ggtttattat catttatttg tttttatttt ctaagtcttg\n     gtatagaaaa agcagatatt ataataacac caaaaacaaa atggaaaatg tatccattat\n     tttttgtgat gggattaata attgaagcaa tatttctatt aaaattcaaa atatggataa\n     aattaataac tttattcctt tgtatactgt ggtcatattt acgtgtttat tggaaattaa\n     aaaaacaata aacacaatta aaaagttccc ttcatatttt ttgaagggaa cttttatttt\n     aaacaaaaat tacaaacaag caaagttatt taaaagtaaa cttttaaaat tattgaatta\n     ataacaatta gtctaagata tatcagccaa atttaatttt taaacaaacc gaaaaaccct\n     ttccgttttt gtttctgatt ttggctctgt atttctctaa tgttttcaag caataactga\n     tctcgttttt caaatttttt ctctataaaa acctctaatt caatattttt atcttctact\n     tcctttaatt ttctctccgt attagccaaa tgttcttttg tggtaactaa ttcattcgta\n     atctcttgta atttttgaac aagcgtttga ttgaactgat tttgtaattg ttgattttct\n     aatacttcat ccaacttctt ttctaattcc gatttttcct ctcttgaaac aaacaaatca\n     agttctccat tccgccatgc tcgaacttga tcataagacc atttttgcac ctgtattttt\n     tctttaattg ctatcaattc ttctatattt tcctttgagt acctacgatg ccctccctga\n     cttcgctccg tttgtatatt aaattcgttt gaccatgctt ttaacaagtc aggggtaatc\n     cctaaacgat ccgcaacaat tttcggtgta tacatttctg attttaattc caa<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>文件 2：描述基因特征的 feature table 文件（.tbl）</li>\n</ul>\n<p>该文件可以用 prokka 对文件 1 进行注释而得到，但是需要自己加以修改，加上文件前几行以及 gene 相关的信息。</p>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">&gt;Feature Toyoncin_biosynthesis_gene_cluster\n1\t8409\tsource\n\t\t\torganism\tBacillus toyonensis\n\t\t\tmol_type\tgenomic DNA\n\t\t\tstrain\tXIN-YC13\n585\t1\tgene\n\t\t\tgene\torf1\n585\t1\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00001\n\t\t\tproduct\tMarR family transcriptional regulator\n1476\t811\tgene\n\t\t\tgene\torf2\n1476\t811\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00002\n\t\t\tproduct\tYIP1 family membrane protein\n2710\t1496\tgene\n\t\t\tgene\torf3\n2710\t1496\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00003\n\t\t\tproduct\tABC transporter permease\n3387\t2707\tgene\n\t\t\tgene\torf4\n3387\t2707\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00004\n\t\t\tproduct\tABC transporter ATP-binding protein\n4595\t3384\tgene\n\t\t\tgene\torf5\n4595\t3384\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00005\n\t\t\tproduct\tRND family efflux transporter, MFP subunit\n4746\t4952\tgene\n\t\t\tgene\torf6\n4746\t4952\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00006\n\t\t\tproduct\tHelix-turn-helix transcriptional regulator\n5010\t5198\tgene\n\t\t\tgene\torf7\n5010\t5198\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00007\n\t\t\tproduct\tPutative membrane protein\n5337\t5549\tgene\n\t\t\tgene\ttoyA\n5337\t5549\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00008\n\t\t\tproduct\tToyonsin precusor\n5657\t6304\tgene\n\t\t\tgene\torf9\n5657\t6304\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00009\n\t\t\tproduct\tABC transporter ATP-binding protein\n6349\t7707\tgene\n\t\t\tgene\torf10\n6349\t7707\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00010\n\t\t\tproduct\tPutative membrane protein\n8391\t7849\tgene\n\t\t\tgene\torf11\n8391\t7849\tCDS\n\t\t\tinference\tab initio prediction:Prodigal:002006\n\t\t\tlocus_tag\tToyoncin_biosynthesis_gene_cluster_00011\n\t\t\tproduct\tMarR family transcriptional regulator<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>文件 3：描述作者信息的模板文件（.sbt）</li>\n</ul>\n<p>可以在<a href=\"https://submit.ncbi.nlm.nih.gov/genbank/template/submission/\"> NCBI</a> 上生成该文件。</p>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">Submit-block ::&#x3D; &#123;\n  contact &#123;\n    contact &#123;\n      name name &#123;\n        last &quot;xin&quot;,\n        first &quot;bingyue&quot;,\n        middle &quot;&quot;,\n        initials &quot;&quot;,\n        suffix &quot;&quot;,\n        title &quot;&quot;\n      &#125;,\n      affil std &#123;\n        affil &quot;Huaibei Normal University&quot;,\n        div &quot;College of Life Sciences&quot;,\n        city &quot;Huaibei&quot;,\n        sub &quot;Anhui&quot;,\n        country &quot;China&quot;,\n        street &quot;Dongshan road No.100&quot;,\n        email &quot;xinbingyuex@163.com&quot;,\n        postal-code &quot;235000&quot;\n      &#125;\n    &#125;\n  &#125;,\n  cit &#123;\n    authors &#123;\n      names std &#123;\n        &#123;\n          name name &#123;\n            last &quot;Xin&quot;,\n            first &quot;Bingyue&quot;,\n            middle &quot;&quot;,\n            initials &quot;&quot;,\n            suffix &quot;&quot;,\n            title &quot;&quot;\n          &#125;\n        &#125;\n      &#125;,\n      affil std &#123;\n        affil &quot;Huaibei Normal University&quot;,\n        div &quot;College of Life Sciences&quot;,\n        city &quot;Huaibei&quot;,\n        sub &quot;Anhui&quot;,\n        country &quot;China&quot;,\n        street &quot;Dongshan road No.100&quot;,\n        postal-code &quot;235000&quot;\n      &#125;\n    &#125;\n  &#125;,\n  subtype new\n&#125;\nSeqdesc ::&#x3D; pub &#123;\n  pub &#123;\n    gen &#123;\n      cit &quot;unpublished&quot;,\n      authors &#123;\n        names std &#123;\n          &#123;\n            name name &#123;\n              last &quot;Xin&quot;,\n              first &quot;Bingyue&quot;,\n              middle &quot;&quot;,\n              initials &quot;&quot;,\n              suffix &quot;&quot;,\n              title &quot;&quot;\n            &#125;\n          &#125;\n        &#125;\n      &#125;,\n      title &quot;Purification and characterization of a novel leaderless bacteriocin, toyoncin, produced by Bacillus toyonensis XIN-YC13 that specifically active against Bacilus cereus and Listeria monocytogenes&quot;\n    &#125;\n  &#125;\n&#125;\nSeqdesc ::&#x3D; user &#123;\n  type str &quot;Submission&quot;,\n  data &#123;\n    &#123;\n      label str &quot;AdditionalComment&quot;,\n      data str &quot;ALT EMAIL:xinbingyuex@163.com&quot;\n    &#125;\n  &#125;\n&#125;\nSeqdesc ::&#x3D; user &#123;\n  type str &quot;Submission&quot;,\n  data &#123;\n    &#123;\n      label str &quot;AdditionalComment&quot;,\n      data str &quot;Submission Title:None&quot;\n    &#125;\n  &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>注意</strong>：文件 1 和文件 2 的序列描述信息必须一致，此例中均为 “Toyoncin_biosynthesis_gene_cluster”。</p>\n<h1 id=\"文件生成\"><a class=\"markdownIt-Anchor\" href=\"#文件生成\"></a> 文件生成</h1>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">tbl2asn -t template.sbt -p ./ -V vb -x .fna<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>-t 模板文件<br />\n - p 输入文件所在路径<br />\n - V<br />\n-v 生成验证文件，保存错误信息<br />\n - b 生成 gbf 文件<br />\n - x 文件 1（FASTA 文件）的后缀名</p>\n<p><strong>注意</strong>：不知什么原因，生成的 sqn 和 gbf 文件中的日期通常是 1-JAN-2019，需要自己手动改正为当前时间。</p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/\">tbl2asn</a></li>\n<li><a href=\"http://www.chenlianfu.com/?p=2171\">上传基因组数据到 NCBI</a></li>\n</ul>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"NCBI","path":"api/tags/NCBI.json"},{"name":"序列处理","path":"api/tags/序列处理.json"},{"name":"生信软件","path":"api/tags/生信软件.json"}]},{"title":"R语言安装依赖包错误集锦","slug":"R语言安装依赖包错误集锦","date":"2021-11-02T04:56:45.000Z","updated":"2022-01-08T02:16:28.412Z","comments":true,"path":"api/articles/R语言安装依赖包错误集锦.json","excerpt":null,"keywords":null,"cover":null,"content":"<h1 id=\"devtools安装错误\"><a class=\"markdownIt-Anchor\" href=\"#devtools安装错误\"></a> devtools 安装错误</h1>\n<h2 id=\"xml包-安装之-error-configuration-failed-for-package-xml\"><a class=\"markdownIt-Anchor\" href=\"#xml包-安装之-error-configuration-failed-for-package-xml\"></a> XML 包 安装之 ERROR: configuration failed for package ‘XML’</h2>\n<ul>\n<li>\n<p>CentOS 解决方案</p>\n<p>在 Linux 终端中运行如下命令即可：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> -y libxml2-devel<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ul>\n<h1 id=\"qiime2r安装错误\"><a class=\"markdownIt-Anchor\" href=\"#qiime2r安装错误\"></a> qiime2R 安装错误</h1>\n<h2 id=\"rjcommonh1121-fatal-error-jpeglibh-no-such-file-or-directory\"><a class=\"markdownIt-Anchor\" href=\"#rjcommonh1121-fatal-error-jpeglibh-no-such-file-or-directory\"></a> rjcommon.h:11:21: fatal error: jpeglib.h: No such file or directory</h2>\n<p>该错误是安装依赖包 “jpeg” 时发生的。</p>\n<ul>\n<li>\n<p>CentOS 解决方案</p>\n<p>在 Linux 终端中运行如下命令即可：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> <span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> -y libjpeg-turbo-devel.x86_64<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ul>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"Linux","path":"api/tags/Linux.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"软件","path":"api/tags/软件.json"}]},{"title":"在Linux服务器中安装网页版Rstudio","slug":"在Linux服务器中安装网页版Rstudio","date":"2021-11-02T01:37:03.000Z","updated":"2022-01-08T02:16:28.439Z","comments":true,"path":"api/articles/在Linux服务器中安装网页版Rstudio.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_1.jpg","content":"<p>本文演示如何在 CentOS7 服务器上安装 Rstudio server。</p>\n<h1 id=\"安装rstudio\"><a class=\"markdownIt-Anchor\" href=\"#安装rstudio\"></a> 安装 Rstudio</h1>\n<p>访问<a href=\"https://www.rstudio.com/products/rstudio/download-server\"> Rstudio 官网</a>，选择对应的 Linux 发行版，下载 Rstudio 安装包。本文以最常见的 CentOS7 为例演示，<strong>前提是系统中已经安装了 R</strong>。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://download2.rstudio.org/server/centos7/x86_64/rstudio-server-rhel-2021.09.0-351-x86_64.rpm\n<span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> rstudio-server-rhel-2021.09.0-351-x86_64.rpm<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h1 id=\"开启rstudio服务\"><a class=\"markdownIt-Anchor\" href=\"#开启rstudio服务\"></a> 开启 Rstudio 服务</h1>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> rstudio-server.service\n<span class=\"token function\">sudo</span> systemctl start rstudio-server.service\n<span class=\"token function\">sudo</span> systemctl status rstudio-server<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"开启8787端口\"><a class=\"markdownIt-Anchor\" href=\"#开启8787端口\"></a> 开启 8787 端口</h1>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> firewalld\n<span class=\"token function\">sudo</span> firewall-cmd --permanent --add-port<span class=\"token operator\">=</span><span class=\"token number\">8787</span>/tcp\n<span class=\"token function\">sudo</span> firewall-cmd --permanent --add-port<span class=\"token operator\">=</span><span class=\"token number\">8787</span>/udp\n<span class=\"token function\">sudo</span> firewall-cmd --reload<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"远程登录rstudio\"><a class=\"markdownIt-Anchor\" href=\"#远程登录rstudio\"></a> 远程登录 Rstudio</h1>\n<p>在浏览器地址栏输入 <code>http://ip:8787/</code>  打开网页，输入自己的用户名和密码登录即可。</p>\n<h1 id=\"错误处理\"><a class=\"markdownIt-Anchor\" href=\"#错误处理\"></a> 错误处理</h1>\n<h2 id=\"rstudio服务启动失败\"><a class=\"markdownIt-Anchor\" href=\"#rstudio服务启动失败\"></a> Rstudio 服务启动失败</h2>\n<h3 id=\"症状\"><a class=\"markdownIt-Anchor\" href=\"#症状\"></a> 症状</h3>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_1.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"sudo rstudio-server status\" /></p>\n<h3 id=\"排雷\"><a class=\"markdownIt-Anchor\" href=\"#排雷\"></a> 排雷</h3>\n<ul>\n<li>\n<p>检查安装</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> rstudio-server verify-installation<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"sudo rstudio-server verify-installation\" /></p>\n<p>提示 “/usr/lib/rstudio-server/bin/rsession: error while loading shared libraries: <a href=\"http://libR.so\">libR.so</a>: cannot open shared object file: No such file or directory”，表明缺少 libR.so 库。</p>\n</li>\n<li>\n<p>安装 R</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> -y R.x86_64<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>再次检查安装情况</p>\n<p>提示找不到 R。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_3.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_3.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"sudo rstudio-server verify-installation\" /></p>\n<p>可以看到这里进入了 conda 的 base 环境，它影响了程序的判断，退出 conda 环境后再试一下就不再报错了。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda deactivate<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><strong>注</strong>：conda 环境一定要退彻底。</p>\n</li>\n<li>\n<p>再次启动 Rstudio 服务，并查看状态</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> rstudio-server start\n<span class=\"token function\">sudo</span> rstudio-server status<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_4.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/ea71_4.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"rstudio-server正常运行\" /></p>\n</li>\n</ul>\n","raw":null,"categories":[{"name":"生物信息","path":"api/categories/生物信息.json"}],"tags":[{"name":"Linux","path":"api/tags/Linux.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"软件","path":"api/tags/软件.json"}]}]}