{"name":"绘图","postlist":[{"title":"R语言绘制气泡图Bubb_Plot","slug":"R语言绘制气泡图Bubb-Plot","date":"2021-10-12T13:12:17.000Z","updated":"2022-01-08T02:16:28.413Z","comments":true,"path":"api/articles/R语言绘制气泡图Bubb-Plot.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/b68c_2.jpg","content":"<p>气泡图是经常用到的一种图，可以对比不同样本中某个特征的丰富度差异。以下代码 “bubbleChart_No0.R” 用于气泡图的绘制，零值将不会在图中输出。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/b68c_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/b68c_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"输入文件示例\" /></p>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><div class=\"caption\"><span>bubbleChart_No0.R</span><a href=\"https://github.com/liaochenlanruo/myScripts/tree/main/b68c%20BubblePlot\">代码在此</a></div><code class=\"language-r\"><span class=\"token comment\">#!/usr/bin/env Rscript</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/lujia16S/Analysis_20200907/Downstream_analysis/Function\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#设置工作目录</span>\n\n<span class=\"token comment\">#pdf(file=\"FunctionsBubbleChart.pdf\", width=14, height=11)</span>\n\n<span class=\"token comment\"># 读取文件 sep 根据文件格式确定</span>\ndata <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"functional_table3.tsv\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\n\ndata_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Functions\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\ndata_melt<span class=\"token operator\">$</span>Sites<span class=\"token operator\">=</span>substring<span class=\"token punctuation\">(</span>data_melt<span class=\"token operator\">$</span>Samples<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># 根据第二列的样本名称提取站位信息，用于后续着色</span>\ndata_melt <span class=\"token operator\">&lt;-</span>as.data.frame<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 做主图</span>\nbubble <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>data_melt<span class=\"token punctuation\">[</span>which<span class=\"token punctuation\">(</span>data_melt<span class=\"token operator\">$</span>Abundances<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> Functions<span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> Sites<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> geom_point<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 字体修饰</span>\n<span class=\"token comment\">##windowsFonts(myFont = windowsFont(\"Times New Roman\"))</span>\n\n<span class=\"token comment\"># 修改细节 — 图注，点大小，点shape</span>\nbubble_style <span class=\"token operator\">&lt;-</span> bubble <span class=\"token operator\">+</span> theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n  labs<span class=\"token punctuation\">(</span>\n    x <span class=\"token operator\">=</span> <span class=\"token string\">\"Sampling Sites\"</span><span class=\"token punctuation\">,</span>\n    y <span class=\"token operator\">=</span> <span class=\"token string\">\"Functions\"</span><span class=\"token punctuation\">,</span>\n    color<span class=\"token operator\">=</span><span class=\"token string\">\"Sites\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 颜色图注名</span>\n    size<span class=\"token operator\">=</span><span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>    <span class=\"token comment\"># 大小图注名</span>\n    scale_size<span class=\"token punctuation\">(</span>range <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> breaks <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>  <span class=\"token comment\">#等比修改圆圈大小</span>\n    theme<span class=\"token punctuation\">(</span>plot.title<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Times New Roman\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n                                color<span class=\"token operator\">=</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span>face<span class=\"token operator\">=</span><span class=\"token string\">\"italic\"</span><span class=\"token punctuation\">,</span>\n                                hjust<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>lineheight<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                plot.subtitle <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> \n    theme<span class=\"token punctuation\">(</span>axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> hjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#dev.off()</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"使用方法\"><a class=\"markdownIt-Anchor\" href=\"#使用方法\"></a> 使用方法</h1>\n<p>在 Rstudio 中运行以上代码，注意更改自己的工作目录和输入文件。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/b68c_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/b68c_1.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"气泡图\" /></p>\n<h1 id=\"脚本获取\"><a class=\"markdownIt-Anchor\" href=\"#脚本获取\"></a> 脚本获取</h1>\n<p>关注公众号 “生信之巅”，聊天窗口回复 “b68c” 获取下载链接。</p>\n<table align=\"center\"><tr>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/生信之巅公众号.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅微信公众号\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-right: 0px;margin-bottom: 5px;align: center;\"></td>\n  <td align=\"center\"><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/img/social/小程序码.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"生信之巅小程序码\" style=\"width: 100px;height: 100px;vertical-align: -20px;border-radius: 0%;margin-left: 0px;margin-bottom: 5px;align: center\"></td>\n</tr></table>\n<p><font color=\"#FF0000\"><ruby><b>敬告</b>：使用文中脚本请引用本文网址，请尊重本人的劳动成果，谢谢！<rt><b>Notice</b>: When you use the scripts in this article, please cite the link of this webpage. Thank you!</rt></ruby></font></p>\n","raw":null,"categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]},{"title":"R语言自定义坐标轴排序","slug":"R语言自定义坐标轴排序","date":"2019-02-22T08:57:21.000Z","updated":"2022-01-08T02:16:28.414Z","comments":true,"path":"api/articles/R语言自定义坐标轴排序.json","excerpt":null,"keywords":null,"cover":null,"content":"<p>R 语言作图时，默认情况下软件会按照自己的方式对坐标轴的项目进行排序，然而这种排序往往不是我们所希望的，因此需要想办法让坐标轴的项目按照我们希望的顺序输出。</p>\n<span id=\"more\"></span>\n<p>如下所示，我有两列数据，要绘制箱线图，以第一列为 Y 轴，第二列为 X 轴，希望 X 轴的输出顺序按照第二列由上到下排列。</br></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">size    <span class=\"token builtin class-name\">type</span>\n<span class=\"token number\">6.612309456</span>    T-8\n<span class=\"token number\">5.878857613</span>    T-10\n<span class=\"token number\">6.724282265</span>    T-15\n<span class=\"token number\">5.68136692</span>    T-56\n<span class=\"token number\">5.863334656</span>    T-1723<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p></br>然而软件输出的顺序如下：</br></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">T-10    T-15    T-1723    T-56    T-8<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>解决方案：</br></p>\n<p>通过一个因子事先自定义 X 轴顺序，作图命令如下：</br></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#读入数据</span>\ngsize <span class=\"token operator\">&lt;</span>- read.delim<span class=\"token punctuation\">(</span><span class=\"token string\">\"gsize.txt\"</span>, <span class=\"token assign-left variable\">header</span><span class=\"token operator\">=</span>TRUE, <span class=\"token assign-left variable\">sep</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\t\">\\t</span>\"</span>, <span class=\"token assign-left variable\">stringsAsFactors</span><span class=\"token operator\">=</span>FALSE<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#自定义X轴顺序</span>\nx1 <span class=\"token operator\">=</span> factor<span class=\"token punctuation\">(</span>gsize<span class=\"token variable\">$type</span>, <span class=\"token assign-left variable\">levels</span><span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"T-8\"</span>,<span class=\"token string\">\"T-10\"</span>,<span class=\"token string\">\"T-15\"</span>,<span class=\"token string\">\"T-56\"</span>,<span class=\"token string\">\"T-1723\"</span><span class=\"token punctuation\">))</span>\n<span class=\"token comment\">#用x1代替gsize$type绘图</span>\nboxplot<span class=\"token punctuation\">(</span>size~x1, <span class=\"token assign-left variable\">data</span><span class=\"token operator\">=</span>gsize, <span class=\"token assign-left variable\">xlab</span><span class=\"token operator\">=</span><span class=\"token string\">\"Sequence Type\"</span>, <span class=\"token assign-left variable\">ylab</span><span class=\"token operator\">=</span><span class=\"token string\">\"Genome Size\"</span>, <span class=\"token assign-left variable\">varwidth</span><span class=\"token operator\">=</span>TRUE, <span class=\"token assign-left variable\">notch</span><span class=\"token operator\">=</span>FALSE<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p></br>至此，X 轴各项目会按照我们自定义的顺序排列。</p>\n","raw":null,"categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]},{"title":"R语言绘制分组条形图","slug":"R语言绘制分组条形图","date":"2021-11-26T06:37:02.000Z","updated":"2022-01-08T02:16:28.413Z","comments":true,"path":"api/articles/R语言绘制分组条形图.json","excerpt":null,"keywords":null,"cover":"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg","content":"<p>当我们要对一个多行多列的数据进行可视化的时候，分组条形图是一种不错的选择。</p>\n<h1 id=\"输入文件样式\"><a class=\"markdownIt-Anchor\" href=\"#输入文件样式\"></a> 输入文件样式</h1>\n<p>本例中数据内容如下图所示，将其保存在名为 <code>CAZy.Category.Matrix.txt</code>  的文件中。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_1.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"CAZy.Category.Matrix.txt\" /></p>\n<h1 id=\"绘图代码\"><a class=\"markdownIt-Anchor\" href=\"#绘图代码\"></a> 绘图代码</h1>\n<p>在 Rstudio 中运行如下代码，细节可根据具体情况修改</p>\n<pre class=\"line-numbers language-r\" data-language=\"r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>reshape<span class=\"token punctuation\">)</span>\nwindowsFonts<span class=\"token punctuation\">(</span>Arial<span class=\"token operator\">=</span>windowsFont<span class=\"token punctuation\">(</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#加载Windows字体</span>\nsetwd<span class=\"token punctuation\">(</span><span class=\"token string\">\"E:/Researches/Xiaqian/NGS/CleanData/宏基因组数据/Result/NCyc\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#设定工作目录</span>\ncazy <span class=\"token operator\">&lt;-</span> read.table<span class=\"token punctuation\">(</span><span class=\"token string\">\"CAZy.Category.Matrix.txt\"</span><span class=\"token punctuation\">,</span>header <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> sep <span class=\"token operator\">=</span> <span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\ncazy_melt <span class=\"token operator\">&lt;-</span> melt<span class=\"token punctuation\">(</span>cazy<span class=\"token punctuation\">)</span>\nnames<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Cazy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Samples\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Abundances\"</span><span class=\"token punctuation\">)</span>\nggplot<span class=\"token punctuation\">(</span>cazy_melt<span class=\"token punctuation\">,</span>aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> Samples<span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> Abundances<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n     geom_bar<span class=\"token punctuation\">(</span>stat <span class=\"token operator\">=</span> <span class=\"token string\">'identity'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#identity是直接引用数据集中变量的值（表示不要计数，而是直接使用数据本身作为频数。）</span>\n              aes<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> Cazy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              position <span class=\"token operator\">=</span> position_dodge<span class=\"token punctuation\">(</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token comment\">#使柱子并排放置</span>\n     theme_classic<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> \n     theme<span class=\"token punctuation\">(</span>text<span class=\"token operator\">=</span>element_text<span class=\"token punctuation\">(</span>family<span class=\"token operator\">=</span><span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span>face <span class=\"token operator\">=</span> <span class=\"token string\">\"plain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#设置文字的字体字号</span>\n           axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token comment\"># 设置X轴文字大小</span>\n      scale_fill_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#1f77b4\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#bcbd22\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#2ca02c\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#17becf\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#9467bd\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"#e377c2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设置填充颜色</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://cdn.jsdelivr.net/gh/liaochenlanruo/cdn@master/images/post/36cc_2.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"分组条形图\" /></p>\n<h1 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/weixin_45387324/article/details/109398216\">R 语言 ggplot2 分组条形图</a></li>\n<li><a href=\"https://www.jianshu.com/p/e443edd76daa\">geom_bar () 函数绘制条形图</a></li>\n</ul>\n","raw":null,"categories":[{"name":"可视化","path":"api/categories/可视化.json"}],"tags":[{"name":"SY179","path":"api/tags/SY179.json"},{"name":"R语言","path":"api/tags/R语言.json"},{"name":"绘图","path":"api/tags/绘图.json"}]}]}